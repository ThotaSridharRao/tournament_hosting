<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description"
    content="EArena — host and compete. Clean, accessible esports landing page with responsive layout and video hero." />
  <meta name="theme-color" content="#0b0b0b" />
  <title>EArena — Compete | Host | Win</title>

  <!-- Fonts & icons (preload & preconnect for performance) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity=""
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <style>
    /* =========================
       Theme variables (Futuristic)
       ========================= */
    :root {
      --bg-dark: #0f0f23;
      --bg-medium: #1a1a2e;
      --bg-light: #16213e;
      --accent-green: #00ff88;
      --accent-blue: #00ccff;
      --text-primary: #ffffff;
      --text-secondary: rgba(255, 255, 255, 0.8);
      --border-color: rgba(0, 255, 136, 0.3);
      --ease: 0.3s ease;

      /* Legacy variables for compatibility */
      --copy: var(--text-primary);
      --muted: var(--text-secondary);
      --accent: var(--accent-green);
      --accent-2: var(--accent-blue);
      --radius: 12px;
      --container: 1400px;
    }

    /* Enhanced easing curves for smoother animations */
    :root {
      --ease-out-quart: cubic-bezier(0.25, 1, 0.5, 1);
      --ease-in-out-quart: cubic-bezier(0.76, 0, 0.24, 1);
      --ease-out-back: cubic-bezier(0.34, 1.56, 0.64, 1);
      --spring: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    /* Respect reduced motion preferences */
    @media (prefers-reduced-motion: reduce) {
      :root {
        --ease: 0ms;
      }

      * {
        transition-duration: 0ms !important;
        animation-duration: 0ms !important;
        animation-iteration-count: 1 !important;
      }
    }

    /* =========================
       Base resets & accessibility
       ========================= */
    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-medium) 50%, var(--bg-light) 100%);
      background-attachment: fixed; /* Ensures gradient is seamless on scroll */
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.6;
      -webkit-text-size-adjust: 100%;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    img,
    video,
    iframe {
      max-width: 100%;
      display: block;
    }

    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    /* Skip link for keyboard users */
    .skip-link {
      position: absolute;
      left: -999px;
      top: auto;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }

    .skip-link:focus {
      left: 1rem;
      top: 1rem;
      width: auto;
      height: auto;
      padding: .5rem .75rem;
      background: rgba(0, 0, 0, .8);
      border-radius: 6px;
      color: var(--copy);
      z-index: 9999;
    }

    /* =========================
       Layout helpers
       ========================= */
    .container {
      width: min(94%, var(--container));
      margin: 0 auto;
    }

    /* Animated background particles */
    .bg-particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        overflow: hidden;
    }

    .particle {
        position: absolute;
        width: 2px;
        height: 2px;
        background: #00ff88;
        border-radius: 50%;
        opacity: 0.7;
        animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.7; }
        50% { transform: translateY(-20px) rotate(180deg); opacity: 1; }
    }


    /* Futuristic Header */
    header.site-header {
        position: fixed;
        top: 0;
        width: 100%;
        padding: 1rem 2rem;
        background: rgba(15, 15, 35, 0.9);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--border-color);
        z-index: 1200;
        transition: all 0.3s var(--ease-out-quart);
        height: auto;
    }
    
    .header-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 100%;
        max-width: var(--container);
        margin: 0 auto;
        position: relative;
    }

    header.site-header.scrolled {
      background: rgba(15, 15, 35, 0.98);
      box-shadow: 0 2px 20px rgba(0, 255, 136, 0.1);
    }
    
    .brand {
      font-size: 2rem;
      font-weight: bold;
      background: linear-gradient(45deg, var(--accent-green), var(--accent-blue));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
      text-decoration: none;
    }
    
    .brand .accent { /* Hide original accent */
        display:none;
    }

    nav.primary {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }

    /* Nav links — desktop */
    .nav-links {
      display: flex;
      gap: 2rem;
      align-items: center;
      list-style: none;
    }

    .nav-item {
      position: relative;
    }

    .nav-links a {
      color: var(--text-primary);
      text-decoration: none;
      transition: all 0.3s ease;
      position: relative;
      padding: 0.5rem 0;
    }

    .nav-links a:hover {
      color: var(--accent-green);
      transform: translateY(-2px);
    }

    .nav-links a::after {
        content: '';
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 0;
        height: 2px;
        background: linear-gradient(45deg, var(--accent-green), var(--accent-blue));
        transition: width 0.3s ease;
    }

    .nav-links a:hover::after {
        width: 100%;
    }

    /* Dropdown styles */
    .dropdown-arrow {
      font-size: 0.7rem;
      transition: transform 0.3s var(--ease-out-quart);
    }

    .nav-item:hover .dropdown-arrow {
      transform: rotate(180deg);
    }

    .dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      background: rgba(30, 30, 30, 0.8);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      min-width: 200px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s var(--ease-out-quart);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      z-index: 1000;
    }

    .nav-item:hover .dropdown-menu {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .dropdown-menu a {
      padding: 0.75rem 1rem;
      border-bottom: 1px solid rgba(255,255,255, 0.1);
      font-size: 0.85rem;
      color: #bbb;
    }

    .dropdown-menu a:last-child {
      border-bottom: none;
    }

    .dropdown-menu a:hover {
      background: rgba(255, 255, 255, 0.05);
      color: #ffffff;
    }

    /* Right side actions */
    .nav-actions {
      display: flex;
      align-items: center;
      gap: 1rem; /* Spacing */
    }
    
    .login-link {
        display: none; /* Replaced by Join Now button */
    }

    /* CTA button in header */
    .header-cta {
        background: linear-gradient(45deg, var(--accent-green), var(--accent-blue));
        color: var(--bg-dark);
        padding: 0.8rem 2rem;
        border: none;
        border-radius: 25px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-block;
    }
    .header-cta:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 255, 136, 0.4);
    }
    
    .header-cta:focus {
      outline: none;
    }

    /* Profile Dropdown Styles */
    .profile-dropdown {
      position: relative;
      display: flex;
      align-items: center;
    }

    .profile-icon {
      width: auto;
      height: auto;
      color: var(--text-primary);
      cursor: pointer;
      border-radius: 50%;
      transition: all 0.3s ease;
      font-size: 1.8rem;
    }

    .profile-icon:hover {
      color: var(--accent);
      transform: scale(1.1);
    }

    .profile-modal {
      position: absolute;
      top: 150%; /* Position below icon */
      right: 0;
      background: var(--bg-medium);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      min-width: 250px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s var(--ease-out-quart);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
      z-index: 1000;
    }

    .profile-dropdown:hover .profile-modal {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .profile-header {
      padding: 1rem;
      border-bottom: 1px solid var(--border-color);
      text-align: center;
    }
    
    .profile-photo {
        display:none; /* Not in new design */
    }

    .profile-info {
      flex: 1;
    }

    .profile-username {
      font-weight: 700;
      color: var(--copy);
      font-size: 1.1rem;
      margin-bottom: 0.25rem;
    }

    .profile-role {
      background: linear-gradient(45deg, var(--accent-green), var(--accent-blue));
      color: var(--bg-dark);
      padding: 0.2rem 0.5rem;
      border-radius: 12px;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: inline-block;
    }

    .profile-actions {
      padding: 0.5rem;
    }

    .profile-action {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      color: var(--text-primary);
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-weight: 600;
      font-size: 0.95rem;
      width: 100%;
      border: none;
      background: none;
      cursor: pointer;
      font-family: inherit;
      text-align: left;
    }

    .profile-action:hover {
      background: rgba(0, 255, 136, 0.1);
      color: var(--accent);
    }
    
    .logout-action:hover {
        background: rgba(255, 0, 0, 0.1);
        color: #ff6b6b;
    }

    .profile-action i {
      width: 16px;
      text-align: center;
    }

    #user-menu {
      display: flex;
      align-items: center;
    }

    /* Hamburger (mobile) */
    .hamburger {
      display: none;
      background: none;
      border: 0;
      padding: .5rem;
      cursor: pointer;
      z-index: 1; /* Ensure it's clickable */
    }

    .hamburger .bars {
      display: inline-block;
      width: 22px;
      height: 2px;
      background: var(--copy);
      border-radius: 2px;
      position: relative;
      transition: var(--ease);
    }

    .hamburger .bars::before,
    .hamburger .bars::after {
      content: "";
      position: absolute;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--copy);
      border-radius: 2px;
      transition: var(--ease);
    }

    .hamburger .bars::before {
      top: -7px;
    }

    .hamburger .bars::after {
      top: 7px;
    }

    .hamburger[aria-expanded="true"] .bars {
      background: transparent;
    }

    .hamburger[aria-expanded="true"] .bars::before {
      transform: translateY(7px) rotate(-45deg);
      top: 0;
    }

    .hamburger[aria-expanded="true"] .bars::after {
      transform: translateY(-7px) rotate(45deg);
      top: 0;
    }

    /* Mobile nav overlay */
    .mobile-nav {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(15, 15, 35, 0.98);
      backdrop-filter: blur(15px);
      z-index: 1100;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: opacity 0.3s ease, visibility 0.3s;
      opacity: 0;
      visibility: hidden;
    }

    .mobile-nav.is-open {
      opacity: 1;
      visibility: visible;
    }
    
    .mobile-nav .nav-links {
        flex-direction: column;
        text-align: center;
        font-size: 1.5rem;
        gap: 2rem;
    }
    .mobile-nav .nav-actions {
        margin-top: 2rem;
        flex-direction: column;
        gap: 1.5rem;
    }
    
    .mobile-nav-section, .mobile-nav > nav > .mobile-link, .mobile-nav-actions {
        display: none; /* Hide old mobile nav elements */
    }

    /* =========================
       Hero section
       ========================= */
    .hero {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      padding: 2rem;
    }

    .hero__bg-slider {
      position: absolute;
      inset: 0;
    }

    .hero__bg-slider img {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: all 3s var(--ease-in-out-quart);
      transform: scale(1.1) rotate(0.5deg);
      filter: brightness(0.8) contrast(1.1);
    }

    .hero__bg-slider img.active {
      opacity: 1;
      transform: scale(1) rotate(0deg);
      filter: brightness(1) contrast(1.2);
    }


    .hero__overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, var(--bg-dark) 15%, transparent 80%);
      z-index: 1;
    }

    .hero__content {
      position: relative;
      z-index: 2;
      max-width: 800px;
      transition: all 1.2s var(--ease-out-quart);
      opacity: 0;
      transform: translateY(40px);
    }

    .hero__content.active {
      opacity: 1;
      transform: translateY(0);
    }

    .hero__content {
      position: relative;
      z-index: 2;
      width: min(94%, var(--container));
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      padding: 3rem;
      max-width: 700px;
      transition: all 1.2s var(--ease-out-quart);
      opacity: 0;
      transform: translateY(40px) translateX(-20px);
    }

    .hero__content.active {
      opacity: 1;
      transform: translateY(0) translateX(0);
    }

    .hero__content>* {
      transition: all 0.8s var(--ease-out-quart);
      transform: translateY(20px);
      opacity: 0;
    }

    .hero__content.active>* {
      transform: translateY(0);
      opacity: 1;
    }

    .hero__content.active>*:nth-child(1) {
      transition-delay: 0.1s;
    }

    .hero__content.active>*:nth-child(2) {
      transition-delay: 0.2s;
    }

    .hero__content.active>*:nth-child(3) {
      transition-delay: 0.3s;
    }

    .hero__content.active>*:nth-child(4) {
      transition-delay: 0.4s;
    }
    
    .hero__content .tournament-name {
      font-size: 4rem;
      margin-bottom: 1rem;
      background: linear-gradient(45deg, #ffffff, var(--accent-green), var(--accent-blue));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: glow 2s ease-in-out infinite alternate;
    }
    
    @keyframes glow {
        from { text-shadow: 0 0 20px rgba(0, 255, 136, 0.5); }
        to { text-shadow: 0 0 30px rgba(0, 204, 255, 0.8); }
    }

    .hero__content .prize-pool {
        font-size: 1.2rem;
        margin-bottom: 2rem;
        opacity: 0.9;
        line-height: 1.6;
        color: var(--text-primary);
        text-shadow: none;
    }

    .hero__content p {
        display:none; /* Merged into prize-pool for new design */
    }

    .hero-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    /* Primary & Secondary Buttons */
    .btn-primary {
      background: linear-gradient(45deg, var(--accent-green), var(--accent-blue));
      color: var(--bg-dark);
      padding: 1rem 2.5rem;
      border: none;
      border-radius: 30px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .btn-secondary {
      background: transparent;
      color: var(--text-primary);
      padding: 1rem 2.5rem;
      border: 2px solid var(--accent-green);
      border-radius: 30px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .btn-primary:hover, .btn-secondary:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 35px rgba(0, 255, 136, 0.4);
    }
    .btn-secondary:hover {
        background: rgba(0, 255, 136, 0.1);
    }
    
    .btn--primary { /* Legacy button, restyle to new primary */
        background: linear-gradient(45deg, var(--accent-green), var(--accent-blue));
        color: var(--bg-dark);
        padding: 1rem 2.5rem;
        border: none;
        border-radius: 30px;
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-block;
        box-shadow: none;
        text-shadow: none;
    }
    .btn--primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 35px rgba(0, 255, 136, 0.4);
    }


    /* =========================
       Greeting/Tournaments Section
       ========================= */
    .greeting-section {
      text-align: center;
      padding: clamp(3rem, 6vw, 6rem) 1rem;
      position: relative;
      z-index: 5;
    }

    .greeting-title {
      font-size: clamp(2.2rem, 5vw, 3.5rem);
      font-weight: 800;
      color: var(--copy);
      margin: 0 0 1rem 0;
      line-height: 1.2;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.7);
    }

    .greeting-subtitle {
      font-size: clamp(1rem, 2vw, 1.25rem);
      color: var(--muted);
      max-width: 700px;
      margin: 0 auto;
      line-height: 1.6;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
    }

    #tournaments-heading {
      text-align: center;
      font-size: 2.5rem;
      margin-bottom: 3rem;
      background: linear-gradient(45deg, var(--accent-green), var(--accent-blue));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }


    /* =========================
       Tournaments Section
       ========================= */
    .tournaments-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 2rem;
      justify-content: center;
    }

    /* Glassmorphism Tournament Card */
    .tournament-card {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        padding: 2rem;
        border: 1px solid var(--border-color);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        text-decoration: none;
        color: var(--copy);
    }

    .tournament-card:hover {
        transform: translateY(-10px);
        border-color: var(--accent-green);
        box-shadow: 0 20px 40px rgba(0, 255, 136, 0.2);
    }
    
    .tournament-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(0, 255, 136, 0.1), transparent);
        transition: left 0.5s ease;
    }
    .tournament-card:hover::before {
        left: 100%;
    }


    .tournament-card__poster {
      height: 180px;
      overflow: hidden;
      position: relative;
      margin: -2rem -2rem 1.5rem -2rem; /* Bleed to edges */
      border-radius: 20px 20px 0 0;
    }

    .tournament-card__poster img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.4s var(--ease-out-quart);
    }
    
    .tournament-card:hover .tournament-card__poster img {
      transform: scale(1.05);
    }
    
    .tournament-card__status {
        display: none; /* Hide old status */
    }
    
    .tournament-info {
        display: flex;
        justify-content: space-between;
        margin-bottom: 1rem;
        font-size: 0.9rem;
        opacity: 0.8;
    }

    .tournament-card__info {
      padding: 0; /* Remove old padding */
    }

    .tournament-card__title {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: var(--accent-green);
    }
    
    .prize-pool {
        font-size: 1.2rem;
        font-weight: bold;
        color: var(--accent-blue);
        margin-bottom: 1rem;
    }

    .tournament-card__meta {
      display: none; /* Hide old meta */
    }


    /* =========================
       Matches / Panels Grid
       ========================= */
    main {
      margin-top: 0; /* No margin needed with new header */
    }
    
    .section {
      padding: 5rem 2rem;
    }
    
    .highlights-section, .why-section, .cta-section {
        display: none; /* Hide all old sections */
    }

    /* Stats Section */
    .stats-section {
      background: rgba(0, 0, 0, 0.3);
      text-align: center;
    }

    .stats-container {
      max-width: 1000px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 3rem;
    }

    .stat-item {
      padding: 2rem 0;
    }

    .stat-number {
      font-size: 3rem;
      font-weight: bold;
      background: linear-gradient(45deg, var(--accent-green), var(--accent-blue));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      display: block;
    }

    .stat-label {
      font-size: 1.1rem;
      opacity: 0.9;
      margin-top: 0.5rem;
    }


    /* =========================
       Footer
       ========================= */
    footer.site-footer {
      background: rgba(15, 15, 35, 0.95);
      padding: 3rem 2rem 2rem;
      text-align: center;
      border-top: 1px solid var(--border-color);
      margin-top: 0;
    }

    .footer-grid {
      max-width: 1200px;
      margin: 0 auto 2rem auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      text-align: left;
    }

    .footer-column h4 {
      color: var(--accent-green);
      margin-bottom: 1rem;
    }

    .footer-column ul a, .footer-column p {
      color: var(--text-primary);
      text-decoration: none;
      opacity: 0.8;
      transition: all 0.3s ease;
      display: block;
      margin-bottom: 0.5rem;
    }
    
    .footer-column ul a:hover {
        opacity: 1;
        color: var(--accent-green);
    }
    
    .footer-brand .brand {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
    }


    .footer-bottom {
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      padding-top: 2rem;
      opacity: 0.7;
    }

    /* =========================
       Responsive
       ========================= */
    @media (max-width:920px) {
      .nav-links, .nav-actions {
        display: none;
      }

      .header-container {
        justify-content: space-between;
      }
      nav.primary {
          display: none;
      }
      .hamburger {
        display: inline-flex;
      }
    }


    @media (max-width:820px) {
      .mobile-nav.is-open {
        display: flex;
      }
    }

    @media (max-width: 768px) {
        .hero h1 {
            font-size: 2.5rem;
        }
        .hero-buttons {
            flex-direction: column;
            align-items: center;
        }
        .tournaments-grid {
            grid-template-columns: 1fr;
        }
    }
  </style>
</head>

<body>
  <div class="bg-particles" id="particles"></div>
  <a class="skip-link" href="#main">Skip to content</a>

  <header class="site-header" role="banner">
    <div class="header-container">
        <a href="index.html" class="brand" aria-hidden="false">EArena</a>

        <nav class="primary" role="navigation" aria-label="Primary">
        <div class="nav-links" role="menubar" aria-hidden="false">
            <div class="nav-item">
            <a href="#" role="menuitem">
                Tournaments
                <span class="dropdown-arrow">▼</span>
            </a>
            <div class="dropdown-menu">
                <a href="tournaments.html">Browse All</a>
                <a href="tournaments.html?filter=live">Live Matches</a>
                <a href="tournaments.html?filter=upcoming">Upcoming Events</a>
                <a href="tournaments.html?filter=completed">Past Results</a>
                <a href="#">Leaderboards</a>
            </div>
            </div>
            <div class="nav-item" id="host-nav-item" style="display: none;">
            <a href="#" role="menuitem">
                Host
                <span class="dropdown-arrow">▼</span>
            </a>
            <div class="dropdown-menu">
                <a href="admin-dashboard.html">Admin Dashboard</a>
                <a href="#">Create Tournament</a>
                <a href="#">Manage Events</a>
                <a href="#">Analytics Dashboard</a>
                <a href="#">Prize Management</a>
            </div>
            </div>
            <a href="#games" role="menuitem">Games</a>
            <a href="#community" role="menuitem">Community</a>
            <a href="#support" role="menuitem">Support</a>
            <a href="#pricing" role="menuitem">Pricing</a>
        </div>
        </nav>

        <div class="nav-actions">
        <!-- Not logged in -->
        <div id="auth-buttons">
            <button class="header-cta" aria-label="Join Now" id="join-now-desktop" onclick="redirectToAuth()">Join Now</button>
        </div>
        
        <!-- Logged in -->
        <div id="user-menu" style="display: none;">
          <div class="profile-dropdown">
            <div class="profile-icon" id="profile-icon">
                <i class="fas fa-user-circle"></i>
            </div>
            <div class="profile-modal" id="profile-modal">
                <div class="profile-header">
                <div class="profile-info">
                    <div class="profile-username" id="modal-username">User</div>
                    <div class="profile-role" id="modal-role-badge" style="display: none;">Admin</div>
                </div>
                </div>
                <div class="profile-actions">
                <a href="user-dashboard.html" class="profile-action" id="modal-dashboard-link">
                    <i class="fas fa-user"></i>
                    <span>My Account</span>
                </a>
                <button class="profile-action logout-action" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
                </div>
            </div>
            </div>
        </div>
        </div>

        <button class="hamburger" aria-label="Toggle menu" aria-expanded="false" aria-controls="mobile-nav">
        <span class="bars" aria-hidden="true"></span>
        </button>
    </div>
  </header>

  <!-- Mobile nav (toggle) -->
  <div id="mobile-nav" class="mobile-nav" hidden>
    <div class="nav-links" role="menubar" aria-hidden="false">
        <a href="#tournaments" role="menuitem">Tournaments</a>
        <a href="#games" role="menuitem">Games</a>
        <a href="#community" role="menuitem">Community</a>
        <a href="#support" role="menuitem">Support</a>
    </div>
    <div class="nav-actions">
        <!-- Mobile auth buttons will be injected here -->
    </div>
  </div>

  <main id="main">
    <!-- HERO -->
    <section class="hero" aria-labelledby="hero-title">
      <div class="hero__bg-slider">
        <img src="https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=2070&auto=format&fit=crop" alt="Esports event with crowd" class="active" />
        <img src="https://images.unsplash.com/photo-1585624838339-35939229208b?q=80&w=2070&auto=format&fit=crop" alt="Gamer with professional setup" />
        <img src="https://images.unsplash.com/photo-1609815788836-8339b601dfa3?q=80&w=1974&auto=format&fit=crop" alt="Esports arena stage" />
      </div>

      <div class="hero__overlay"></div>

      <div class="hero__content" role="region" aria-label="Hero">
        <h1 id="hero-title" class="tournament-name">Elite Gaming Tournaments</h1>
        <div id="prize-pool" class="prize-pool">
          Compete with the best players worldwide. Join exclusive tournaments, climb the ranks, and claim your victory in the ultimate gaming battleground.
        </div>
        
        <div class="hero-buttons">
            <a href="#tournaments" class="btn-primary" id="cta-learn-more">Browse Tournaments</a>
            <a href="#" class="btn-secondary">Watch Live</a>
        </div>
      </div>
    </section>

    <!-- Greeting Section -->
    <section class="greeting-section" aria-labelledby="greeting-title">
      <div class="container">
        <h2 id="greeting-title" class="greeting-title">Your Proving Ground Awaits</h2>
        <p class="greeting-subtitle">Welcome to EArena, the heart of competitive gaming. Discover tournaments, challenge rivals, and forge your legacy.</p>
      </div>
    </section>

    <!-- Tournaments -->
    <section id="tournaments" class="section container" aria-labelledby="tournaments-heading">
      <h2 id="tournaments-heading">
        Tournaments
      </h2>
      <div id="tournaments-grid" class="tournaments-grid">
        <!-- Tournament cards will be injected here by JavaScript -->
      </div>
    </section>

    <!-- Why Choose Us -->
    <section class="section why-section" aria-labelledby="why-heading">
      <div class="container">
        <div class="why-header">
          <h2 id="why-heading" class="why-title">Why choose <span class="accent">E</span>Arena?</h2>
          <p class="why-subtitle">Join the ultimate esports platform designed for champions</p>
        </div>
        <div class="why-grid" role="list">
          <div class="why-item" role="listitem">
            <i class="fa-solid fa-users" aria-hidden="true"></i>
            <h3 style="margin:.6rem 0 .25rem 0; color:var(--copy)">Thriving community</h3>
            <p style="color:var(--muted)">Join thousands of passionate players. Team up, scrim, and find matches fast.
            </p>
          </div>

      <h2 id="tournaments-heading" class="section-title">
        Featured Tournaments
      </h2>
      <div id="tournaments-grid" class="tournaments-grid">
        <!-- Tournament cards will be injected here by JavaScript -->
      </div>
    </section>
    
    <!-- Stats Section -->
    <section class="section stats-section">
        <div class="container stats-container">
            <div class="stat-item">
                <span class="stat-number">500+</span>
                <div class="stat-label">Tournaments Hosted</div>
            </div>
            <div class="stat-item">
                <span class="stat-number">$2M+</span>
                <div class="stat-label">Prize Money Awarded</div>
            </div>
            <div class="stat-item">
                <span class="stat-number">50K+</span>
                <div class="stat-label">Active Players</div>
            </div>
            <div class="stat-item">
                <span class="stat-number">24/7</span>
                <div class="stat-label">Live Support</div>
            </div>
        </div>
    </section>

    <!-- Why Choose Us, CTA -> These are removed in favor of the new design's flow -->

  </main>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-column footer-brand">
          <a href="index.html" class="brand">EArena</a>
          <p>The ultimate destination for competitive gaming.</p>
        </div>
        <div class="footer-column">
          <h4>Tournaments</h4>
          <ul>
            <li><a href="tournaments.html">Browse All</a></li>
            <li><a href="tournaments.html?filter=live">Live Matches</a></li>
            <li><a href="tournaments.html?filter=upcoming">Upcoming</a></li>
            <li><a href="tournaments.html?filter=completed">Past Results</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h4>Community</h4>
          <ul>
            <li><a href="#">Discord</a></li>
            <li><a href="#">Forums</a></li>
            <li><a href="#">Support</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h4>Company</h4>
          <ul>
            <li><a href="#">About</a></li>
            <li><a href="auth.html?tab=login&returnUrl=index.html">Sign In</a></li>
            <li><a href="#">Contact</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 EArena. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    // Helper function to redirect to auth with return URL
    function redirectToAuth(tab = 'register') {
      const currentUrl = window.location.href;
      const returnUrl = encodeURIComponent(currentUrl);
      window.location.href = `auth.html?tab=${tab}&returnUrl=${returnUrl}`;
    }

    // Enhanced smooth interactions and animations

    // Header scroll effect
    let lastScrollY = window.scrollY;
    const header = document.querySelector('.site-header');

    window.addEventListener('scroll', () => {
      const currentScrollY = window.scrollY;

      if (currentScrollY > 100) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }

      lastScrollY = currentScrollY;
    });

    // Hero background slider with smooth transitions
    const heroImages = document.querySelectorAll('.hero__bg-slider img');
    const heroContent = document.querySelector('.hero__content');
    let currentImageIndex = 0;

    // API Configuration
    // Auto-detect API URL based on environment
    const isLocal = window.location.hostname === 'localhost' || 
                   window.location.hostname === '127.0.0.1' || 
                   window.location.protocol === 'file:';
    
    const API_BASE_URL = isLocal ? 'http://localhost:8000' : 'https://t2-237c.onrender.com';

    // Hero content data - will be populated from API
    let heroData = [];
    let isDataLoaded = false;

    // API Functions
    async function fetchTournaments(retryCount = 0) {
      const maxRetries = 3;

      try {
        showLoadingState();

        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 10000); // 10s

        const response = await fetch(`${API_BASE_URL}/api/tournaments`, {
          signal: controller.signal,
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          }
        });

        clearTimeout(timeoutId);

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const body = await response.json();
        const tournaments = Array.isArray(body) ? body : (body.data || []);

        if (!Array.isArray(tournaments)) {
          throw new Error('Invalid data format received from API');
        }

        console.log('Fetched tournaments (normalized):', tournaments);

        // Transform data for hero
        heroData = tournaments.slice(0, 3).map(t => {
          const rawPoster = t.posterImage || t.backgroundImage || t.poster || t.image || null;
          let finalPoster = rawPoster;
          if (rawPoster && !rawPoster.startsWith('http')) {
              const cleanPosterPath = rawPoster.replace(/^\//, '');
              // The path should now correctly point to /uploads/
              finalPoster = `${API_BASE_URL}/${cleanPosterPath}`;
          }
          return {
            id: t._id || t.id,
            slug: t.slug,
            title: t.title || t.name || 'Untitled Tournament',
            prizePool: `Prize Pool: ₹${(t.prizePool || 0).toLocaleString('en-IN')}`,
            description: t.description || 'Join this exciting tournament!',
            detailsLink: `tournament-details.html?slug=${t.slug || t._id || t.id}`,
            poster: finalPoster,
            status: calculateTournamentStatus(t),
            game: t.game || 'Gaming'
          };
        });

        isDataLoaded = true;
        hideLoadingState();

        if (heroData.length > 0) {
          updateHeroContent(0);
          startHeroSlider();
        }

        return tournaments;
      } catch (error) {
        console.error(`Error fetching tournaments (attempt ${retryCount + 1}):`, error);

        if (retryCount < maxRetries && error.name !== 'AbortError') {
          await new Promise(res => setTimeout(res, (retryCount + 1) * 2000));
          return fetchTournaments(retryCount + 1);
        }

        hideLoadingState();
        showErrorState();

        // fallback demo content
        heroData = [{
          title: "EArena Championships",
          prizePool: "Prize Pool: ₹1,00,000",
          description: "Experience the ultimate gaming competition. Connect to see live tournaments and join the action!",
          detailsLink: "tournaments.html"
        }];

        if (heroData.length > 0) {
          updateHeroContent(0);
        }

        return [];
      }
    }

    // Loading and Error States
    function showLoadingState() {
      const heroTitle = document.getElementById('hero-title');
      const prizePool = document.getElementById('prize-pool');
      const description = document.getElementById('tournament-description');

      if (heroTitle) heroTitle.textContent = 'Loading Tournaments...';
      if (prizePool) prizePool.textContent = 'Fetching latest data...';
      if (description) description.textContent = 'Please wait while we load the most exciting tournaments for you.';

      // Add loading animation to CTA button
      const ctaButton = document.getElementById('cta-learn-more');
      if (ctaButton) {
        ctaButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
        ctaButton.style.pointerEvents = 'none';
      }

      // Show loading states for other sections
      showSectionLoadingStates();
    }

    function showSectionLoadingStates() {
      // Recent matches loading
      const recentMatchesList = document.querySelector('#recent-matches-title')?.parentElement?.querySelector('.tournament-list');
      if (recentMatchesList) {
        recentMatchesList.innerHTML = `
          <li style="opacity: 0.6;">
            <div>
              <h4><i class="fas fa-spinner fa-spin"></i> Loading recent matches...</h4>
              <p>Fetching latest match data</p>
            </div>
          </li>
        `;
      }

      // Upcoming tournaments loading
      const upcomingList = document.querySelector('#upcoming-title')?.parentElement?.querySelector('.tournament-list');
      if (upcomingList) {
        upcomingList.innerHTML = `
          <li style="opacity: 0.6;">
            <div>
              <h4><i class="fas fa-spinner fa-spin"></i> Loading upcoming tournaments...</h4>
              <p>Fetching schedule data</p>
            </div>
          </li>
        `;
      }

      // Live matches loading
      const liveList = document.querySelector('#live-title')?.parentElement?.querySelector('.tournament-list');
      if (liveList) {
        liveList.innerHTML = `
          <li style="opacity: 0.6;">
            <div>
              <h4><i class="fas fa-spinner fa-spin"></i> Loading live matches...</h4>
              <p>Checking for live tournaments</p>
            </div>
          </li>
        `;
      }
    }

    function hideLoadingState() {
      const ctaButton = document.getElementById('cta-learn-more');
      if (ctaButton) {
        ctaButton.innerHTML = 'Tournament Details';
        ctaButton.style.pointerEvents = 'auto';
      }
    }

    function showErrorState() {
      const heroTitle = document.getElementById('hero-title');
      const prizePool = document.getElementById('prize-pool');
      const description = document.getElementById('tournament-description');

      if (heroTitle) heroTitle.textContent = 'Connection Error';
      if (prizePool) prizePool.textContent = 'Unable to load tournaments';
      if (description) description.textContent = 'We\'re having trouble connecting to our servers. Please refresh the page or try again later.';

      const ctaButton = document.getElementById('cta-learn-more');
      if (ctaButton) {
        ctaButton.innerHTML = '<i class="fas fa-refresh"></i> Retry';
        ctaButton.onclick = async (e) => {
          e.preventDefault();
          ctaButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Retrying...';
          ctaButton.style.pointerEvents = 'none';

          try {
            await populateAllSections();
          } catch (error) {
            console.error('Retry failed:', error);
            setTimeout(() => {
              ctaButton.innerHTML = '<i class="fas fa-refresh"></i> Retry';
              ctaButton.style.pointerEvents = 'auto';
            }, 2000);
          }
        };
      }

      // Show error notification
      console.error('Unable to load tournament data. Please check your connection.');
    }

    function updateHeroContent(index) {
      if (!heroData || heroData.length === 0) return;

      const data = heroData[index];
      if (!data) return;

      // Fade out content
      heroContent.classList.remove('active');

      setTimeout(() => {
        // Update content
        const heroTitle = document.getElementById('hero-title');
        const prizePool = document.getElementById('prize-pool');
        const description = document.getElementById('tournament-description');
        const detailsButton = document.getElementById('cta-learn-more');

        if (heroTitle) heroTitle.textContent = data.title;
        if (prizePool) prizePool.textContent = data.prizePool;
        if (description) description.textContent = data.description;
        if (prizePool) prizePool.textContent = data.prizePool; // Update prize pool in the hero

        // Update button link
        if (detailsButton && data.detailsLink) {
          detailsButton.href = data.detailsLink;
          detailsButton.onclick = null; // Remove any error retry handlers
        }

        // Update background image if available
        if (data.poster) {
          updateHeroBackground(data.poster, index);
        }

        // Fade in content
        heroContent.classList.add('active');
      }, 300);
    }

    function updateHeroBackground(posterUrl, index) {
      const heroImages = document.querySelectorAll('.hero__bg-slider img');
      if (heroImages[index]) {
        // Create a new image to test if the URL is valid
        const img = new Image();
        img.onload = () => {
          heroImages[index].src = posterUrl;
        };
        img.onerror = () => {
          console.warn(`Failed to load poster image: ${posterUrl}`);
          // Keep the default image
        };
        img.src = posterUrl;
      }
    }

    function nextHeroSlide() {
      if (!isDataLoaded || heroData.length === 0) return;

      const heroImages = document.querySelectorAll('.hero__bg-slider img');
      if (heroImages.length === 0) return;

      heroImages[currentImageIndex].classList.remove('active');
      currentImageIndex = (currentImageIndex + 1) % Math.min(heroData.length, heroImages.length);
      heroImages[currentImageIndex].classList.add('active');
      updateHeroContent(currentImageIndex);
    }

    function startHeroSlider() {
      if (heroData.length > 1) {
        setInterval(nextHeroSlide, 6000);
      }
    }

    // Initialize hero
    heroContent.classList.add('active');

    // Additional API Functions
    async function fetchRecentMatches() {
      console.warn("Using placeholder for fetchRecentMatches");
      return null;
    }
    
    async function fetchLiveMatches() {
      console.warn("Using placeholder for fetchLiveMatches");
      return null;
    }
    
    async function fetchUpcomingMatches() {
      console.warn("Using placeholder for fetchUpcomingMatches");
      return null;
    }
    
    async function fetchSponsoredContent() {
      console.warn("Using placeholder for fetchSponsoredContent");
      return null;
    }

    async function fetchTournamentStats() {
        console.warn("Using placeholder for fetchTournamentStats");
        return null;
    }

    async function fetchFeaturedTournaments() {
      try {
        const response = await fetch(`${API_BASE_URL}/api/tournaments/featured`, {
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          }
        });
        if (response.ok) {
          const body = await response.json();
          return Array.isArray(body) ? body : (body.data || []);
        }
      } catch (error) {
        console.warn('Featured tournaments endpoint not available:', error);
      }
      return null;
    }

    // Main Content Population Function
    async function populateAllSections() {
      try {
        console.log('Fetching all content data...');

        const [
          tournamentsResponse,
          stats
        ] = await Promise.allSettled([
          fetch(`${API_BASE_URL}/api/tournaments`),
          fetchTournamentStats()
        ]);

        let tournaments = [];
        if (tournamentsResponse.status === 'fulfilled' && tournamentsResponse.value.ok) {
            const body = await tournamentsResponse.value.json();
            tournaments = body.data || [];
        }


        if (tournaments.length > 0) {
          populateTournamentsGrid(tournaments);
        }
        
        if (stats.status === 'fulfilled' && stats.value) {
            updateStatsDisplay(stats.value);
        }

        console.log('All content sections populated successfully');
      } catch (error) {
        console.error('Error populating content sections:', error);
      }
    }

    // Tournament status calculation function
    function calculateTournamentStatus(tournament) {
      const now = new Date();
      
      const regStart = new Date(tournament.registrationStart);
      const regEnd = new Date(tournament.registrationEnd);
      const tournStart = new Date(tournament.tournamentStart);
      const tournEnd = new Date(tournament.tournamentEnd);
      
      if (now < regStart) {
        return 'upcoming';
      } else if (now >= regStart && now <= regEnd) {
        return 'registration_open';
      } else if (now > regEnd && now < tournStart) {
        return 'registration_closed';
      } else if (now >= tournStart && now <= tournEnd) {
        return 'live';
      } else {
        return 'completed';
      }
    }
    
    function getStatusDisplayInfo(status) {
        const map = {
            'upcoming': { text: 'Upcoming', class: 'upcoming' },
            'registration_open': { text: 'Registering', class: 'registration_open' },
            'registration_closed': { text: 'Registration Closed', class: 'registration_closed' },
            'live': { text: 'Live Now', class: 'live' },
            'completed': { text: 'Completed', class: 'completed' }
        };
        return map[status] || { text: status.replace(/_/g, ' '), class: 'default' };
    }

    function populateTournamentsGrid(tournaments) {
        const grid = document.getElementById('tournaments-grid');
        if (!grid) return;

        if (tournaments.length === 0) {
            grid.innerHTML = '<p style="text-align: center; width: 100%; grid-column: 1 / -1;">No tournaments available at the moment. Check back soon!</p>';
            return;
        }

        grid.innerHTML = tournaments.slice(0, 6).map(tournament => { // Displaying up to 6 tournaments
            const status = calculateTournamentStatus(tournament);
            const statusInfo = getStatusDisplayInfo(status);
            
            const rawPoster = tournament.posterImage || tournament.backgroundImage || null;
            let finalPoster = 'https://images.unsplash.com/photo-1511556532299-8f662fc26c06?q=80&w=2070&auto=format&fit=crop'; // Default fallback
            if (rawPoster && !rawPoster.startsWith('http')) {
                const cleanPosterPath = rawPoster.replace(/^\//, '');
                finalPoster = `${API_BASE_URL}/${cleanPosterPath}`;
            } else if (rawPoster) {
                finalPoster = rawPoster;
            }

            return `
                <a href="tournament-details.html?slug=${tournament.slug}" class="tournament-card">
                    <div class="tournament-card__poster">
                        <img src="${finalPoster}" alt="${tournament.title} Poster" onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1511556532299-8f662fc26c06?q=80&w=2070&auto=format&fit=crop';">
                    </div>
                    <div class="tournament-card__info">
                        <h3 class="tournament-card__title">${tournament.title}</h3>
                        <div class="tournament-info">
                            <span>📅 ${new Date(tournament.tournamentStart).toLocaleDateString()}</span>
                            <span>👥 ${tournament.maxTeams} Teams</span>
                        </div>
                        <div class="prize-pool">💰 ₹${(tournament.prizePool || 0).toLocaleString('en-IN')} Prize Pool</div>
                        <p>${tournament.description.substring(0, 100)}...</p>
                    </div>
                </a>
            `;
        }).join('');
    }


    function updateStatsDisplay(stats) {
      if (!stats) return;
      document.querySelector('.stats-container .stat-item:nth-child(1) .stat-number').textContent = stats.totalTournaments ? `${stats.totalTournaments}+` : '500+';
      document.querySelector('.stats-container .stat-item:nth-child(2) .stat-number').textContent = stats.totalPrizePool ? `$${(stats.totalPrizePool/1000000).toFixed(1)}M+` : '$2M+';
      document.querySelector('.stats-container .stat-item:nth-child(3) .stat-number').textContent = stats.activePlayers ? `${Math.floor(stats.activePlayers/1000)}K+` : '50K+';
    }

    // Deprecated functions from old design
    function populateRecentMatches() {}
    function updateLiveMatches() {}
    function updateUpcomingMatches() {}
    function populateSponsoredContent() {}
    function populateUpcomingTournaments() {}
    function populateLiveTournaments() {}

    // Mobile menu toggle
    const hamburger = document.querySelector('.hamburger');
    const mobileNav = document.getElementById('mobile-nav');

    function toggleMobileMenu() {
      const isOpen = hamburger.getAttribute('aria-expanded') === 'true';
      hamburger.setAttribute('aria-expanded', !isOpen);
      mobileNav.classList.toggle('is-open');
      mobileNav.hidden = isOpen;
      document.body.style.overflow = isOpen ? '' : 'hidden';

      // Populate mobile nav actions based on auth state
      const mobileNavActions = document.querySelector('#mobile-nav .nav-actions');
      const authButtons = document.querySelector('#auth-buttons');
      const userMenu = document.querySelector('#user-menu');

      if (userMenu.style.display !== 'none') {
          mobileNavActions.innerHTML = `
            <a href="user-dashboard.html" class="header-cta">My Account</a>
            <a href="#" onclick="logout()" class="login-link" style="display: inline-block; color: white;">Logout</a>
          `;
      } else {
           mobileNavActions.innerHTML = `
            <button class="header-cta" onclick="redirectToAuth()">Join Now</button>
          `;
      }
    }

    if (hamburger) {
      hamburger.addEventListener('click', toggleMobileMenu);
    }
    document.addEventListener('click', function (event) {
      if (!mobileNav.contains(event.target) && !hamburger.contains(event.target) && mobileNav.classList.contains('is-open')) {
        toggleMobileMenu();
      }
    });
    
    // Animate stats on scroll
    function animateStats() {
        const statNumbers = document.querySelectorAll('.stat-number');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const target = entry.target;
                    target.style.animation = 'glow 1.5s ease-in-out';
                    observer.unobserve(target); // Animate only once
                }
            });
        }, { threshold: 0.8 });
        statNumbers.forEach(stat => observer.observe(stat));
    }


    // Smooth scroll for navigation links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
    });

    // Add ripple effect to buttons
    function createRipple(event) {
      const button = event.currentTarget;
      const circle = document.createElement('span');
      const diameter = Math.max(button.clientWidth, button.clientHeight);
      const radius = diameter / 2;
      circle.style.width = circle.style.height = `${diameter}px`;
      circle.style.left = `${event.clientX - button.offsetLeft - radius}px`;
      circle.style.top = `${event.clientY - button.offsetTop - radius}px`;
      circle.classList.add('ripple');
      const ripple = button.getElementsByClassName('ripple')[0];
      if (ripple) ripple.remove();
      button.appendChild(circle);
    }
    const rippleStyle = document.createElement('style');
    rippleStyle.textContent = `
      .btn--primary, .header-cta { position: relative; overflow: hidden; }
      .ripple { position: absolute; border-radius: 50%; background-color: rgba(255, 255, 255, 0.3); transform: scale(0); animation: ripple-animation 0.6s linear; pointer-events: none; }
      @keyframes ripple-animation { to { transform: scale(4); opacity: 0; } }`;
    document.head.appendChild(rippleStyle);
    document.querySelectorAll('.btn--primary, .header-cta').forEach(button => {
      button.addEventListener('click', createRipple);
    });

    // Connection status monitoring
    window.addEventListener('online', () => {
      console.log('Connection restored! Refreshing all content...');
      populateAllSections().catch(console.error);
    });
    window.addEventListener('offline', () => {
      console.warn('Connection lost. Some features may not work properly.');
    });

    // Authentication and User Management
    function checkUserAuthentication() {
        const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');
        if (!session) {
            clearUserSession();
            return;
        }

        try {
            const sessionData = JSON.parse(session);
            const user = sessionData?.data?.user;
            const token = sessionData?.data?.token;

            if (!user || !token) {
                clearUserSession();
                return;
            }

            const username = user.username || user.email.split('@')[0];
            const isAdmin = user.roles && user.roles.includes('admin');

            // Update UI
            document.getElementById('modal-username').textContent = username;
            document.getElementById('mobile-user-username').textContent = username;

            document.getElementById('auth-buttons').style.display = 'none';
            document.getElementById('user-menu').style.display = 'flex';
            document.getElementById('mobile-auth-buttons').style.display = 'none';
            document.getElementById('mobile-user-menu').style.display = 'flex';

            if (isAdmin) {
                document.getElementById('modal-role-badge').style.display = 'inline-block';
                document.getElementById('host-nav-item').style.display = 'block';
                document.getElementById('mobile-user-role-badge').style.display = 'inline-block';
                document.getElementById('mobile-host-section').style.display = 'block';
            } else {
                clearAdminUI();
            }
        } catch (error) {
            console.error('Invalid session data:', error);
            clearUserSession();
        }
    }
    
    function clearAdminUI() {
        document.getElementById('modal-role-badge').style.display = 'none';
        document.getElementById('host-nav-item').style.display = 'none';
        document.getElementById('mobile-user-role-badge').style.display = 'none';
        document.getElementById('mobile-host-section').style.display = 'none';
    }


    function clearUserSession() {
      localStorage.removeItem('earena_session');
      sessionStorage.removeItem('earena_session');
      
      document.getElementById('auth-buttons').style.display = 'flex';
      document.getElementById('user-menu').style.display = 'none';
      document.getElementById('mobile-auth-buttons').style.display = 'flex';
      document.getElementById('mobile-user-menu').style.display = 'none';
      clearAdminUI();
    }

    async function logout() {
      try {
        const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');
        if (session) {
          const sessionData = JSON.parse(session);
          const token = sessionData?.data?.token;
          if (token) {
              await fetch(`${API_BASE_URL}/api/auth/logout`, {
                method: 'POST',
                headers: { 'Authorization': `Bearer ${token}` }
              });
          }
        }
      } catch (error) {
        console.error('Logout API error:', error);
      } finally {
        clearUserSession();
        console.log('Logged out successfully');
        window.location.reload();
      }
    }

    // Initialize the page
    document.addEventListener('DOMContentLoaded', async () => {
      console.log('Initializing EArena homepage...');
      createParticles();
      animateStats();
      checkUserAuthentication();
      if (navigator.onLine) {
        addGlobalLoadingIndicator();
        try {
          await fetchTournaments(); 
          await populateAllSections();
          console.log('Content loaded successfully');
        } catch (error) {
          console.error('Failed to initialize page content:', error);
        } finally {
          removeGlobalLoadingIndicator();
        }
      } else {
        console.error('No internet connection detected.');
        showErrorState();
      }
    });

    // Global loading indicator
    function addGlobalLoadingIndicator() {
      if (document.getElementById('global-loader')) return;
      const loader = document.createElement('div');
      loader.id = 'global-loader';
      loader.style.cssText = `position: fixed; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, var(--accent), var(--accent-2)); z-index: 10001; animation: loading-bar 2s ease-in-out infinite;`;
      if (!document.querySelector('#loading-animation-style')) {
        const style = document.createElement('style');
        style.id = 'loading-animation-style';
        style.textContent = `@keyframes loading-bar { 0% { transform: translateX(-100%); } 50% { transform: translateX(0%); } 100% { transform: translateX(100%); } }`;
        document.head.appendChild(style);
      }
      document.body.appendChild(loader);
    }

    function removeGlobalLoadingIndicator() {
      const loader = document.getElementById('global-loader');
      if (loader) {
        loader.style.opacity = '0';
        setTimeout(() => loader.remove(), 300);
      }
    }

    function removeGlobalLoadingIndicator() {
      const loader = document.getElementById('global-loader');
      if (loader) {
        loader.style.opacity = '0';
        setTimeout(() => loader.remove(), 300);
      }
    }

    // Create animated particles
    function createParticles() {
        const particlesContainer = document.getElementById('particles');
        if(!particlesContainer) return;
        const particleCount = 50;

        for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.top = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 6 + 's';
            particle.style.animationDuration = (3 + Math.random() * 6) + 's';
            particlesContainer.appendChild(particle);
        }
    }
  </script>
</body>

</html>


