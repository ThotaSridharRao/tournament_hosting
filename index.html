<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description"
    content="EArena — host and compete. Clean, accessible esports landing page with responsive layout and video hero." />
  <meta name="theme-color" content="#0b0b0b" />
  <title>EArena — Compete | Host | Win</title>

  <!-- Fonts & icons (preload & preconnect for performance) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity=""
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <style>
    /* =========================
       Theme variables (Skeuomorphic)
       ========================= */
    :root {
      /* Skeuomorphic Palette & Textures */
      --bg-color-top: #3d3d3d;
      --bg-color-bottom: #2c2c2c;
      --panel-bg-top: #3a3a3a;
      --panel-bg-bottom: #282828;
      --button-bg-top: #5a5a5a;
      --button-bg-bottom: #404040;
      --button-hover-top: #6a6a6a;
      --button-hover-bottom: #505050;
      --button-active-top: #383838;
      --button-active-bottom: #484848;
      
      --bg-texture: url('https://www.transparenttextures.com/patterns/carbon-fibre.png');

      /* Core variables */
      --muted: #b0b0b0;
      --copy: #e6e6e6;
      --accent: #FFD700;
      --accent-2: #e0ac10;
      --radius: 12px;
      --container: 1200px;
      --ease: 180ms cubic-bezier(.2, .9, .2, 1);
      --max-hero-height: 880px;
      --focus: 3px solid rgba(255, 215, 0, 0.2);
    }

    /* Enhanced easing curves for smoother animations */
    :root {
      --ease-out-quart: cubic-bezier(0.25, 1, 0.5, 1);
      --ease-in-out-quart: cubic-bezier(0.76, 0, 0.24, 1);
      --ease-out-back: cubic-bezier(0.34, 1.56, 0.64, 1);
      --spring: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    /* Respect reduced motion preferences */
    @media (prefers-reduced-motion: reduce) {
      :root {
        --ease: 0ms;
      }

      * {
        transition-duration: 0ms !important;
        animation-duration: 0ms !important;
        animation-iteration-count: 1 !important;
      }
    }

    /* =========================
       Base resets & accessibility
       ========================= */
    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background-color: var(--bg-color-bottom);
      background-image: var(--bg-texture), linear-gradient(180deg, var(--bg-color-top), var(--bg-color-bottom) 140%);
      color: var(--copy);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.45;
      -webkit-text-size-adjust: 100%;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    img,
    video,
    iframe {
      max-width: 100%;
      display: block;
    }

    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    /* Skip link for keyboard users */
    .skip-link {
      position: absolute;
      left: -999px;
      top: auto;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }

    .skip-link:focus {
      left: 1rem;
      top: 1rem;
      width: auto;
      height: auto;
      padding: .5rem .75rem;
      background: rgba(0, 0, 0, .8);
      border-radius: 6px;
      color: var(--copy);
      z-index: 9999;
    }

    /* =========================
       Layout helpers
       ========================= */
    .container {
      width: min(94%, var(--container));
      margin: 0 auto;
    }

    /* Skeuomorphic Header */
    header.site-header {
      position: fixed;
      inset: 0 0 auto 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      background: linear-gradient(180deg, #4a4a4a, #383838);
      z-index: 1200;
      border-bottom: 1px solid #222;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5), inset 0 1px 1px rgba(255, 255, 255, 0.1);
      transition: all 0.3s var(--ease-out-quart);
      height: 60px;
    }

    header.site-header.scrolled {
      background: linear-gradient(180deg, #3a3a3a, #282828);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6), inset 0 1px 1px rgba(255, 255, 255, 0.1);
    }
    
    .brand {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 700;
      letter-spacing: -0.5px;
      color: var(--copy);
      font-size: 1.2rem;
      text-decoration: none;
      transition: all 0.3s ease;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
    }

    .brand:hover {
      color: var(--accent);
      transform: scale(1.05);
    }

    .brand .accent {
      color: var(--accent);
    }

    /* This rule was removed to delete the logo */
    /* .brand::before {
      content: "⬜";
      font-size: 1rem;
      color: var(--accent);
      text-shadow: 0 0 5px var(--accent);
    } */

    nav.primary {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    /* Nav links — desktop */
    .nav-links {
      display: flex;
      gap: 0;
      align-items: center;
    }

    .nav-item {
      position: relative;
    }

    .nav-links a {
      color: #ccc;
      padding: 1rem 1.5rem;
      font-weight: 500;
      font-size: 0.9rem;
      position: relative;
      transition: all 0.3s var(--ease-out-quart);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-shadow: 1px 1px 1px #000;
    }

    .nav-links a:hover,
    .nav-links a:focus {
      color: #ffffff;
      outline: none;
    }

    .nav-links a.active {
      color: #ffffff;
    }

    /* Dropdown styles */
    .dropdown-arrow {
      font-size: 0.7rem;
      transition: transform 0.3s var(--ease-out-quart);
    }

    .nav-item:hover .dropdown-arrow {
      transform: rotate(180deg);
    }

    .dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      background: #2a2a2a;
      border: 1px solid #111;
      border-top: 1px solid #444;
      border-radius: 8px;
      min-width: 200px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s var(--ease-out-quart);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      z-index: 1000;
    }

    .nav-item:hover .dropdown-menu {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .dropdown-menu a {
      padding: 0.75rem 1rem;
      border-bottom: 1px solid rgba(0,0,0, 0.2);
      font-size: 0.85rem;
      color: #bbb;
    }

    .dropdown-menu a:last-child {
      border-bottom: none;
    }

    .dropdown-menu a:hover {
      background: rgba(255, 255, 255, 0.05);
      color: #ffffff;
    }

    /* Right side actions */
    .nav-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .login-link {
      color: #ccc;
      font-weight: 500;
      font-size: 0.9rem;
      padding: 0.5rem 1rem;
      transition: all 0.3s var(--ease-out-quart);
      text-shadow: 1px 1px 1px #000;
    }

    .login-link:hover {
      color: #ffffff;
    }

    /* Skeuomorphic CTA in header */
    .header-cta {
      padding: 0.6rem 1.2rem;
      border-radius: 6px;
      background: linear-gradient(180deg, var(--accent), var(--accent-2));
      color: #000;
      font-weight: 700;
      font-size: 0.9rem;
      transition: all 0.1s ease-out;
      border-top: 1px solid #fff8d4;
      border-left: 1px solid #fff8d4;
      border-right: 1px solid #a68a00;
      border-bottom: 1px solid #a68a00;
      box-shadow: 0 4px 8px rgba(0,0,0,0.4), inset 0 1px 1px rgba(255,255,255,0.3);
    }
    
    .header-cta:hover {
        background: linear-gradient(180deg, #ffdf33, #e0ac10);
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0,0,0,0.5), inset 0 1px 1px rgba(255,255,255,0.4);
    }
    
    .header-cta:active {
        background: linear-gradient(0deg, var(--accent), var(--accent-2));
        transform: translateY(1px);
        box-shadow: 0 2px 4px rgba(0,0,0,0.4), inset 0 2px 2px rgba(0,0,0,0.2);
    }
    
    .header-cta:focus {
      outline: none;
    }

    /* Profile Dropdown Styles */
    .profile-dropdown {
      position: relative;
      display: flex;
      align-items: center;
    }

    .profile-icon {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--copy);
      cursor: pointer;
      border-radius: 50%;
      transition: all 0.3s ease;
      font-size: 1.5rem;
    }

    .profile-icon:hover {
      color: var(--accent);
      background: rgba(255, 215, 0, 0.1);
      transform: scale(1.1);
    }

    .profile-modal {
      position: absolute;
      top: 100%;
      right: 0;
      background: linear-gradient(145deg, #3a3a3a, #282828);
      border: 1px solid #111;
      border-top: 1px solid #555;
      border-radius: 12px;
      min-width: 280px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s var(--ease-out-quart);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
      z-index: 1000;
      margin-top: 10px;
    }

    .profile-dropdown:hover .profile-modal {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .profile-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1.5rem;
      border-bottom: 1px solid rgba(0,0,0,0.3);
      box-shadow: inset 0 -1px 0 rgba(255,255,255,0.05);
    }

    .profile-photo {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #000;
      font-size: 1.5rem;
      flex-shrink: 0;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
    }

    .profile-info {
      flex: 1;
    }

    .profile-username {
      font-weight: 700;
      color: var(--copy);
      font-size: 1.1rem;
      margin-bottom: 0.25rem;
      text-shadow: 1px 1px 1px #000;
    }

    .profile-role {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #000;
      padding: 0.25rem 0.5rem;
      border-radius: 12px;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: inline-block;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .profile-actions {
      padding: 0.5rem;
    }

    .profile-action {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      color: var(--copy);
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-weight: 600;
      font-size: 0.95rem;
      width: 100%;
      border: none;
      background: none;
      cursor: pointer;
      font-family: inherit;
      text-shadow: 1px 1px 1px #000;
    }

    .profile-action:hover {
      background: rgba(255, 255, 255, 0.05);
      color: var(--accent);
      transform: translateX(4px);
    }

    .logout-action:hover {
      background: rgba(255, 0, 0, 0.1);
      color: #ff6b6b;
    }

    .profile-action i {
      width: 16px;
      text-align: center;
    }

    #user-menu {
      display: flex;
      align-items: center;
    }

    /* Hamburger (mobile) */
    .hamburger {
      display: none;
      background: none;
      border: 0;
      padding: .5rem;
      margin-left: .5rem;
      cursor: pointer;
      color: var(--copy);
    }

    .hamburger .bars {
      display: inline-block;
      width: 22px;
      height: 2px;
      background: var(--copy);
      border-radius: 2px;
      position: relative;
      transition: var(--ease);
      box-shadow: 0 0 2px rgba(0,0,0,0.5);
    }

    .hamburger .bars::before,
    .hamburger .bars::after {
      content: "";
      position: absolute;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--copy);
      border-radius: 2px;
      transition: var(--ease);
      box-shadow: 0 0 2px rgba(0,0,0,0.5);
    }

    .hamburger .bars::before {
      top: -7px;
    }

    .hamburger .bars::after {
      top: 7px;
    }

    .hamburger[aria-expanded="true"] .bars {
      background: transparent;
    }

    .hamburger[aria-expanded="true"] .bars::before {
      transform: translateY(7px) rotate(-45deg);
      top: 0;
    }

    .hamburger[aria-expanded="true"] .bars::after {
      transform: translateY(-7px) rotate(45deg);
      top: 0;
    }

    /* Mobile nav overlay */
    .mobile-nav {
      display: none;
      position: fixed;
      inset: 60px 0 0 0;
      background: #2a2a2a;
      z-index: 1100;
      overflow: auto;
    }

    .mobile-nav.is-open {
      display: block;
    }

    .mobile-nav-section {
      border-bottom: 1px solid rgba(0,0,0,0.2);
      box-shadow: inset 0 -1px 0 rgba(255,255,255,0.05);
    }

    .mobile-nav-title {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      color: rgba(255, 255, 255, 0.9);
      font-weight: 600;
      cursor: pointer;
    }

    .mobile-nav-items {
      padding-left: 2rem;
      display: none;
      background: rgba(0,0,0,0.1);
    }

    .mobile-nav-items .mobile-link {
      display: block;
      padding: 0.75rem 1.5rem;
      color: rgba(255, 255, 255, 0.7);
      font-size: 0.9rem;
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }

    .mobile-nav>nav>.mobile-link {
      display: block;
      padding: 1rem 1.5rem;
      color: rgba(255, 255, 255, 0.8);
      font-weight: 500;
      border-bottom: 1px solid rgba(0,0,0,0.2);
    }

    .mobile-nav-actions {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 1.5rem;
      background: #2a2a2a;
      border-top: 1px solid #111;
      box-shadow: 0 -5px 15px rgba(0,0,0,0.4);
    }

    /* Mobile Auth Buttons */
    #mobile-auth-buttons {
      display: flex;
      gap: 1rem;
    }

    .mobile-login-btn {
      flex: 1;
      padding: 0.875rem 1rem;
      background: linear-gradient(180deg, #666, #444);
      color: var(--copy);
      border: 1px solid #222;
      border-top-color: #777;
      border-radius: 8px;
      font-weight: 600;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
      font-size: 0.95rem;
      box-shadow: 0 3px 6px rgba(0,0,0,0.3);
    }
    
    .mobile-signup-btn {
      flex: 1;
      padding: 0.875rem 1rem;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #000;
      border: none;
      border-radius: 8px;
      font-weight: 700;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
      font-size: 0.95rem;
      cursor: pointer;
      font-family: inherit;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
    }

    /* Mobile User Menu */
    #mobile-user-menu {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .mobile-user-info {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      border: 1px solid #111;
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.4);
    }

    .mobile-user-avatar {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #000;
      font-size: 1.2rem;
    }

    .mobile-user-details {
      flex: 1;
    }

    .mobile-username {
      display: block;
      color: var(--copy);
      font-weight: 700;
      font-size: 1rem;
      margin-bottom: 0.25rem;
    }

    .mobile-user-role {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #000;
      padding: 0.25rem 0.5rem;
      border-radius: 12px;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .mobile-logout-btn {
      width: 100%;
      padding: 0.875rem;
      background: linear-gradient(180deg, #8c2a2a, #6b1e1e);
      border: 1px solid #441515;
      border-top-color: #b84d4d;
      border-radius: 8px;
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      box-shadow: 0 3px 6px rgba(0,0,0,0.3);
    }

    /* =========================
       Hero section
       ========================= */
    .hero {
      position: relative;
      height: 80vh;
      min-height: 600px;
      display: flex;
      align-items: flex-end;
      justify-content: flex-start;
      overflow: hidden;
      color: #fff;
      padding: 2rem 1rem;
    }

    .hero__bg-slider {
      position: absolute;
      inset: 0;
    }

    .hero__bg-slider img {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: all 3s var(--ease-in-out-quart);
      transform: scale(1.1) rotate(0.5deg);
      filter: brightness(0.8) contrast(1.1);
    }

    .hero__bg-slider img.active {
      opacity: 1;
      transform: scale(1) rotate(0deg);
      filter: brightness(1) contrast(1.2);
    }


    .hero__overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, #2c2c2c 15%, transparent 80%);
      z-index: 1;
    }

    .hero__content {
      position: relative;
      z-index: 2;
      width: min(94%, var(--container));
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      padding: 3rem;
      max-width: 700px;
      transition: all 1.2s var(--ease-out-quart);
      opacity: 0;
      transform: translateY(40px) translateX(-20px);
    }

    .hero__content.active {
      opacity: 1;
      transform: translateY(0) translateX(0);
    }

    .hero__content>* {
      transition: all 0.8s var(--ease-out-quart);
      transform: translateY(20px);
      opacity: 0;
    }

    .hero__content.active>* {
      transform: translateY(0);
      opacity: 1;
    }

    .hero__content.active>*:nth-child(1) {
      transition-delay: 0.1s;
    }

    .hero__content.active>*:nth-child(2) {
      transition-delay: 0.2s;
    }

    .hero__content.active>*:nth-child(3) {
      transition-delay: 0.3s;
    }

    .hero__content.active>*:nth-child(4) {
      transition-delay: 0.4s;
    }
    
    .hero__content .tournament-name {
      font-size: clamp(2.5rem, 5vw, 4rem);
      font-weight: 800;
      line-height: 1.1;
      margin: 0;
      color: #e0e0e0;
      text-shadow: 
        -2px -2px 2px rgba(255,255,255,0.05),
        2px 2px 3px rgba(0,0,0,0.9);
    }

    .hero__content .prize-pool {
      font-size: 1.5rem;
      color: var(--accent);
      font-weight: bold;
      text-shadow: 0 0 12px var(--accent), 1px 1px 2px rgba(0, 0, 0, 0.9);
      margin: 0.5rem 0;
    }

    .hero__content p {
      color: var(--muted);
      max-width: 500px;
      line-height: 1.6;
      font-size: 1.1rem;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.9);
    }
    
    /* Skeuomorphic Primary Button */
    .btn--primary {
      display: inline-flex;
      align-items: center;
      gap: .8rem;
      padding: 1rem 2rem;
      border-radius: 999px;
      font-weight: 700;
      cursor: pointer;
      width: max-content;
      transition: all 0.1s ease-out;
      text-decoration: none;
      margin-top: 1.5rem;
      min-width: 180px;
      justify-content: center;
      position: relative;
      overflow: hidden;
      font-size: 1.1rem;

      background: linear-gradient(180deg, var(--accent), var(--accent-2));
      color: #000;
      text-shadow: 1px 1px 0px rgba(255,255,255,0.3);
      border-top: 1px solid #fff8d4;
      border-left: 1px solid #fff8d4;
      border-right: 1px solid #a68a00;
      border-bottom: 1px solid #a68a00;
      box-shadow: 0 5px 15px rgba(0,0,0,0.4), inset 0 1px 1px rgba(255,255,255,0.4);
    }

    .btn--primary:hover {
      background: linear-gradient(180deg, #ffdf33, #e0ac10);
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.5), inset 0 1px 1px rgba(255,255,255,0.5);
    }

    .btn--primary:active {
      background: linear-gradient(0deg, var(--accent), var(--accent-2));
      transform: translateY(1px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.4), inset 0 3px 5px rgba(0,0,0,0.2);
      transition: all 0.05s ease-out;
    }

    .btn--primary:focus {
      outline: none;
      box-shadow: var(--focus);
    }


    /* =========================
       Tournaments Section
       ========================= */
    .tournaments-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin-top: 2rem;
    }

    .tournament-card {
      background: linear-gradient(145deg, var(--panel-bg-top), var(--panel-bg-bottom));
      border-radius: var(--radius);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.6), inset 0 1px 1px rgba(255, 255, 255, 0.1);
      border-top: 1px solid #555;
      border-left: 1px solid #555;
      border-right: 1px solid #111;
      border-bottom: 1px solid #111;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      text-decoration: none;
      color: var(--copy);
      transition: all 0.3s var(--ease-out-quart);
    }

    .tournament-card:hover {
      transform: translateY(-6px) scale(1.03);
      box-shadow: 0 14px 28px rgba(0, 0, 0, 0.7), inset 0 1px 1px rgba(255, 255, 255, 0.15);
    }

    .tournament-card__poster {
      height: 180px;
      overflow: hidden;
      position: relative;
    }

    .tournament-card__poster img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.4s var(--ease-out-quart);
    }
    
    .tournament-card:hover .tournament-card__poster img {
      transform: scale(1.05);
    }
    
    .tournament-card__status {
      position: absolute;
      top: 1rem;
      left: 1rem;
      padding: 0.3rem 0.8rem;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(5px);
      color: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    .status-badge--live { background: #ff3b30; }
    .status-badge--registration_open { background: #34c759; }
    .status-badge--upcoming { background: #007aff; }
    .status-badge--completed { background: #8e8e93; }
    .status-badge--registration_closed { background: #ff9500; }

    .tournament-card__info {
      padding: 1.25rem;
      display: flex;
      flex-direction: column;
      flex-grow: 1;
    }

    .tournament-card__title {
      font-size: 1.2rem;
      font-weight: 700;
      margin: 0 0 0.5rem 0;
      line-height: 1.3;
      text-shadow: 1px 1px 2px #000;
    }

    .tournament-card__meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
      margin-top: auto;
      padding-top: 1rem;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .tournament-card__prize, .tournament-card__format {
      font-size: 0.9rem;
      color: var(--muted);
    }
    
    .tournament-card__prize span {
      font-weight: 700;
      color: var(--accent);
      display: block;
      font-size: 1.1rem;
    }
    
    .tournament-card__format span {
      font-weight: 700;
      color: var(--copy);
      display: block;
      font-size: 1rem;
      text-transform: capitalize;
    }


    /* =========================
       Matches / Panels Grid
       ========================= */
    main {
      margin-top: 72px;
    }
    
    .section {
      padding: clamp(2rem, 4vw, 4rem) 1rem;
    }

    .highlights-section {
      margin: clamp(4rem, 7vw, 7rem) 0;
      padding: clamp(3rem, 5vw, 5rem) 1rem;
      background: rgba(0,0,0,0.1);
      box-shadow: inset 0 5px 15px rgba(0,0,0,0.3);
    }

    .why-section {
      margin: clamp(4rem, 7vw, 7rem) 0;
      padding: clamp(4rem, 6vw, 6rem) 1rem;
      position: relative;
      background: #222;
      overflow: hidden;
      box-shadow: inset 0 8px 20px rgba(0,0,0,0.5);
    }

    .why-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.05) 0%, transparent 60%),
        radial-gradient(circle at 80% 70%, rgba(255, 215, 0, 0.03) 0%, transparent 60%);
      z-index: -1;
    }

    .why-section .container {
      position: relative;
      z-index: 1;
    }

    .why-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .why-title {
      font-size: clamp(2.5rem, 4vw, 3.5rem);
      font-weight: 800;
      color: var(--copy);
      margin-bottom: 1rem;
      text-shadow: 2px 2px 3px rgba(0,0,0,0.8);
    }

    .why-title .accent {
      color: var(--accent);
    }

    .why-subtitle {
      font-size: 1.2rem;
      color: var(--muted);
      font-weight: 500;
      max-width: 600px;
      margin: 0 auto;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
    }

    .cta-section {
      margin: clamp(3rem, 6vw, 6rem) 0;
      padding: clamp(3rem, 6vw, 6rem) 1rem;
      background: transparent;
    }

    .panels {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 1.25rem;
      align-items: start;
    }

    /* Skeuomorphic Panel */
    .panel {
      background: linear-gradient(145deg, var(--panel-bg-top), var(--panel-bg-bottom));
      padding: 1.25rem;
      border-radius: var(--radius);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.6), inset 0 1px 1px rgba(255, 255, 255, 0.1);
      color: var(--copy);
      transition: all 0.3s var(--ease-out-quart);
      border-top: 1px solid #555;
      border-left: 1px solid #555;
      border-right: 1px solid #111;
      border-bottom: 1px solid #111;
    }

    .panel:hover {
      transform: translateY(-4px) scale(1.01);
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.7), inset 0 1px 1px rgba(255, 255, 255, 0.15);
      border-top-color: #666;
      border-left-color: #666;
    }

    .panel--large {
      grid-column: span 6;
    }

    .panel--small {
      grid-column: span 3;
      min-width: 240px;
    }

    .panel h3 {
      margin: 0 0 .6rem 0;
      color: var(--accent);
      font-size: 1.05rem;
      text-shadow: 0 0 5px var(--accent);
    }

    .tournament-list li {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      padding: .5rem 0;
      border-bottom: 1px solid rgba(0,0,0, 0.2);
      box-shadow: inset 0 -1px 0 rgba(255,255,255,0.05);
    }

    .tournament-list li:last-child {
      border-bottom: none;
      box-shadow: none;
    }

    .tournament-list h4 {
      margin: 0;
      font-size: 1rem;
      font-weight: 700;
      color: var(--copy);
      text-shadow: 1px 1px 1px #000;
    }

    .tournament-list p {
      margin: 0;
      color: var(--muted);
      font-size: .88rem;
    }

    .live-badge {
      display: inline-block;
      background: #ff2f2f;
      color: white;
      padding: .25rem .6rem;
      border-radius: 6px;
      font-weight: 800;
      font-size: .78rem;
      box-shadow: 0 4px 10px rgba(255, 47, 47, 0.2), inset 0 1px 0 rgba(255,255,255,0.3);
      text-shadow: 1px 1px 1px #800;
    }

    /* =========================
       Highlights Section
       ========================= */
    .highlights-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-top: 1rem;
    }

    .video-clip {
      position: relative;
      padding-top: 56.25%;
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5), inset 0 3px 5px rgba(0,0,0,0.4);
      transition: all 0.4s var(--ease-out-back);
      border: 1px solid #111;
      border-top-color: #444;
    }

    .video-clip:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6), inset 0 3px 5px rgba(0,0,0,0.4);
      border-color: rgba(255, 215, 0, 0.3);
    }

    .video-clip iframe {
      transition: all 0.3s var(--ease-out-quart);
    }

    .video-clip:hover iframe {
      transform: scale(1.05);
    }

    .video-clip iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    /* =========================
       Why choose us / CTA / Footer
       ========================= */
    .why-grid {
      display: grid;
      gap: 2rem;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      align-items: stretch;
      margin-top: 2rem;
      max-width: 1200px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Skeuomorphic Why Item */
    .why-item {
      padding: 2.5rem 2rem;
      background: linear-gradient(145deg, #2a2a2a, #202020);
      border-radius: 16px;
      text-align: center;
      position: relative;
      box-shadow: inset 0 5px 15px rgba(0,0,0,0.5), 0 1px 1px rgba(255,255,255,0.05);
      border: 1px solid #1a1a1a;
    }
    
    .why-item .fa {
      font-size: 3rem;
      color: var(--accent);
      display: block;
      margin-bottom: 1.5rem;
      text-shadow: 0 0 10px var(--accent), 1px 1px 2px #000;
    }

    .why-item h3 {
      color: var(--copy);
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 1rem;
      text-shadow: 1px 1px 1px #000;
    }

    .why-item p {
      color: var(--muted);
      line-height: 1.6;
      font-size: 0.95rem;
    }

    .cta-hero {
      display: flex;
      gap: 1rem;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 1rem;
    }

    footer.site-footer {
      padding: 2.5rem 1rem;
      background: #202020;
      color: var(--muted);
      margin-top: 2rem;
      border-top: 1px solid #111;
      box-shadow: inset 0 10px 20px rgba(0,0,0,0.5);
    }

    .footer-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      max-width: var(--container);
      margin: 0 auto;
    }

    .footer-column h4 {
      color: var(--copy);
      font-weight: 700;
      margin-bottom: .6rem;
      text-shadow: 1px 1px 1px #000;
    }

    .footer-column ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .footer-column ul a {
      color: var(--muted);
      text-decoration: none;
    }

    .footer-bottom {
      text-align: center;
      margin-top: 1.25rem;
      font-size: .9rem;
      color: rgba(255, 255, 255, 0.45);
    }

    .footer-brand {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    /* =========================
       Responsive
       ========================= */
    @media (max-width:1100px) {
      .panels {
        grid-template-columns: repeat(6, 1fr);
      }

      .panel--large {
        grid-column: span 6;
      }

      .panel--small {
        grid-column: span 6;
      }
    }

    @media (max-width:820px) {
      .nav-links {
        display: none;
      }

      .nav-actions {
        display: none;
      }

      .hamburger {
        display: inline-flex;
      }

      .mobile-nav.is-open {
        display: block;
      }

      .panels {
        grid-template-columns: repeat(6, 1fr);
      }

      .panel--large {
        grid-column: span 6;
      }

      .panel--small {
        grid-column: span 6;
      }

      .footer-grid {
        grid-template-columns: 1fr;
        text-align: center;
      }
    }

    @media (max-width:480px) {
      .hero {
        padding-top: 5rem;
        padding-bottom: 2rem;
      }

      .hero__content {
        padding: 2rem 1.5rem;
        max-width: 100%;
        gap: 1rem;
      }

      .hero__content .tournament-name {
        font-size: clamp(2rem, 8vw, 2.8rem);
      }

      .hero__content .prize-pool {
        font-size: 1.2rem;
      }

      .hero__content p {
        font-size: 1rem;
        max-width: 100%;
      }

      .btn--primary {
        padding: 0.8rem 1.5rem;
        font-size: 1rem;
        min-width: 160px;
      }

      .brand {
        font-size: 1rem;
      }

      .why-section {
        margin: clamp(2rem, 4vw, 3rem) 0;
        padding: clamp(2rem, 4vw, 3rem) 1rem;
        border-radius: 16px;
      }

      .why-grid {
        gap: 1.5rem;
        grid-template-columns: 1fr;
      }

      .why-item {
        padding: 2rem 1.5rem;
      }

      .why-header {
        margin-bottom: 2rem;
      }

      .why-title {
        font-size: clamp(2rem, 6vw, 2.5rem);
      }

      .why-subtitle {
        font-size: 1rem;
      }
    }

    .panel-wrapper {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }

    .main-panel {
      grid-column: span 6;
    }

    .right-column {
      grid-column: span 6;
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }
  </style>
</head>

<body>
  <a class="skip-link" href="#main">Skip to content</a>

  <header class="site-header" role="banner">
    <a href="index.html" class="brand" aria-hidden="false">
      <span><span class="accent">E</span>Arena</span>
    </a>

    <nav class="primary" role="navigation" aria-label="Primary">
      <div class="nav-links" role="menubar" aria-hidden="false">
        <div class="nav-item">
          <a href="#" role="menuitem">
            Tournaments
            <span class="dropdown-arrow">▼</span>
          </a>
          <div class="dropdown-menu">
            <a href="tournaments.html">Browse All</a>
            <a href="tournaments.html?filter=live">Live Matches</a>
            <a href="tournaments.html?filter=upcoming">Upcoming Events</a>
            <a href="tournaments.html?filter=completed">Past Results</a>
            <a href="#">Leaderboards</a>
          </div>
        </div>
        <div class="nav-item" id="host-nav-item" style="display: none;">
          <a href="#" role="menuitem">
            Host
            <span class="dropdown-arrow">▼</span>
          </a>
          <div class="dropdown-menu">
            <a href="admin-dashboard.html">Admin Dashboard</a>
            <a href="#">Create Tournament</a>
            <a href="#">Manage Events</a>
            <a href="#">Analytics Dashboard</a>
            <a href="#">Prize Management</a>
          </div>
        </div>
        <a href="#games" role="menuitem">Games</a>
        <a href="#community" role="menuitem">Community</a>
        <a href="#support" role="menuitem">Support</a>
        <a href="#pricing" role="menuitem">Pricing</a>
      </div>

      <div class="nav-actions">
        <!-- Not logged in -->
        <div id="auth-buttons">
          <a href="auth.html?tab=login&returnUrl=index.html" class="login-link">Log in</a>
          <button class="header-cta" aria-label="Sign up" id="sign-up-desktop"
            onclick="redirectToAuth()">Sign up</button>
        </div>
        
        <!-- Logged in -->
        <div id="user-menu" style="display: none;">
          <div class="profile-dropdown">
            <div class="profile-icon" id="profile-icon">
              <i class="fas fa-user-circle"></i>
            </div>
            <div class="profile-modal" id="profile-modal">
              <div class="profile-header">
                <div class="profile-photo">
                  <i class="fas fa-user"></i>
                </div>
                <div class="profile-info">
                  <div class="profile-username" id="modal-username">User</div>
                  <div class="profile-role" id="modal-role-badge" style="display: none;">Admin</div>
                </div>
              </div>
              <div class="profile-actions">
                <a href="user-dashboard.html" class="profile-action" id="modal-dashboard-link">
                  <i class="fas fa-user"></i>
                  <span>My Account</span>
                </a>
                <button class="profile-action logout-action" onclick="logout()">
                  <i class="fas fa-sign-out-alt"></i>
                  <span>Logout</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <button class="hamburger" aria-label="Toggle menu" aria-expanded="false" aria-controls="mobile-nav">
        <span class="bars" aria-hidden="true"></span>
      </button>
    </nav>
  </header>

  <!-- Mobile nav (toggle) -->
  <div id="mobile-nav" class="mobile-nav" hidden>
    <nav aria-label="Mobile primary">
      <div class="mobile-nav-section">
        <div class="mobile-nav-title">
          Tournaments
          <span class="mobile-arrow">▲</span>
        </div>
        <div class="mobile-nav-items">
          <a href="tournaments.html" class="mobile-link">Browse All</a>
          <a href="tournaments.html?filter=live" class="mobile-link">Live Matches</a>
          <a href="tournaments.html?filter=upcoming" class="mobile-link">Upcoming Events</a>
          <a href="tournaments.html?filter=completed" class="mobile-link">Past Results</a>
          <a href="#" class="mobile-link">Leaderboards</a>
        </div>
      </div>

      <div class="mobile-nav-section" id="mobile-host-section" style="display: none;">
        <div class="mobile-nav-title">
          Host
          <span class="mobile-arrow">▼</span>
        </div>
        <div class="mobile-nav-items">
          <a href="admin-dashboard.html" class="mobile-link">Admin Dashboard</a>
          <a href="#" class="mobile-link">Create Tournament</a>
          <a href="#" class="mobile-link">Manage Events</a>
          <a href="#" class="mobile-link">Analytics Dashboard</a>
          <a href="#" class="mobile-link">Prize Management</a>
        </div>
      </div>

      <a href="#games" class="mobile-link">Games</a>
      <a href="#community" class="mobile-link">Community</a>
      <a href="#support" class="mobile-link">Support</a>
      <a href="#pricing" class="mobile-link">Pricing</a>
    </nav>

    <!-- Mobile Authentication Actions -->
    <div class="mobile-nav-actions">
      <!-- Not logged in -->
      <div id="mobile-auth-buttons">
        <a href="auth.html?tab=login&returnUrl=index.html" class="mobile-login-btn">
          <i class="fas fa-sign-in-alt"></i>
          Log In
        </a>
        <button class="mobile-signup-btn" onclick="redirectToAuth()">
          <i class="fas fa-user-plus"></i>
          Sign Up
        </button>
      </div>
      
      <!-- Logged in -->
      <div id="mobile-user-menu" style="display: none;">
        <a href="user-dashboard.html" class="mobile-link" id="mobile-dashboard-link" style="padding: 1rem; border-bottom: 1px solid rgba(255, 255, 255, 0.1); color: var(--copy); text-decoration: none; font-weight: 600;">
          <i class="fas fa-user"></i> My Account
        </a>
        <div class="mobile-user-info">
          <div class="mobile-user-avatar">
            <i class="fas fa-user"></i>
          </div>
          <div class="mobile-user-details">
            <span class="mobile-username" id="mobile-user-username">User</span>
            <span class="mobile-user-role" id="mobile-user-role-badge" style="display: none;">Admin</span>
          </div>
        </div>
        <button class="mobile-logout-btn" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i>
          Logout
        </button>
      </div>
    </div>
  </div>

  <main id="main">
    <!-- HERO -->
    <section class="hero" aria-labelledby="hero-title">
      <div class="hero__bg-slider">
        <img src="https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=2070&auto=format&fit=crop" alt="Esports event with crowd" class="active" />
        <img src="https://images.unsplash.com/photo-1585624838339-35939229208b?q=80&w=2070&auto=format&fit=crop" alt="Gamer with professional setup" />
        <img src="https://images.unsplash.com/photo-1609815788836-8339b601dfa3?q=80&w=1974&auto=format&fit=crop" alt="Esports arena stage" />
      </div>

      <div class="hero__overlay"></div>

      <div class="hero__content" role="region" aria-label="Hero">
        <!-- Logo was here previously but is now commented out. The JavaScript has been updated to no longer reference this element. -->
        <h1 id="hero-title" class="tournament-name">PUBG Global Series 2025</h1>
        <div class="prize-pool" id="prize-pool">Prize Pool: $500,000</div>
        <p id="tournament-description">
          The biggest PUBG tournament of the year is here! Join us as the best teams from around the world battle it out
          in London for the title of Global Champions.
        </p>

        <a class="btn--primary" href="tournament-details.html?slug=test-tournament"
          id="cta-learn-more">Tournament Details</a>
      </div>
    </section>

    <!-- Tournaments -->
    <section id="tournaments" class="section container" aria-labelledby="tournaments-heading">
      <h2 id="tournaments-heading" style="font-size:1.6rem; margin-bottom:1rem; color:var(--copy); text-shadow: 1px 1px 2px #000;">
        Tournaments
      </h2>
      <div id="tournaments-grid" class="tournaments-grid">
        <!-- Tournament cards will be injected here by JavaScript -->
      </div>
    </section>

    <!-- Why Choose Us -->
    <section class="section why-section" aria-labelledby="why-heading">
      <div class="container">
        <div class="why-header">
          <h2 id="why-heading" class="why-title">Why choose <span class="accent">E</span>Arena?</h2>
          <p class="why-subtitle">Join the ultimate esports platform designed for champions</p>
        </div>
        <div class="why-grid" role="list">
          <div class="why-item" role="listitem">
            <i class="fa-solid fa-users" aria-hidden="true"></i>
            <h3 style="margin:.6rem 0 .25rem 0; color:var(--copy)">Thriving community</h3>
            <p style="color:var(--muted)">Join thousands of passionate players. Team up, scrim, and find matches fast.
            </p>
          </div>

          <div class="why-item" role="listitem">
            <i class="fa-solid fa-trophy" aria-hidden="true"></i>
            <h3 style="margin:.6rem 0 .25rem 0; color:var(--copy)">Epic prizes</h3>
            <p style="color:var(--muted)">Free tournaments with cash prizes and exclusive gear.</p>
          </div>

          <div class="why-item" role="listitem">
            <i class="fa-solid fa-hand-holding-dollar" aria-hidden="true"></i>
            <h3 style="margin:.6rem 0 .25rem 0; color:var(--copy)">Free to play</h3>
            <p style="color:var(--muted)">Your skill matters — no entry fees for most events.</p>
          </div>

          <div class="why-item" role="listitem">
            <i class="fa-solid fa-shield-alt" aria-hidden="true"></i>
            <h3 style="margin:.6rem 0 .25rem 0; color:var(--copy)">Fair play</h3>
            <p style="color:var(--muted)">Advanced anti-cheat systems and transparent rules.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA -->
    <section class="section cta-section" aria-labelledby="cta-heading">
      <div class="container" style="text-align:center;">
        <h2 id="cta-heading" style="margin-bottom:1rem; color:var(--copy); text-shadow: 1px 1px 2px #000;">Stop scrolling, start playing</h2>
        <p style="color:var(--muted); margin-bottom:2rem;">Create your account now and earn 2,000 coins.</p>
        <div class="cta-hero">
          <a class="btn--primary" href="#" aria-label="Join now and claim bonus">Join Now</a>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-column footer-brand">
          <h4><a href="index.html" style="color: var(--copy); text-decoration: none;"><span
                style="color:var(--accent)">E</span>Arena</a></h4>
          <p>The ultimate destination for competitive gaming.</p>
        </div>
        <div class="footer-column">
          <h4>Tournaments</h4>
          <ul>
            <li><a href="tournaments.html">Browse All</a></li>
            <li><a href="tournaments.html?filter=live">Live Matches</a></li>
            <li><a href="tournaments.html?filter=upcoming">Upcoming</a></li>
            <li><a href="tournaments.html?filter=completed">Past Results</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h4>Community</h4>
          <ul>
            <li><a href="#">Discord</a></li>
            <li><a href="#">Forums</a></li>
            <li><a href="#">Support</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h4>Company</h4>
          <ul>
            <li><a href="#">About</a></li>
            <li><a href="auth.html?tab=login&returnUrl=index.html">Sign In</a></li>
            <li><a href="#">Contact</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 EArena. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    // Helper function to redirect to auth with return URL
    function redirectToAuth(tab = 'register') {
      const currentUrl = window.location.href;
      const returnUrl = encodeURIComponent(currentUrl);
      window.location.href = `auth.html?tab=${tab}&returnUrl=${returnUrl}`;
    }

    // Enhanced smooth interactions and animations

    // Header scroll effect
    let lastScrollY = window.scrollY;
    const header = document.querySelector('.site-header');

    window.addEventListener('scroll', () => {
      const currentScrollY = window.scrollY;

      if (currentScrollY > 100) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }

      lastScrollY = currentScrollY;
    });

    // Hero background slider with smooth transitions
    const heroImages = document.querySelectorAll('.hero__bg-slider img');
    const heroContent = document.querySelector('.hero__content');
    let currentImageIndex = 0;

    // API Configuration
    // Auto-detect API URL based on environment
    const isLocal = window.location.hostname === 'localhost' || 
                   window.location.hostname === '127.0.0.1' || 
                   window.location.protocol === 'file:';
    
    const API_BASE_URL = isLocal ? 'http://localhost:8000' : 'https://t2-237c.onrender.com';

    // Hero content data - will be populated from API
    let heroData = [];
    let isDataLoaded = false;

    // API Functions
    async function fetchTournaments(retryCount = 0) {
      const maxRetries = 3;

      try {
        showLoadingState();

        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 10000); // 10s

        const response = await fetch(`${API_BASE_URL}/api/tournaments`, {
          signal: controller.signal,
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          }
        });

        clearTimeout(timeoutId);

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const body = await response.json();
        const tournaments = Array.isArray(body) ? body : (body.data || []);

        if (!Array.isArray(tournaments)) {
          throw new Error('Invalid data format received from API');
        }

        console.log('Fetched tournaments (normalized):', tournaments);

        // Transform data for hero
        heroData = tournaments.slice(0, 3).map(t => {
          const rawPoster = t.posterImage || t.backgroundImage || t.poster || t.image || null;
          let finalPoster = rawPoster;
          if (rawPoster && !rawPoster.startsWith('http')) {
            finalPoster = `${API_BASE_URL}/${rawPoster.replace(/^\//, '')}`;
          }
          return {
            id: t._id || t.id,
            slug: t.slug,
            title: t.title || t.name || 'Untitled Tournament',
            prizePool: `Prize Pool: $${(t.prizePool || 0).toLocaleString()}`,
            description: t.description || 'Join this exciting tournament!',
            detailsLink: `tournament-details.html?slug=${t.slug || t._id || t.id}`,
            poster: finalPoster,
            status: calculateTournamentStatus(t),
            game: t.game || 'Gaming'
          };
        });

        isDataLoaded = true;
        hideLoadingState();

        if (heroData.length > 0) {
          updateHeroContent(0);
          startHeroSlider();
        }

        return tournaments;
      } catch (error) {
        console.error(`Error fetching tournaments (attempt ${retryCount + 1}):`, error);

        if (retryCount < maxRetries && error.name !== 'AbortError') {
          await new Promise(res => setTimeout(res, (retryCount + 1) * 2000));
          return fetchTournaments(retryCount + 1);
        }

        hideLoadingState();
        showErrorState();

        // fallback demo content
        heroData = [{
          title: "EArena Championships",
          prizePool: "Prize Pool: $100,000",
          description: "Experience the ultimate gaming competition. Connect to see live tournaments and join the action!",
          detailsLink: "tournaments.html"
        }];

        if (heroData.length > 0) {
          updateHeroContent(0);
        }

        return [];
      }
    }

    // Loading and Error States
    function showLoadingState() {
      const heroTitle = document.getElementById('hero-title');
      const prizePool = document.getElementById('prize-pool');
      const description = document.getElementById('tournament-description');

      if (heroTitle) heroTitle.textContent = 'Loading Tournaments...';
      if (prizePool) prizePool.textContent = 'Fetching latest data...';
      if (description) description.textContent = 'Please wait while we load the most exciting tournaments for you.';

      // Add loading animation to CTA button
      const ctaButton = document.getElementById('cta-learn-more');
      if (ctaButton) {
        ctaButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
        ctaButton.style.pointerEvents = 'none';
      }

      // Show loading states for other sections
      showSectionLoadingStates();
    }

    function showSectionLoadingStates() {
      // Recent matches loading
      const recentMatchesList = document.querySelector('#recent-matches-title')?.parentElement?.querySelector('.tournament-list');
      if (recentMatchesList) {
        recentMatchesList.innerHTML = `
          <li style="opacity: 0.6;">
            <div>
              <h4><i class="fas fa-spinner fa-spin"></i> Loading recent matches...</h4>
              <p>Fetching latest match data</p>
            </div>
          </li>
        `;
      }

      // Upcoming tournaments loading
      const upcomingList = document.querySelector('#upcoming-title')?.parentElement?.querySelector('.tournament-list');
      if (upcomingList) {
        upcomingList.innerHTML = `
          <li style="opacity: 0.6;">
            <div>
              <h4><i class="fas fa-spinner fa-spin"></i> Loading upcoming tournaments...</h4>
              <p>Fetching schedule data</p>
            </div>
          </li>
        `;
      }

      // Live matches loading
      const liveList = document.querySelector('#live-title')?.parentElement?.querySelector('.tournament-list');
      if (liveList) {
        liveList.innerHTML = `
          <li style="opacity: 0.6;">
            <div>
              <h4><i class="fas fa-spinner fa-spin"></i> Loading live matches...</h4>
              <p>Checking for live tournaments</p>
            </div>
          </li>
        `;
      }
    }

    function hideLoadingState() {
      const ctaButton = document.getElementById('cta-learn-more');
      if (ctaButton) {
        ctaButton.innerHTML = 'Tournament Details';
        ctaButton.style.pointerEvents = 'auto';
      }
    }

    function showErrorState() {
      const heroTitle = document.getElementById('hero-title');
      const prizePool = document.getElementById('prize-pool');
      const description = document.getElementById('tournament-description');

      if (heroTitle) heroTitle.textContent = 'Connection Error';
      if (prizePool) prizePool.textContent = 'Unable to load tournaments';
      if (description) description.textContent = 'We\'re having trouble connecting to our servers. Please refresh the page or try again later.';

      const ctaButton = document.getElementById('cta-learn-more');
      if (ctaButton) {
        ctaButton.innerHTML = '<i class="fas fa-refresh"></i> Retry';
        ctaButton.onclick = async (e) => {
          e.preventDefault();
          ctaButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Retrying...';
          ctaButton.style.pointerEvents = 'none';

          try {
            await populateAllSections();
          } catch (error) {
            console.error('Retry failed:', error);
            setTimeout(() => {
              ctaButton.innerHTML = '<i class="fas fa-refresh"></i> Retry';
              ctaButton.style.pointerEvents = 'auto';
            }, 2000);
          }
        };
      }

      // Show error notification
      console.error('Unable to load tournament data. Please check your connection.');
    }

    function updateHeroContent(index) {
      if (!heroData || heroData.length === 0) return;

      const data = heroData[index];
      if (!data) return;

      // Fade out content
      heroContent.classList.remove('active');

      setTimeout(() => {
        // Update content
        const heroTitle = document.getElementById('hero-title');
        const prizePool = document.getElementById('prize-pool');
        const description = document.getElementById('tournament-description');
        const detailsButton = document.getElementById('cta-learn-more');

        if (heroTitle) heroTitle.textContent = data.title;
        if (prizePool) prizePool.textContent = data.prizePool;
        if (description) description.textContent = data.description;

        // Update button link
        if (detailsButton && data.detailsLink) {
          detailsButton.href = data.detailsLink;
          detailsButton.onclick = null; // Remove any error retry handlers
        }

        // Update background image if available
        if (data.poster) {
          updateHeroBackground(data.poster, index);
        }

        // Fade in content
        heroContent.classList.add('active');
      }, 300);
    }

    function updateHeroBackground(posterUrl, index) {
      const heroImages = document.querySelectorAll('.hero__bg-slider img');
      if (heroImages[index]) {
        // Create a new image to test if the URL is valid
        const img = new Image();
        img.onload = () => {
          heroImages[index].src = posterUrl;
        };
        img.onerror = () => {
          console.warn(`Failed to load poster image: ${posterUrl}`);
          // Keep the default image
        };
        img.src = posterUrl;
      }
    }

    function nextHeroSlide() {
      if (!isDataLoaded || heroData.length === 0) return;

      const heroImages = document.querySelectorAll('.hero__bg-slider img');
      if (heroImages.length === 0) return;

      heroImages[currentImageIndex].classList.remove('active');
      currentImageIndex = (currentImageIndex + 1) % Math.min(heroData.length, heroImages.length);
      heroImages[currentImageIndex].classList.add('active');
      updateHeroContent(currentImageIndex);
    }

    function startHeroSlider() {
      if (heroData.length > 1) {
        setInterval(nextHeroSlide, 6000);
      }
    }

    // Initialize hero
    heroContent.classList.add('active');

    // Additional API Functions
    async function fetchRecentMatches() {
      console.warn("Using placeholder for fetchRecentMatches");
      return null;
    }
    
    async function fetchLiveMatches() {
      console.warn("Using placeholder for fetchLiveMatches");
      return null;
    }
    
    async function fetchUpcomingMatches() {
      console.warn("Using placeholder for fetchUpcomingMatches");
      return null;
    }
    
    async function fetchSponsoredContent() {
      console.warn("Using placeholder for fetchSponsoredContent");
      return null;
    }

    async function fetchTournamentStats() {
        console.warn("Using placeholder for fetchTournamentStats");
        return null;
    }

    async function fetchFeaturedTournaments() {
      try {
        const response = await fetch(`${API_BASE_URL}/api/tournaments/featured`, {
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          }
        });
        if (response.ok) {
          const body = await response.json();
          return Array.isArray(body) ? body : (body.data || []);
        }
      } catch (error) {
        console.warn('Featured tournaments endpoint not available:', error);
      }
      return null;
    }

    // Main Content Population Function
    async function populateAllSections() {
      try {
        console.log('Fetching all content data...');

        const [
          tournamentsResponse,
          recentMatches,
          liveMatches,
          upcomingMatches,
          sponsoredContent,
          featured,
          stats
        ] = await Promise.allSettled([
          fetch(`${API_BASE_URL}/api/tournaments`),
          fetchRecentMatches(),
          fetchLiveMatches(),
          fetchUpcomingMatches(),
          fetchSponsoredContent(),
          fetchFeaturedTournaments(),
          fetchTournamentStats()
        ]);

        let tournaments = [];
        if (tournamentsResponse.status === 'fulfilled' && tournamentsResponse.value.ok) {
            const body = await tournamentsResponse.value.json();
            tournaments = body.data || [];
        }


        if (tournaments.length > 0) {
          populateTournamentsGrid(tournaments);
        }

        // The following functions are now deprecated in favor of the new grid
        /* if (recentMatches.status === 'fulfilled' && recentMatches.value) {
          populateRecentMatches(recentMatches.value);
        }

        if (liveMatches.status === 'fulfilled' && liveMatches.value) {
          updateLiveMatches(liveMatches.value);
        }

        if (upcomingMatches.status === 'fulfilled' && upcomingMatches.value) {
          updateUpcomingMatches(upcomingMatches.value);
        }
        */

        if (sponsoredContent.status === 'fulfilled' && sponsoredContent.value) {
          // You might want to keep sponsored content or integrate it differently
          // populateSponsoredContent(sponsoredContent.value);
        }

        console.log('All content sections populated successfully');
      } catch (error) {
        console.error('Error populating content sections:', error);
      }
    }

    // Tournament status calculation function
    function calculateTournamentStatus(tournament) {
      const now = new Date();
      
      const regStart = new Date(tournament.registrationStart);
      const regEnd = new Date(tournament.registrationEnd);
      const tournStart = new Date(tournament.tournamentStart);
      const tournEnd = new Date(tournament.tournamentEnd);
      
      if (now < regStart) {
        return 'upcoming';
      } else if (now >= regStart && now <= regEnd) {
        return 'registration_open';
      } else if (now > regEnd && now < tournStart) {
        return 'registration_closed';
      } else if (now >= tournStart && now <= tournEnd) {
        return 'live';
      } else {
        return 'completed';
      }
    }
    
    function getStatusDisplayInfo(status) {
        const map = {
            'upcoming': { text: 'Upcoming', class: 'upcoming' },
            'registration_open': { text: 'Registering', class: 'registration_open' },
            'registration_closed': { text: 'Registration Closed', class: 'registration_closed' },
            'live': { text: 'Live Now', class: 'live' },
            'completed': { text: 'Completed', class: 'completed' }
        };
        return map[status] || { text: status.replace(/_/g, ' '), class: 'default' };
    }

    function populateTournamentsGrid(tournaments) {
        const grid = document.getElementById('tournaments-grid');
        if (!grid) return;

        if (tournaments.length === 0) {
            grid.innerHTML = '<p>No tournaments available at the moment. Check back soon!</p>';
            return;
        }

        grid.innerHTML = tournaments.slice(0, 6).map(tournament => { // Displaying up to 6 tournaments
            const status = calculateTournamentStatus(tournament);
            const statusInfo = getStatusDisplayInfo(status);
            
            const rawPoster = tournament.posterImage || tournament.backgroundImage || null;
            let finalPoster = 'https://images.unsplash.com/photo-1511556532299-8f662fc26c06?q=80&w=2070&auto=format&fit=crop'; // Default fallback
            if (rawPoster && !rawPoster.startsWith('http')) {
                finalPoster = `${API_BASE_URL}/${rawPoster.replace(/^\//, '')}`;
            } else if (rawPoster) {
                finalPoster = rawPoster;
            }

            return `
                <a href="tournament-details.html?slug=${tournament.slug}" class="tournament-card">
                    <div class="tournament-card__poster">
                        <img src="${finalPoster}" alt="${tournament.title} Poster" onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1511556532299-8f662fc26c06?q=80&w=2070&auto=format&fit=crop';">
                        <div class="tournament-card__status status-badge--${statusInfo.class}">
                            ${statusInfo.text}
                        </div>
                    </div>
                    <div class="tournament-card__info">
                        <h3 class="tournament-card__title">${tournament.title}</h3>
                        <div class="tournament-card__meta">
                            <div class="tournament-card__prize">
                                Prize Pool
                                <span>$${(tournament.prizePool || 0).toLocaleString()}</span>
                            </div>
                            <div class="tournament-card__format">
                                Format
                                <span>${tournament.format || 'TBA'}</span>
                            </div>
                        </div>
                    </div>
                </a>
            `;
        }).join('');
    }


    function updateStatsDisplay(stats) {
      if (stats.totalTournaments) {
        const statsElements = document.querySelectorAll('[data-stat="tournaments"]');
        statsElements.forEach(el => el.textContent = stats.totalTournaments);
      }
      if (stats.totalPrizePool) {
        const prizeElements = document.querySelectorAll('[data-stat="prize-pool"]');
        prizeElements.forEach(el => el.textContent = stats.totalPrizePool);
      }
      if (stats.activePlayers) {
        const playerElements = document.querySelectorAll('[data-stat="players"]');
        playerElements.forEach(el => el.textContent = stats.activePlayers);
      }
    }

    // Recent Matches Population
    function populateRecentMatches(matches) {
      const recentMatchesList = document.querySelector('#recent-matches-title').parentElement.querySelector('.tournament-list');
      if (recentMatchesList && matches && matches.length > 0) {
        recentMatchesList.innerHTML = matches.slice(0, 5).map(match => {
          const matchDate = match.date ? new Date(match.date) : new Date();
          const formattedDate = matchDate.toLocaleDateString('en-US', { day: 'numeric', month: 'short', year: 'numeric' });
          const shortDate = matchDate.toLocaleDateString('en-US', { day: '2-digit', month: '2-digit', year: 'numeric' });
          let statusDisplay = '';
          if (match.status === 'live') {
            statusDisplay = `<div style="margin-top:0.4rem; font-weight:700; color:var(--accent);">Live</div>`;
          } else if (match.result) {
            statusDisplay = `<div style="margin-top:0.4rem; font-weight:700; color:var(--muted);">Result: ${match.result}</div>`;
          } else if (match.winner) {
            statusDisplay = `<div style="margin-top:0.4rem; font-weight:700; color:var(--muted);">Winner: ${match.winner}</div>`;
          }
          return `
            <li>
              <div>
                <h4>${match.title || match.name || 'Tournament Match'}</h4>
                <p>${match.tournament || match.series || 'Tournament Series'} — ${match.game || 'Gaming'}</p>
              </div>
              <div style="text-align:right">
                <div style="font-weight:700; color:var(--muted)">${formattedDate}</div>
                <div style="font-size:.82rem; color:var(--muted)">${shortDate}</div>
                ${statusDisplay}
              </div>
            </li>`;
        }).join('');
      }
    }

    // Update Live Matches in the Live Section
    function updateLiveMatches(liveMatches) {
      const liveList = document.querySelector('#live-title').parentElement.querySelector('.tournament-list');
      if (liveList && liveMatches && liveMatches.length > 0) {
        liveList.innerHTML = liveMatches.slice(0, 3).map(match => `
          <li>
            <div>
              <h4>${match.team1 || 'Team A'} <span style="font-weight:600; color:var(--muted); margin:0 .5rem">VS</span> ${match.team2 || 'Team B'}</h4>
              <p>${match.tournament || match.title || 'Live Tournament'}</p>
            </div>
            <div style="text-align:right">
              <span class="live-badge" aria-hidden="true">LIVE</span>
              <div style="margin-top:.4rem">
                <a href="${match.watchLink || `tournament-details.html?slug=${match.tournamentSlug || match.tournamentId || match.id}`}" aria-label="Watch ${match.title}">Watch</a>
              </div>
            </div>
          </li>`).join('');
      }
    }

    // Update Upcoming Matches in the Upcoming Section
    function updateUpcomingMatches(upcomingMatches) {
      const upcomingList = document.querySelector('#upcoming-title').parentElement.querySelector('.tournament-list');
      if (upcomingList && upcomingMatches && upcomingMatches.length > 0) {
        upcomingList.innerHTML = upcomingMatches.slice(0, 3).map(match => {
          const startDate = match.startDate ? new Date(match.startDate) : new Date();
          const formattedDate = startDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
          return `
            <li>
              <div>
                <h4>${match.title || `${match.team1 || 'TBA'} vs ${match.team2 || 'TBA'}`}</h4>
                <p>Starts: ${formattedDate}</p>
              </div>
              <div style="text-align:right;color:var(--muted)">${formattedDate}</div>
            </li>`;
        }).join('');
      }
    }

    // Populate Sponsored Content
    function populateSponsoredContent(sponsoredData) {
      const sponsoredPanel = document.querySelector('#ad-title').parentElement;
      if (sponsoredPanel && sponsoredData) {
        const content = Array.isArray(sponsoredData) ? sponsoredData[0] : sponsoredData;
        const contentDiv = sponsoredPanel.querySelector('div[style*="text-align:center"]');
        if (contentDiv && content) {
          contentDiv.innerHTML = `
            <p style="color:var(--copy); font-size:1.1rem; font-weight:bold; margin-bottom:.5rem;">
              ${content.title || 'Sponsored Content'}
            </p>
            <p style="color:var(--muted); font-size:.9rem; line-height:1.4;">
              ${content.description || content.text || 'Check out our latest offers and promotions.'}
            </p>
            <a href="${content.link || content.url || '#'}" 
               style="display:inline-block; margin-top:1rem; padding:.5rem 1rem; background:var(--accent); color:var(--bg); font-weight:700; border-radius:6px;">
              ${content.buttonText || 'Learn More'}
            </a>`;
        }
      }
    }

    function populateUpcomingTournaments(tournaments) {
      const upcomingTournaments = tournaments
        .filter(t => calculateTournamentStatus(t) === 'upcoming' || calculateTournamentStatus(t) === 'registration_open')
        .slice(0, 3);
      const upcomingList = document.querySelector('#upcoming-title').parentElement.querySelector('.tournament-list');
      if (upcomingList && upcomingTournaments.length > 0) {
        upcomingList.innerHTML = upcomingTournaments.map(tournament => {
          const startDate = tournament.tournamentStart ? new Date(tournament.tournamentStart) : new Date();
          const formattedDate = startDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
          return `
            <li>
              <div>
                <h4><a href="tournament-details.html?slug=${tournament.slug || tournament._id || tournament.id}" style="color: var(--copy); text-decoration: none;">${tournament.title || tournament.name}</a></h4>
                <p>Prize Pool: $${(tournament.prizePool || 0).toLocaleString()}</p>
              </div>
              <div style="text-align:right;color:var(--muted)">${formattedDate}</div>
            </li>`;
        }).join('');
      }
    }

    function populateLiveTournaments(tournaments) {
      const liveTournaments = tournaments
        .filter(t => calculateTournamentStatus(t) === 'live')
        .slice(0, 3);
      const liveList = document.querySelector('#live-title').parentElement.querySelector('.tournament-list');
      if (liveList && liveTournaments.length > 0) {
        liveList.innerHTML = liveTournaments.map(tournament => `
          <li>
            <div>
              <h4>${tournament.title || tournament.name}</h4>
              <p>${tournament.game || 'Tournament'} Championship</p>
            </div>
            <div style="text-align:right">
              <span class="live-badge" aria-hidden="true">LIVE</span>
              <div style="margin-top:.4rem">
                <a href="tournament-details.html?slug=${tournament.slug || tournament._id || tournament.id}" aria-label="View ${tournament.title}">Watch</a>
              </div>
            </div>
          </li>`).join('');
      } else if (liveList) {
        liveList.innerHTML = `
          <li>
            <div>
              <h4>No Live Tournaments</h4>
              <p>Check back soon for live matches!</p>
            </div>
            <div style="text-align:right;color:var(--muted)">
              <a href="tournaments.html">Browse All</a>
            </div>
          </li>`;
      }
    }

    // Mobile menu toggle
    const hamburger = document.querySelector('.hamburger');
    const mobileNav = document.getElementById('mobile-nav');

    function toggleMobileMenu() {
      const isOpen = hamburger.getAttribute('aria-expanded') === 'true';
      hamburger.setAttribute('aria-expanded', !isOpen);
      mobileNav.classList.toggle('is-open');
      mobileNav.hidden = isOpen;
      document.body.style.overflow = isOpen ? '' : 'hidden';
    }

    if (hamburger) {
      hamburger.addEventListener('click', toggleMobileMenu);
    }
    document.addEventListener('click', function (event) {
      if (!mobileNav.contains(event.target) && !hamburger.contains(event.target) && mobileNav.classList.contains('is-open')) {
        toggleMobileMenu();
      }
    });
    document.querySelectorAll('.mobile-nav-title').forEach(title => {
      title.addEventListener('click', function () {
        const items = this.parentElement.querySelector('.mobile-nav-items');
        const arrow = this.querySelector('.mobile-arrow');
        if (items) {
          const isOpen = items.style.display === 'block';
          items.style.display = isOpen ? 'none' : 'block';
          if(arrow) arrow.textContent = isOpen ? '▼' : '▲';
        }
      });
    });

    // Smooth scroll for navigation links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
    });

    // Add ripple effect to buttons
    function createRipple(event) {
      const button = event.currentTarget;
      const circle = document.createElement('span');
      const diameter = Math.max(button.clientWidth, button.clientHeight);
      const radius = diameter / 2;
      circle.style.width = circle.style.height = `${diameter}px`;
      circle.style.left = `${event.clientX - button.offsetLeft - radius}px`;
      circle.style.top = `${event.clientY - button.offsetTop - radius}px`;
      circle.classList.add('ripple');
      const ripple = button.getElementsByClassName('ripple')[0];
      if (ripple) ripple.remove();
      button.appendChild(circle);
    }
    const rippleStyle = document.createElement('style');
    rippleStyle.textContent = `
      .btn--primary, .header-cta { position: relative; overflow: hidden; }
      .ripple { position: absolute; border-radius: 50%; background-color: rgba(255, 255, 255, 0.3); transform: scale(0); animation: ripple-animation 0.6s linear; pointer-events: none; }
      @keyframes ripple-animation { to { transform: scale(4); opacity: 0; } }`;
    document.head.appendChild(rippleStyle);
    document.querySelectorAll('.btn--primary, .header-cta').forEach(button => {
      button.addEventListener('click', createRipple);
    });

    // Connection status monitoring
    window.addEventListener('online', () => {
      console.log('Connection restored! Refreshing all content...');
      populateAllSections().catch(console.error);
    });
    window.addEventListener('offline', () => {
      console.warn('Connection lost. Some features may not work properly.');
    });

    // Authentication and User Management
    function checkUserAuthentication() {
        const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');
        if (!session) {
            clearUserSession();
            return;
        }

        try {
            const sessionData = JSON.parse(session);
            const user = sessionData?.data?.user;
            const token = sessionData?.data?.token;

            if (!user || !token) {
                clearUserSession();
                return;
            }

            const username = user.username || user.email.split('@')[0];
            const isAdmin = user.roles && user.roles.includes('admin');

            // Update UI
            document.getElementById('modal-username').textContent = username;
            document.getElementById('mobile-user-username').textContent = username;

            document.getElementById('auth-buttons').style.display = 'none';
            document.getElementById('user-menu').style.display = 'flex';
            document.getElementById('mobile-auth-buttons').style.display = 'none';
            document.getElementById('mobile-user-menu').style.display = 'flex';

            if (isAdmin) {
                document.getElementById('modal-role-badge').style.display = 'inline-block';
                document.getElementById('host-nav-item').style.display = 'block';
                document.getElementById('mobile-user-role-badge').style.display = 'inline-block';
                document.getElementById('mobile-host-section').style.display = 'block';
            } else {
                clearAdminUI();
            }
        } catch (error) {
            console.error('Invalid session data:', error);
            clearUserSession();
        }
    }
    
    function clearAdminUI() {
        document.getElementById('modal-role-badge').style.display = 'none';
        document.getElementById('host-nav-item').style.display = 'none';
        document.getElementById('mobile-user-role-badge').style.display = 'none';
        document.getElementById('mobile-host-section').style.display = 'none';
    }


    function clearUserSession() {
      localStorage.removeItem('earena_session');
      sessionStorage.removeItem('earena_session');
      
      document.getElementById('auth-buttons').style.display = 'flex';
      document.getElementById('user-menu').style.display = 'none';
      document.getElementById('mobile-auth-buttons').style.display = 'flex';
      document.getElementById('mobile-user-menu').style.display = 'none';
      clearAdminUI();
    }

    async function logout() {
      try {
        const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');
        if (session) {
          const sessionData = JSON.parse(session);
          const token = sessionData?.data?.token;
          if (token) {
              await fetch(`${API_BASE_URL}/api/auth/logout`, {
                method: 'POST',
                headers: { 'Authorization': `Bearer ${token}` }
              });
          }
        }
      } catch (error) {
        console.error('Logout API error:', error);
      } finally {
        clearUserSession();
        console.log('Logged out successfully');
        window.location.reload();
      }
    }

    // Initialize the page
    document.addEventListener('DOMContentLoaded', async () => {
      console.log('Initializing EArena homepage...');
      checkUserAuthentication();
      if (navigator.onLine) {
        addGlobalLoadingIndicator();
        try {
          await fetchTournaments(); 
          await populateAllSections();
          console.log('Content loaded successfully');
        } catch (error) {
          console.error('Failed to initialize page content:', error);
        } finally {
          removeGlobalLoadingIndicator();
        }
      } else {
        console.error('No internet connection detected.');
        showErrorState();
      }
    });

    // Global loading indicator
    function addGlobalLoadingIndicator() {
      if (document.getElementById('global-loader')) return;
      const loader = document.createElement('div');
      loader.id = 'global-loader';
      loader.style.cssText = `position: fixed; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, var(--accent), var(--accent-2)); z-index: 10001; animation: loading-bar 2s ease-in-out infinite;`;
      if (!document.querySelector('#loading-animation-style')) {
        const style = document.createElement('style');
        style.id = 'loading-animation-style';
        style.textContent = `@keyframes loading-bar { 0% { transform: translateX(-100%); } 50% { transform: translateX(0%); } 100% { transform: translateX(100%); } }`;
        document.head.appendChild(style);
      }
      document.body.appendChild(loader);
    }

    function removeGlobalLoadingIndicator() {
      const loader = document.getElementById('global-loader');
      if (loader) {
        loader.style.opacity = '0';
        setTimeout(() => loader.remove(), 300);
      }
    }
  </script>
</body>

</html>



