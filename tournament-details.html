<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="page-title">Tournament Details | EArena</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity=""
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <style>
    /* Theme variables */
    :root {
      --bg: #0f0f10;
      --panel: #1f1f20;
      --muted: #9aa0a6;
      --copy: #e6e6e6;
      --accent: #FFD700;
      --accent-2: #e0ac10;
      --glass: rgba(20, 20, 20, 0.55);
      --radius: 12px;
      --container: 1200px;
      --ease: 180ms cubic-bezier(.2, .9, .2, 1);
      --ease-out-quart: cubic-bezier(0.25, 1, 0.5, 1);
      --ease-in-out-quart: cubic-bezier(0.76, 0, 0.24, 1);
      --ease-out-back: cubic-bezier(0.34, 1.56, 0.64, 1);
      --spring: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, var(--bg), #070707 140%);
      color: var(--copy);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.45;
      -webkit-text-size-adjust: 100%;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .container {
      width: min(94%, var(--container));
      margin: 0 auto;
    }

    /* Header Styles */
    header.site-header {
      position: fixed;
      inset: 0 0 auto 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      background: rgba(26, 26, 26, 0.8);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      z-index: 1200;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s var(--ease-out-quart);
      height: 60px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 700;
      letter-spacing: -0.5px;
      color: var(--copy);
      font-size: 1.2rem;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .brand:hover {
      color: var(--accent);
      transform: scale(1.05);
    }

    .brand .accent {
      color: var(--accent);
    }

    .brand::before {
      content: "‚¨ú";
      font-size: 1rem;
      color: var(--accent);
    }

    .back-btn {
      color: var(--muted);
      font-size: 0.9rem;
      padding: 0.5rem 1rem;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .back-btn:hover {
      color: var(--accent);
    }

    .nav-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .login-link {
      color: var(--copy);
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s ease;
    }

    .login-link:hover {
      color: var(--accent);
    }

    .header-cta {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #000;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .header-cta:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
    }

    /* Main content */
    main {
      margin-top: 60px;
      min-height: calc(100vh - 60px);
    }

    /* Tournament Hero */
    .tournament-hero {
      position: relative;
      height: 70vh;
      min-height: 500px;
      background: linear-gradient(135deg, #1a1a1a, #0f0f0f);
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .tournament-hero::before {
      content: '';
      position: absolute;
      inset: 0;
      background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2)),
        radial-gradient(circle at 30% 40%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 70% 60%, rgba(255, 215, 0, 0.05) 0%, transparent 50%);
      z-index: 1;
    }

    /* Additional overlay for poster images - lighter for better image visibility */
    .tournament-hero::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.3));
      z-index: 1;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .tournament-hero.has-poster::after {
      opacity: 1;
    }

    .hero-content {
      position: relative;
      z-index: 2;
      max-width: 800px;
    }

    .tournament-badge {
      display: inline-block;
      background: rgba(255, 215, 0, 0.1);
      color: var(--accent);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
      border: 1px solid rgba(255, 215, 0, 0.3);
    }

    .tournament-title {
      font-size: clamp(2.5rem, 5vw, 4rem);
      font-weight: 800;
      margin-bottom: 1rem;
      line-height: 1.1;
    }

    .tournament-subtitle {
      font-size: 1.2rem;
      color: var(--muted);
      margin-bottom: 2rem;
      line-height: 1.5;
    }

    .hero-stats {
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }

    .stat-item {
      text-align: center;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 800;
      color: var(--accent);
      display: block;
    }

    .stat-label {
      font-size: 0.85rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .hero-actions {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #06110a;
      padding: 1rem 2rem;
      border-radius: 8px;
      font-weight: 700;
      font-size: 1rem;
      transition: all 0.3s var(--ease-out-back);
      border: none;
      cursor: pointer;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--copy);
      padding: 1rem 2rem;
      border-radius: 8px;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 215, 0, 0.3);
    }

    /* Registration Message Section */
    .registration-message {
      padding: 2rem 0;
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
      border-top: 1px solid rgba(255, 215, 0, 0.2);
      border-bottom: 1px solid rgba(255, 215, 0, 0.2);
    }

    .registration-alert {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      background: rgba(255, 215, 0, 0.1);
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 12px;
      padding: 1.5rem 2rem;
      backdrop-filter: blur(10px);
    }

    .alert-icon {
      font-size: 2rem;
      color: var(--accent);
      flex-shrink: 0;
    }

    .alert-content {
      flex: 1;
    }

    .alert-content h3 {
      color: var(--accent);
      font-size: 1.2rem;
      font-weight: 700;
      margin: 0 0 0.5rem 0;
    }

    .alert-content p {
      color: var(--copy);
      margin: 0;
      font-size: 0.95rem;
    }

    .alert-action {
      flex-shrink: 0;
    }

    .btn-register {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #000;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
    }

    .btn-register:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(255, 215, 0, 0.3);
    }

    /* Responsive registration message */
    @media (max-width: 768px) {
      .registration-alert {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
        padding: 1.5rem;
      }

      .alert-content h3 {
        font-size: 1.1rem;
      }

      .alert-content p {
        font-size: 0.9rem;
      }
    }

    /* Tournament Details Section */
    .tournament-details {
      padding: 4rem 0;
    }

    .details-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 3rem;
      margin-top: 2rem;
    }

    .details-main {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      padding: 2.5rem;
    }

    .details-sidebar {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .info-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      padding: 2rem;
    }

    .info-card h3 {
      color: var(--accent);
      font-size: 1.1rem;
      margin-bottom: 1rem;
      font-weight: 700;
    }

    .info-list {
      list-style: none;
    }

    .info-list li {
      display: flex;
      justify-content: space-between;
      padding: 0.75rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .info-list li:last-child {
      border-bottom: none;
    }

    .info-label {
      color: var(--muted);
      font-size: 0.9rem;
    }

    .info-value {
      color: var(--copy);
      font-weight: 600;
    }



    /* Leaderboard Section */
    .leaderboard-section {
      padding: 4rem 0;
      background: #000000;
    }

    .leaderboard-table {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      overflow: hidden;
      margin-top: 2rem;
    }

    .leaderboard-header {
      background: rgba(255, 215, 0, 0.1);
      padding: 1rem 1.5rem;
      display: grid;
      grid-template-columns: 60px 1fr 120px 120px 120px;
      gap: 1rem;
      font-weight: 700;
      color: var(--accent);
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .leaderboard-row {
      padding: 1rem 1.5rem;
      display: grid;
      grid-template-columns: 60px 1fr 120px 120px 120px;
      gap: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
      align-items: center;
    }

    .leaderboard-row:last-child {
      border-bottom: none;
    }

    .leaderboard-row:hover {
      background: rgba(255, 255, 255, 0.05);
    }

    .rank {
      font-weight: 700;
      font-size: 1.1rem;
    }

    .rank.first {
      color: #ffd700;
    }

    .rank.second {
      color: #c0c0c0;
    }

    .rank.third {
      color: #cd7f32;
    }

    .team-info {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .team-avatar {
      width: 40px;
      height: 40px;
      background: var(--accent);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: #000;
      font-size: 0.9rem;
    }

    .team-name {
      font-weight: 600;
      color: var(--copy);
    }

    .stat-value {
      font-weight: 600;
      text-align: center;
    }

    .points {
      color: var(--accent);
      font-weight: 700;
    }

    /* Leaderboard Navigation */
    .leaderboard-nav {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1.5rem;
      margin-top: 2rem;
      padding: 1rem 0;
    }

    .nav-arrow {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s var(--ease-out-quart);
      color: var(--copy);
      font-size: 1.2rem;
      position: relative;
      overflow: hidden;
    }

    .nav-arrow::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      opacity: 0;
      transition: opacity 0.3s var(--ease-out-quart);
      border-radius: 50%;
    }

    .nav-arrow i {
      position: relative;
      z-index: 1;
    }

    .nav-arrow:hover:not(.disabled) {
      background: rgba(255, 215, 0, 0.15);
      border-color: rgba(255, 215, 0, 0.4);
      color: var(--accent);
      transform: scale(1.1);
      box-shadow: 0 8px 25px rgba(255, 215, 0, 0.2);
    }

    .nav-arrow:hover:not(.disabled)::before {
      opacity: 0.1;
    }

    .nav-arrow:active:not(.disabled) {
      transform: scale(0.95);
    }

    .nav-arrow.disabled {
      opacity: 0.3;
      cursor: not-allowed;
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .navigation-hint {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      margin-top: 1rem;
      color: var(--muted);
      font-size: 0.85rem;
      opacity: 0.8;
    }

    .navigation-hint i {
      color: var(--accent);
    }

    /* Winner Section */
    .winner-section {
      padding: 4rem 0;
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
      border-top: 1px solid rgba(255, 215, 0, 0.2);
      border-bottom: 1px solid rgba(255, 215, 0, 0.2);
      display: none;
    }

    .winner-content {
      text-align: center;
      max-width: 800px;
      margin: 0 auto;
    }

    .winner-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #000;
      padding: 0.5rem 1.5rem;
      border-radius: 25px;
      font-weight: 700;
      font-size: 0.9rem;
      margin-bottom: 1.5rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .congratulations-text {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, var(--accent), #fff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .winner-team {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 2rem;
      margin: 2rem 0;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius);
      border: 1px solid rgba(255, 215, 0, 0.2);
    }

    .winner-logo {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      font-weight: 800;
      color: #000;
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
    }

    .winner-info h2 {
      font-size: 2rem;
      font-weight: 800;
      color: var(--accent);
      margin-bottom: 0.5rem;
    }

    .winner-prize {
      font-size: 1.2rem;
      color: var(--muted);
      font-weight: 600;
    }

    .team-members {
      margin-top: 2rem;
    }

    .team-members h3 {
      font-size: 1.2rem;
      margin-bottom: 1rem;
      color: var(--copy);
    }

    .members-list {
      display: flex;
      justify-content: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .member-tag {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 215, 0, 0.3);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-weight: 600;
      color: var(--copy);
      transition: all 0.3s ease;
    }

    .member-tag:hover {
      background: rgba(255, 215, 0, 0.1);
      border-color: rgba(255, 215, 0, 0.5);
      transform: translateY(-2px);
    }

    /* Winner Section Responsive */
    @media (max-width: 768px) {
      .congratulations-text {
        font-size: 2rem;
      }

      .winner-team {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
      }

      .winner-logo {
        width: 60px;
        height: 60px;
        font-size: 1.5rem;
      }

      .winner-info h2 {
        font-size: 1.5rem;
      }

      .members-list {
        gap: 0.5rem;
      }

      .member-tag {
        font-size: 0.9rem;
        padding: 0.4rem 0.8rem;
      }
    }

    .page-info {
      color: var(--muted);
      font-size: 0.95rem;
      font-weight: 500;
      background: rgba(255, 255, 255, 0.05);
      padding: 0.5rem 1rem;
      border-radius: 25px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      min-width: 80px;
      text-align: center;
    }

    .page-current {
      color: var(--accent);
      font-weight: 700;
    }

    /* Schedule Section */
    .schedule-section {
      padding: 4rem 0;
    }

    .schedule-timeline {
      margin-top: 2rem;
    }

    .timeline-item {
      display: flex;
      gap: 2rem;
      padding: 1.5rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .timeline-item:last-child {
      border-bottom: none;
    }

    .timeline-date {
      min-width: 120px;
      text-align: center;
    }

    .timeline-day {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent);
    }

    .timeline-time {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .timeline-content {
      flex: 1;
    }

    .timeline-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .timeline-desc {
      color: var(--muted);
      font-size: 0.9rem;
      line-height: 1.5;
    }

    /* Empty Schedule State */
    .empty-schedule {
      text-align: center;
      padding: 3rem 1rem;
      color: var(--muted);
    }

    .empty-schedule i {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .empty-schedule h3 {
      font-size: 1.2rem;
      margin-bottom: 0.5rem;
      color: var(--copy);
    }

    .empty-schedule p {
      font-size: 0.9rem;
    }

    /* Event Type Badges */
    .event-type-badge {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 0.5rem;
    }

    .event-type-badge.match {
      background: rgba(34, 197, 94, 0.2);
      color: #22c55e;
    }

    .event-type-badge.ceremony {
      background: rgba(168, 85, 247, 0.2);
      color: #a855f7;
    }

    .event-type-badge.break {
      background: rgba(59, 130, 246, 0.2);
      color: #3b82f6;
    }

    .event-type-badge.other {
      background: rgba(156, 163, 175, 0.2);
      color: #9ca3af;
    }

    .event-type-badge.system-registration {
      background: rgba(255, 215, 0, 0.2);
      color: var(--accent);
      border: 1px solid rgba(255, 215, 0, 0.3);
    }

    .event-type-badge.system-tournament {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
      border: 1px solid rgba(239, 68, 68, 0.3);
    }

    .event-type-badge.admin-update {
      background: rgba(59, 130, 246, 0.2);
      color: #3b82f6;
      border: 1px solid rgba(59, 130, 246, 0.3);
    }

    .event-type-badge.system-match {
      background: rgba(34, 197, 94, 0.2);
      color: #22c55e;
      border: 1px solid rgba(34, 197, 94, 0.3);
    }

    .timeline-item.system-event {
      border-left: 3px solid var(--accent);
      padding-left: 1rem;
      background: rgba(255, 215, 0, 0.05);
    }

    .timeline-item.admin-event {
      border-left: 3px solid #3b82f6;
      padding-left: 1rem;
      background: rgba(59, 130, 246, 0.05);
    }

    /* Section Headers */
    .section-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .section-title {
      font-size: clamp(2rem, 4vw, 3rem);
      font-weight: 800;
      margin-bottom: 1rem;
    }

    .section-subtitle {
      font-size: 1.1rem;
      color: var(--muted);
      max-width: 600px;
      margin: 0 auto;
    }

    .teams-counter {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 215, 0, 0.1);
      border: 1px solid rgba(255, 215, 0, 0.2);
      border-radius: 20px;
      color: var(--muted);
      font-size: 0.9rem;
      display: inline-block;
    }

    .teams-counter span {
      color: var(--accent);
      font-weight: 600;
    }

    /* Footer Styles */
    footer.site-footer {
      padding: 2.5rem 1rem;
      background: #070707;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .footer-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 2rem;
      margin-bottom: 1.5rem;
    }

    .footer-column h4 {
      color: var(--copy);
      font-weight: 700;
      margin-bottom: 1rem;
    }

    .footer-column ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .footer-column ul li {
      margin-bottom: 0.5rem;
    }

    .footer-column ul a {
      color: var(--muted);
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .footer-column ul a:hover {
      color: var(--accent);
    }

    .footer-bottom {
      text-align: center;
      margin-top: 1.25rem;
      padding-top: 1.25rem;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      color: var(--muted);
    }

    .footer-brand p {
      color: var(--muted);
      margin-top: 0.5rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .footer-grid {
        grid-template-columns: 1fr;
        text-align: center;
        gap: 1.5rem;
      }
    }

    @media (max-width: 768px) {
      .details-grid {
        grid-template-columns: 1fr;
        gap: 2rem;
      }

      .hero-stats {
        gap: 1rem;
      }

      .hero-actions {
        flex-direction: column;
      }

      .btn-primary,
      .btn-secondary {
        text-align: center;
      }

      .timeline-item {
        flex-direction: column;
        gap: 1rem;
      }

      .timeline-date {
        text-align: left;
      }

      .leaderboard-header,
      .leaderboard-row {
        grid-template-columns: 50px 1fr 80px 60px 60px;
        gap: 0.5rem;
        padding: 1rem;
        font-size: 0.85rem;
      }

      .team-avatar {
        width: 32px;
        height: 32px;
        font-size: 0.8rem;
      }

      .team-name {
        font-size: 0.9rem;
      }
    }

    /* Profile Dropdown Styles */
    .profile-dropdown {
      position: relative;
      display: flex;
      align-items: center;
    }

    .profile-icon {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--copy);
      cursor: pointer;
      border-radius: 50%;
      transition: all 0.3s ease;
      font-size: 1.5rem;
    }

    .profile-icon:hover {
      color: var(--accent);
      background: rgba(255, 215, 0, 0.1);
      transform: scale(1.1);
    }

    .profile-modal {
      position: absolute;
      top: 100%;
      right: 0;
      background: var(--panel);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      min-width: 280px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s var(--ease-out-quart);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
      z-index: 1000;
      margin-top: 10px;
    }

    .profile-dropdown:hover .profile-modal {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .profile-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .profile-photo {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #000;
      font-size: 1.5rem;
      flex-shrink: 0;
    }

    .profile-info {
      flex: 1;
    }

    .profile-username {
      font-weight: 700;
      color: var(--copy);
      font-size: 1.1rem;
      margin-bottom: 0.25rem;
    }

    .profile-role {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #000;
      padding: 0.25rem 0.5rem;
      border-radius: 12px;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: inline-block;
    }

    .profile-actions {
      padding: 0.5rem;
    }

    .profile-action {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      color: var(--copy);
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-weight: 600;
      font-size: 0.95rem;
      width: 100%;
      border: none;
      background: none;
      cursor: pointer;
      font-family: inherit;
    }

    .profile-action:hover {
      background: rgba(255, 255, 255, 0.05);
      color: var(--accent);
      transform: translateX(4px);
    }

    .logout-action:hover {
      background: rgba(255, 0, 0, 0.1);
      color: #ff6b6b;
    }

    .profile-action i {
      width: 16px;
      text-align: center;
    }

    #user-menu {
      display: flex;
      align-items: center;
    }
  </style>
</head>

<body>
  <header class="site-header">
    <a href="index.html" class="back-btn">
      <i class="fas fa-arrow-left"></i>
      Back to Home
    </a>

    <a href="index.html" class="brand">
      <span><span class="accent">E</span>Arena</span>
    </a>

    <div class="nav-actions">
      <!-- Not logged in -->
      <div id="guest-menu">
        <a href="auth.html?tab=login&returnUrl=tournament-details.html" class="login-link">Log in</a>
        <button class="header-cta" onclick="redirectToAuth()">Sign up</button>
      </div>
      
      <!-- Logged in -->
      <div id="user-menu" style="display: none;">
        <div class="profile-dropdown">
          <div class="profile-icon" id="profile-icon">
            <i class="fas fa-user-circle"></i>
          </div>
          <div class="profile-modal" id="profile-modal">
            <div class="profile-header">
              <div class="profile-photo">
                <i class="fas fa-user"></i>
              </div>
              <div class="profile-info">
                <div class="profile-username" id="modal-username">User</div>
                <div class="profile-role" id="modal-role-badge" style="display: none;">Admin</div>
              </div>
            </div>
            <div class="profile-actions">
              <a href="user-dashboard.html" class="profile-action" id="modal-dashboard-link">
                <i class="fas fa-user"></i>
                <span>My Account</span>
              </a>
              <button class="profile-action logout-action" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- Tournament Hero -->
    <section class="tournament-hero">
      <div class="container">
        <div class="hero-content">
          <div class="tournament-badge">
            <i class="fas fa-trophy"></i>
            Featured Tournament
          </div>

          <h1 class="tournament-title" id="tournament-title">Loading Tournament...</h1>
          <p class="tournament-subtitle" id="tournament-subtitle">
            Loading tournament details...
          </p>



          <div class="hero-actions" id="hero-actions">
            <button class="btn-primary" id="primary-action">
              <i class="fas fa-user-plus"></i>
              Register Now
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Winner Section (shown for completed tournaments) -->
    <section class="winner-section" id="winner-section">
      <div class="container">
        <div class="winner-content">
          <div class="winner-badge">üèÜ Tournament Champion</div>
          <h1 class="congratulations-text">Congratulations!</h1>

          <div class="winner-team">
            <div class="winner-logo" id="winner-logo">TL</div>
            <div class="winner-info">
              <h2 id="winner-name">Team Liquid</h2>
              <div class="winner-prize" id="winner-prize">Prize: $200,000</div>
            </div>
          </div>

          <div class="team-members">
            <h3>Championship Team Members</h3>
            <div class="members-list" id="members-list">
              <span class="member-tag">ScreaM</span>
              <span class="member-tag">Jamppi</span>
              <span class="member-tag">soulcas</span>
              <span class="member-tag">Nivera</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Registration Status Message (only shown when registrations are open) -->
    <section class="registration-message" id="registration-message" style="display: none;">
      <div class="container">
        <div class="registration-alert">
          <div class="alert-icon">
            <i class="fas fa-clock"></i>
          </div>
          <div class="alert-content">
            <h3>Registrations are Open!</h3>
            <p>Don't miss your chance to compete. Register your team now before spots fill up.</p>
          </div>
          <div class="alert-action">
            <button class="btn-register" onclick="document.getElementById('primary-action').click()">
              <i class="fas fa-user-plus"></i>
              Register Now
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Tournament Details -->
    <section class="tournament-details" id="tournament-details-section">
      <div class="container">
        <div class="details-grid">
          <div class="details-main">
            <h2 style="color: var(--accent); margin-bottom: 1.5rem;">Tournament Overview</h2>
            <div id="tournament-overview">
              <p style="margin-bottom: 1.5rem; line-height: 1.6; color: var(--muted);">
                Loading tournament details...
              </p>
            </div>

            <h3 style="color: var(--accent); margin: 2rem 0 1rem 0;">Tournament Format</h3>
            <div id="tournament-format-details">
              <p style="color: var(--muted);">Loading format details...</p>
            </div>
          </div>

          <div class="details-sidebar">
            <div class="info-card">
              <h3><i class="fas fa-info-circle"></i> Tournament Info</h3>
              <ul class="info-list">
                <li>
                  <span class="info-label">Game</span>
                  <span class="info-value" id="game-name">--</span>
                </li>
                <li>
                  <span class="info-label">Format</span>
                  <span class="info-value" id="tournament-format">--</span>
                </li>
                <li>
                  <span class="info-label">Entry Fee</span>
                  <span class="info-value" id="entry-fee">--</span>
                </li>
                <li>
                  <span class="info-label">Max Teams</span>
                  <span class="info-value" id="max-teams">--</span>
                </li>
                <li>
                  <span class="info-label">Organizer</span>
                  <span class="info-value">EArena</span>
                </li>
              </ul>
            </div>

            <div class="info-card">
              <h3><i class="fas fa-calendar"></i> Schedule</h3>
              <ul class="info-list">
                <li>
                  <span class="info-label">Registration Opens</span>
                  <span class="info-value" id="reg-start-date">--</span>
                </li>
                <li>
                  <span class="info-label">Registration Closes</span>
                  <span class="info-value" id="reg-end-date">--</span>
                </li>
                <li>
                  <span class="info-label">Tournament Start</span>
                  <span class="info-value" id="tournament-start-date">--</span>
                </li>
                <li>
                  <span class="info-label">Tournament End</span>
                  <span class="info-value" id="tournament-end-date">--</span>
                </li>
              </ul>
              <div id="custom-schedule-display">
                <!-- Custom schedule events will be displayed here -->
              </div>
            </div>

            <div class="info-card">
              <h3><i class="fas fa-trophy"></i> Prizes</h3>
              <ul class="info-list">
                <li>
                  <span class="info-label">1st Place</span>
                  <span class="info-value">$200,000</span>
                </li>
                <li>
                  <span class="info-label">2nd Place</span>
                  <span class="info-value">$100,000</span>
                </li>
                <li>
                  <span class="info-label">3rd Place</span>
                  <span class="info-value">$50,000</span>
                </li>
                <li>
                  <span class="info-label">4th Place</span>
                  <span class="info-value">$25,000</span>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Leaderboard Section -->
    <section class="leaderboard-section" id="leaderboard-section" style="display: none;">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Live Leaderboard</h2>
          <p class="section-subtitle">Current standings and team performance</p>
          <div class="teams-counter" id="teams-counter">
            Showing teams <span id="teams-range">1-8</span> of <span id="total-teams">24</span>
          </div>
        </div>

        <div class="leaderboard-table" id="leaderboard-table">
          <div class="leaderboard-header">
            <div>Rank</div>
            <div>Team</div>
            <div>Points</div>
            <div>Kills</div>
            <div>Matches</div>
          </div>

          <div id="leaderboard-rows">
            <!-- Leaderboard rows will be populated by JavaScript -->
          </div>
        </div>

        <div class="leaderboard-nav">
          <button class="nav-arrow" id="prev-arrow" onclick="previousPage()" title="Previous page">
            <i class="fas fa-chevron-left"></i>
          </button>
          <div class="page-info">
            <span class="page-current" id="current-page">1</span> of <span id="total-pages">3</span>
          </div>
          <button class="nav-arrow" id="next-arrow" onclick="nextPage()" title="Next page">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>

        <div class="navigation-hint">
          <i class="fas fa-info-circle"></i>
          <span>Use arrow keys or buttons to navigate through all 24 teams</span>
        </div>
      </div>
    </section>

    <!-- Schedule Section -->
    <section class="schedule-section">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Tournament Schedule</h2>
          <p class="section-subtitle">Complete timeline of matches and events</p>
        </div>

        <div class="schedule-timeline" id="schedule-timeline">
          <!-- Schedule events will be loaded dynamically -->
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-column footer-brand">
          <h4><a href="index.html" style="color: var(--copy); text-decoration: none;"><span
                style="color:var(--accent)">E</span>Arena</a></h4>
          <p>The ultimate destination for competitive gaming.</p>
        </div>
        <div class="footer-column">
          <h4>Tournaments</h4>
          <ul>
            <li><a href="tournaments.html">Browse All</a></li>
            <li><a href="tournaments.html?filter=live">Live Matches</a></li>
            <li><a href="tournaments.html?filter=upcoming">Upcoming</a></li>
            <li><a href="tournaments.html?filter=completed">Past Results</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h4>Community</h4>
          <ul>
            <li><a href="#">Discord</a></li>
            <li><a href="#">Forums</a></li>
            <li><a href="#">Support</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h4>Company</h4>
          <ul>
            <li><a href="#">About</a></li>
            <li><a href="auth.html?tab=login&returnUrl=tournament-details.html">Sign In</a></li>
            <li><a href="#">Contact</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 EArena. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    // Auto-detect API URL based on environment
    const API_BASE_URL = (() => {
      // Check if we're running locally
      const isLocal = window.location.hostname === 'localhost' ||
        window.location.hostname === '127.0.0.1' ||
        window.location.protocol === 'file:';

      const apiUrl = isLocal ? 'http://localhost:8000' : 'https://t2-237c.onrender.com';



      return apiUrl;
    })();
    let currentTournament = null;

    // Helper function to redirect to auth with return URL
    function redirectToAuth(tab = 'register') {
      const currentUrl = window.location.href;
      const returnUrl = encodeURIComponent(currentUrl);
      window.location.href = `auth.html?tab=${tab}&returnUrl=${returnUrl}`;
    }

    // Helper function to get session data
    function getSessionData() {
      const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');
      try {
        return JSON.parse(session);
      } catch (error) {
        return null;
      }
    }

    // Function to get proper image URL with CORS support
    function getImageUrl(imagePath) {
      if (!imagePath) return null;
      if (imagePath.startsWith('http')) return imagePath;
      const filename = imagePath.split('/').pop();
      return `${API_BASE_URL}/api/static/images/${filename}`;
    }

    // Tournament database - in a real app, this would come from an API
    const tournamentDatabase = {
      'pubg-global-series-2025': {
        id: 'pubg-global-series-2025',
        title: 'PUBG Global Series 2025',
        subtitle: 'The biggest PUBG tournament of the year is here! Join us as the best teams from around the world battle it out in London for the title of Global Champions.',
        game: 'PUBG',
        prizePool: '$500,000',
        location: 'London, UK',
        format: 'Battle Royale',
        maxTeams: 24,
        dates: {
          registrationStart: new Date(Date.now() - 86400000), // Started 1 day ago
          registrationEnd: new Date(Date.now() + 7 * 86400000), // Ends in 7 days
          tournamentStart: new Date(Date.now() + 10 * 86400000), // Starts in 10 days
          tournamentEnd: new Date(Date.now() + 17 * 86400000) // Ends in 17 days
        },
        status: 'upcoming',
        backgroundImage: 'https://images.unsplash.com/photo-1542751371-adc38448a05e?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80'
      },
      'bgmi-masters-championship': {
        id: 'bgmi-masters-championship',
        title: 'BGMI Masters Championship',
        subtitle: 'The ultimate BGMI championship featuring top Indian teams competing for supremacy and massive prizes.',
        game: 'BGMI',
        prizePool: '‚Çπ25,00,000',
        location: 'Mumbai, India',
        format: 'Battle Royale',
        maxTeams: 24,
        dates: {
          registrationStart: new Date('2025-08-15'),
          registrationEnd: new Date('2025-08-25'),
          tournamentStart: new Date('2025-09-01'),
          tournamentEnd: new Date('2025-09-10')
        },
        status: 'live',
        backgroundImage: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?ixlib=rb-4.0.3&auto=format&fit=crop&w=2071&q=80'
      },
      'bgmi-championship-series': {
        id: 'bgmi-championship-series',
        title: 'BGMI Championship Series',
        subtitle: 'A series of competitive matches featuring the best BGMI teams from across the region.',
        game: 'BGMI',
        prizePool: '‚Çπ15,00,000',
        location: 'Delhi, India',
        format: 'Battle Royale',
        maxTeams: 24,
        dates: {
          registrationStart: new Date('2025-07-01'),
          registrationEnd: new Date('2025-07-10'),
          tournamentStart: new Date('2025-07-15'),
          tournamentEnd: new Date('2025-07-25')
        },
        status: 'completed',
        backgroundImage: 'https://images.unsplash.com/photo-1493711662062-fa541adb3fc8?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80'
      }
    };

    // Get tournament slug from URL parameters
    function getTournamentId() {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get('slug') || urlParams.get('tournament') || 'pubg-global-series-2025';
    }

    // Fetch tournament data from API
    async function getTournamentData(tournamentSlug) {
      try {
        const response = await fetch(`${API_BASE_URL}/api/tournaments/slug/${tournamentSlug}`);

        if (!response.ok) {
          if (response.status === 404) {
            throw new Error('Tournament not found');
          }
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();

        if (result.success) {
          // Transform backend data to match frontend format
          const tournament = result.data;
          return {
            id: tournament._id,
            title: tournament.title,
            subtitle: tournament.subtitle || 'Join the ultimate esports experience',
            game: tournament.game || 'Unknown',
            prizePool: tournament.prizePool ? `$${tournament.prizePool.toLocaleString()}` : 'TBA',
            location: 'Online', // Default for now
            format: 'Battle Royale', // Default for now
            maxTeams: tournament.maxTeams || 16,
            status: tournament.status || 'upcoming',
            dates: {
              registrationStart: tournament.registrationStart ? new Date(tournament.registrationStart) : new Date(Date.now() - 86400000),
              registrationEnd: tournament.registrationEnd ? new Date(tournament.registrationEnd) : new Date(Date.now() + 7 * 86400000),
              tournamentStart: tournament.tournamentStart ? new Date(tournament.tournamentStart) : new Date(Date.now() + 10 * 86400000),
              tournamentEnd: tournament.tournamentEnd ? new Date(tournament.tournamentEnd) : new Date(Date.now() + 17 * 86400000)
            },
            backgroundImage: tournament.backgroundImage || 'https://images.unsplash.com/photo-1542751371-adc38448a05e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80'
          };
        } else {
          throw new Error(result.error || 'Failed to fetch tournament');
        }
      } catch (error) {
        console.error('Error fetching tournament:', error);
        throw error;
      }
    }

    // Determine tournament status based on current date
    function calculateTournamentStatus(tournament) {
      const now = new Date();
      const registrationStart = new Date(tournament.registrationStart);
      const registrationEnd = new Date(tournament.registrationEnd);
      const tournamentStart = new Date(tournament.tournamentStart);
      const tournamentEnd = new Date(tournament.tournamentEnd);

      if (now < registrationStart) {
        return 'upcoming';
      } else if (now >= registrationStart && now <= registrationEnd) {
        return 'registration_open';
      } else if (now > registrationEnd && now < tournamentStart) {
        return 'registration_closed';
      } else if (now >= tournamentStart && now <= tournamentEnd) {
        return 'live';
      } else {
        return 'completed';
      }
    }

    // Tournament dates data
    let tournamentDates = null;

    // Authentication functions
    function isUserLoggedIn() {
      const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');
      return !!session;
    }

    function getUserSession() {
      const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');
      return session ? JSON.parse(session) : null;
    }

    function requireAuthentication(action) {
      if (!isUserLoggedIn()) {
        showAuthRequiredModal(action);
        return false;
      }
      return true;
    }

    function showAuthRequiredModal(action) {
      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
      `;

      modal.innerHTML = `
        <div style="
          background: var(--panel);
          border-radius: var(--radius);
          padding: 2rem;
          max-width: 400px;
          text-align: center;
          border: 1px solid rgba(255, 215, 0, 0.3);
        ">
          <div style="
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--accent), var(--accent-2));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 1.5rem;
            color: #000;
          ">
            <i class="fas fa-lock"></i>
          </div>
          <h3 style="color: var(--copy); margin-bottom: 1rem;">Authentication Required</h3>
          <p style="color: var(--muted); margin-bottom: 2rem;">
            You need to be logged in to ${action}. Please sign in or create an account to continue.
          </p>
          <div style="display: flex; gap: 1rem; justify-content: center;">
            <button onclick="redirectToAuth()" style="
              background: linear-gradient(135deg, var(--accent), var(--accent-2));
              color: #000;
              border: none;
              padding: 0.75rem 1.5rem;
              border-radius: 6px;
              font-weight: 600;
              cursor: pointer;
            ">Sign In</button>
            <button onclick="this.closest('div').parentElement.remove()" style="
              background: rgba(255, 255, 255, 0.1);
              color: var(--copy);
              border: 1px solid rgba(255, 255, 255, 0.2);
              padding: 0.75rem 1.5rem;
              border-radius: 6px;
              font-weight: 600;
              cursor: pointer;
            ">Cancel</button>
          </div>
        </div>
      `;

      document.body.appendChild(modal);

      // Close on background click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    function showRegistrationModal(user) {
      if (!currentTournament) {
        console.error('Tournament data not loaded');
        return;
      }

      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
        overflow-y: auto;
        padding: 1rem;
      `;

      modal.innerHTML = `
        <div style="
          background: var(--panel);
          border-radius: var(--radius);
          padding: 2rem;
          max-width: 800px;
          width: 100%;
          max-height: 90vh;
          overflow-y: auto;
          border: 1px solid rgba(255, 215, 0, 0.3);
        ">
          <div style="text-align: center; margin-bottom: 2rem;">
            <div style="
              width: 60px;
              height: 60px;
              background: linear-gradient(135deg, var(--accent), var(--accent-2));
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              margin: 0 auto 1rem;
              font-size: 1.5rem;
              color: #000;
            ">
              <i class="fas fa-trophy"></i>
            </div>
            <h3 style="color: var(--copy); margin-bottom: 0.5rem;">Tournament Registration</h3>
            <p style="color: var(--muted);">${currentTournament.title}</p>
            ${currentTournament.entryFee > 0 ? `<p style="color: var(--accent); font-weight: 600; margin-top: 0.5rem;">Entry Fee: ‚Çπ${currentTournament.entryFee}</p>` : ''}
          </div>
          
          <div style="background: rgba(255, 215, 0, 0.1); padding: 1rem; border-radius: 6px; margin-bottom: 1.5rem;">
            <p style="color: var(--copy); margin: 0;">
              <strong>Team Captain:</strong> ${user.username} (${user.email})
            </p>
          </div>
          
          <form id="tournament-registration-form">
            <div style="margin-bottom: 1.5rem;">
              <label style="display: block; margin-bottom: 0.5rem; color: var(--copy); font-weight: 600;">Team Name</label>
              <input type="text" id="team-name" required style="
                width: 100%;
                padding: 0.75rem;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 6px;
                color: var(--copy);
                font-size: 1rem;
              " placeholder="Enter your team name">
            </div>
            
            <div style="margin-bottom: 1.5rem;">
              <h4 style="color: var(--copy); margin-bottom: 1rem;">Player Details (Maximum 4 players)</h4>
              <div id="players-container">
                <!-- Player forms will be added here -->
              </div>
              <button type="button" id="add-player-btn" style="
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
                color: var(--copy);
                padding: 0.5rem 1rem;
                border-radius: 6px;
                cursor: pointer;
                margin-top: 1rem;
              ">
                <i class="fas fa-plus"></i> Add Player
              </button>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="tournament-rules" required style="
                  width: 18px;
                  height: 18px;
                ">
                <span style="color: var(--muted); font-size: 0.9rem;">
                  I agree to the tournament rules and regulations
                </span>
              </label>
            </div>
            
            <div style="display: flex; gap: 1rem; justify-content: center;">
              <button type="button" onclick="this.closest('div').parentElement.parentElement.remove()" style="
                background: rgba(255, 255, 255, 0.1);
                color: var(--copy);
                border: 1px solid rgba(255, 255, 255, 0.2);
                padding: 0.75rem 1.5rem;
                border-radius: 6px;
                font-weight: 600;
                cursor: pointer;
              ">Cancel</button>
              <button type="submit" id="register-submit-btn" style="
                background: linear-gradient(135deg, var(--accent), var(--accent-2));
                color: #000;
                border: none;
                padding: 0.75rem 2rem;
                border-radius: 6px;
                font-weight: 600;
                cursor: pointer;
              ">Register Team</button>
            </div>
          </form>
        </div>
      `;

      document.body.appendChild(modal);

      // Initialize player forms
      let playerCount = 0;
      const maxPlayers = 4;

      function createPlayerForm(index, isFirst = false) {
        return `
          <div class="player-form" data-player="${index}" style="
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
          ">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
              <h5 style="color: var(--copy); margin: 0;">Player ${index + 1} ${isFirst ? '(Captain)' : ''}</h5>
              ${!isFirst ? `<button type="button" class="remove-player" data-player="${index}" style="
                background: rgba(255, 0, 0, 0.2);
                border: 1px solid rgba(255, 0, 0, 0.3);
                color: #ff6b6b;
                padding: 0.25rem 0.5rem;
                border-radius: 4px;
                cursor: pointer;
                font-size: 0.8rem;
              ">Remove</button>` : ''}
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
              <div>
                <label style="display: block; margin-bottom: 0.25rem; color: var(--muted); font-size: 0.9rem;">Player Name</label>
                <input type="text" name="players[${index}][name]" required ${isFirst ? `value="${user.username}"` : ''} style="
                  width: 100%;
                  padding: 0.5rem;
                  background: rgba(255, 255, 255, 0.05);
                  border: 1px solid rgba(255, 255, 255, 0.1);
                  border-radius: 4px;
                  color: var(--copy);
                  font-size: 0.9rem;
                " placeholder="Enter player name">
              </div>
              <div>
                <label style="display: block; margin-bottom: 0.25rem; color: var(--muted); font-size: 0.9rem;">In-Game ID</label>
                <input type="text" name="players[${index}][inGameId]" required style="
                  width: 100%;
                  padding: 0.5rem;
                  background: rgba(255, 255, 255, 0.05);
                  border: 1px solid rgba(255, 255, 255, 0.1);
                  border-radius: 4px;
                  color: var(--copy);
                  font-size: 0.9rem;
                " placeholder="Enter in-game ID">
              </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
              <div>
                <label style="display: block; margin-bottom: 0.25rem; color: var(--muted); font-size: 0.9rem;">Phone Number</label>
                <input type="tel" name="players[${index}][phoneNumber]" required ${isFirst ? `value="${user.phoneNumber || ''}"` : ''} style="
                  width: 100%;
                  padding: 0.5rem;
                  background: rgba(255, 255, 255, 0.05);
                  border: 1px solid rgba(255, 255, 255, 0.1);
                  border-radius: 4px;
                  color: var(--copy);
                  font-size: 0.9rem;
                " placeholder="Enter phone number">
              </div>
              <div>
                <label style="display: block; margin-bottom: 0.25rem; color: var(--muted); font-size: 0.9rem;">Email</label>
                <input type="email" name="players[${index}][email]" required ${isFirst ? `value="${user.email}"` : ''} style="
                  width: 100%;
                  padding: 0.5rem;
                  background: rgba(255, 255, 255, 0.05);
                  border: 1px solid rgba(255, 255, 255, 0.1);
                  border-radius: 4px;
                  color: var(--copy);
                  font-size: 0.9rem;
                " placeholder="Enter email address">
              </div>
            </div>
          </div>
        `;
      }

      // Add first player (captain)
      const playersContainer = modal.querySelector('#players-container');
      playersContainer.innerHTML = createPlayerForm(0, true);
      playerCount = 1;

      // Add player button functionality
      const addPlayerBtn = modal.querySelector('#add-player-btn');
      addPlayerBtn.addEventListener('click', () => {
        if (playerCount < maxPlayers) {
          playersContainer.insertAdjacentHTML('beforeend', createPlayerForm(playerCount));
          playerCount++;

          if (playerCount >= maxPlayers) {
            addPlayerBtn.style.display = 'none';
          }
        }
      });

      // Remove player functionality
      playersContainer.addEventListener('click', (e) => {
        if (e.target.classList.contains('remove-player')) {
          const playerIndex = parseInt(e.target.dataset.player);
          const playerForm = modal.querySelector(`[data-player="${playerIndex}"]`);
          if (playerForm) {
            playerForm.remove();
            playerCount--;
            addPlayerBtn.style.display = 'block';
          }
        }
      });

      // Handle form submission
      const form = modal.querySelector('#tournament-registration-form');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const teamName = document.getElementById('team-name').value.trim();
        const rulesAgreed = document.getElementById('tournament-rules').checked;

        if (!teamName || !rulesAgreed) {
          alert('Please fill in team name and agree to the rules');
          return;
        }

        // Collect player data
        const players = [];
        const playerForms = modal.querySelectorAll('.player-form');

        for (let i = 0; i < playerForms.length; i++) {
          const form = playerForms[i];
          const name = form.querySelector('input[name*="[name]"]').value.trim();
          const inGameId = form.querySelector('input[name*="[inGameId]"]').value.trim();
          const phoneNumber = form.querySelector('input[name*="[phoneNumber]"]').value.trim();
          const email = form.querySelector('input[name*="[email]"]').value.trim();

          if (!name || !inGameId || !phoneNumber || !email) {
            alert(`Please fill in all fields for Player ${i + 1}`);
            return;
          }

          players.push({ name, inGameId, phoneNumber, email });
        }

        if (players.length === 0) {
          alert('Please add at least one player');
          return;
        }

        // Register team via API
        const submitBtn = modal.querySelector('#register-submit-btn');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Registering...';

        try {
          const sessionData = getUserSession();

          const response = await fetch(`${API_BASE_URL}/api/tournaments/${currentTournament.slug}/register`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${sessionData.token}`
            },
            body: JSON.stringify({
              teamName: teamName,
              players: players
            })
          });

          const result = await response.json();

          if (response.ok && result.success) {
            modal.remove();

            if (result.data.paymentRequired && result.data.totalAmount > 0) {
              showPaymentModal(result.data.team, result.data.totalAmount);
            } else {
              showSuccessModal('Registration Successful!', `Your team "${teamName}" has been registered for ${currentTournament.title}. Good luck!`);
              setTimeout(() => {
                window.location.reload();
              }, 2000);
            }
          } else {
            throw new Error(result.error || 'Registration failed');
          }
        } catch (error) {
          console.error('Registration error:', error);
          alert(`Registration failed: ${error.message}`);

          // Reset button
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        }
      });

      // Close on background click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    function showPaymentModal(team, amount) {
      if (!currentTournament) {
        console.error('Tournament data not loaded');
        return;
      }

      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
        overflow-y: auto;
      `;

      modal.innerHTML = `
        <div style="
          background: var(--panel);
          border-radius: var(--radius);
          padding: 2rem;
          max-width: 500px;
          width: 90%;
          border: 1px solid rgba(255, 215, 0, 0.3);
        ">
          <div style="text-align: center; margin-bottom: 2rem;">
            <div style="
              width: 60px;
              height: 60px;
              background: linear-gradient(135deg, var(--accent), var(--accent-2));
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              margin: 0 auto 1rem;
              font-size: 1.5rem;
              color: #000;
            ">
              <i class="fas fa-credit-card"></i>
            </div>
            <h3 style="color: var(--copy); margin-bottom: 0.5rem;">Payment Required</h3>
            <p style="color: var(--muted);">Complete payment to confirm your registration</p>
          </div>
          
          <div style="background: rgba(255, 215, 0, 0.1); padding: 1rem; border-radius: 6px; margin-bottom: 1.5rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <span style="color: var(--muted);">Team:</span>
              <span style="color: var(--copy); font-weight: 600;">${team.name}</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <span style="color: var(--muted);">Tournament:</span>
              <span style="color: var(--copy);">${currentTournament.title}</span>
            </div>
            <div style="display: flex; justify-content: space-between; border-top: 1px solid rgba(255, 255, 255, 0.1); padding-top: 0.5rem; margin-top: 0.5rem;">
              <span style="color: var(--copy); font-weight: 600;">Total Amount:</span>
              <span style="color: var(--accent); font-weight: 700; font-size: 1.2rem;">‚Çπ${amount}</span>
            </div>
          </div>
          
          <div style="text-align: center; margin-bottom: 1.5rem;">
            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 1rem;">
              You will be redirected to UPay payment gateway to complete the payment.
            </p>
            <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 6px;">
              <p style="color: var(--copy); font-size: 0.85rem; margin: 0;">
                <i class="fas fa-info-circle" style="color: var(--accent);"></i>
                Your registration is saved. Complete payment within 30 minutes to confirm your spot.
              </p>
            </div>
          </div>
          
          <div style="display: flex; gap: 1rem; justify-content: center;">
            <button type="button" onclick="this.closest('div').parentElement.parentElement.remove(); window.location.reload();" style="
              background: rgba(255, 255, 255, 0.1);
              color: var(--copy);
              border: 1px solid rgba(255, 255, 255, 0.2);
              padding: 0.75rem 1.5rem;
              border-radius: 6px;
              font-weight: 600;
              cursor: pointer;
            ">Pay Later</button>
            <button type="button" id="proceed-payment-btn" style="
              background: linear-gradient(135deg, var(--accent), var(--accent-2));
              color: #000;
              border: none;
              padding: 0.75rem 2rem;
              border-radius: 6px;
              font-weight: 700;
              cursor: pointer;
            ">Proceed to Payment</button>
          </div>
        </div>
      `;

      document.body.appendChild(modal);

      // Handle payment button
      modal.querySelector('#proceed-payment-btn').addEventListener('click', () => {
        // TODO: Integrate with UPay payment gateway
        alert('Payment gateway integration will be added here. For now, registration is complete!');
        modal.remove();
        showSuccessModal('Registration Successful!', `Your team "${team.name}" has been registered. Complete payment to confirm your spot.`);
        setTimeout(() => {
          window.location.reload();
        }, 2000);
      });

      // Close on background click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    function showSuccessModal(title, message) {
      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
      `;

      modal.innerHTML = `
        <div style="
          background: var(--panel);
          border-radius: var(--radius);
          padding: 2rem;
          max-width: 400px;
          text-align: center;
          border: 1px solid rgba(0, 255, 0, 0.3);
        ">
          <div style="
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #51cf66, #40c057);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 1.5rem;
            color: #000;
          ">
            <i class="fas fa-check"></i>
          </div>
          <h3 style="color: var(--copy); margin-bottom: 1rem;">${title}</h3>
          <p style="color: var(--muted); margin-bottom: 2rem;">${message}</p>
          <button onclick="this.closest('div').parentElement.remove()" style="
            background: linear-gradient(135deg, var(--accent), var(--accent-2));
            color: #000;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
          ">Continue</button>
        </div>
      `;

      document.body.appendChild(modal);

      // Auto close after 5 seconds
      setTimeout(() => {
        if (document.body.contains(modal)) {
          modal.remove();
        }
      }, 5000);
    }

    // Initialize tournament page
    async function initializeTournament() {
      try {
        // Show loading state
        showLoadingState();

        const tournamentSlug = getTournamentId();
        currentTournament = await getTournamentData(tournamentSlug);

        if (!currentTournament) {
          showErrorState('Tournament not found');
          return;
        }

        tournamentDates = currentTournament.dates;

        // Update page title and meta
        document.getElementById('page-title').textContent = `${currentTournament.title} - Tournament Details | EArena`;

        // Update tournament info in the page
        updateTournamentInfo();

        // Generate leaderboard data based on tournament
        generateLeaderboardData();

        // Update tournament status
        updateTournamentStatus();

        // Initialize leaderboard
        renderLeaderboard();

        // Hide loading state
        hideLoadingState();

      } catch (error) {
        console.error('Error initializing tournament:', error);
        showErrorState('Failed to load tournament data');
      }
    }

    // Show loading state
    function showLoadingState() {
      // Create loading overlay
      const loadingOverlay = document.createElement('div');
      loadingOverlay.id = 'loading-overlay';
      loadingOverlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(15, 15, 16, 0.9);
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        opacity: 0;
        transition: opacity 0.3s ease;
      `;

      loadingOverlay.innerHTML = `
        <div style="text-align: center; color: var(--copy);">
          <div style="
            width: 60px;
            height: 60px;
            border: 3px solid rgba(255, 215, 0, 0.3);
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
          "></div>
          <h3 style="margin-bottom: 0.5rem; font-weight: 600;">Loading Tournament</h3>
          <p style="color: var(--muted); font-size: 0.9rem;">Please wait while we fetch the latest data...</p>
        </div>
        <style>
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        </style>
      `;

      document.body.appendChild(loadingOverlay);

      // Fade in
      setTimeout(() => {
        loadingOverlay.style.opacity = '1';
      }, 10);
    }

    // Hide loading state
    function hideLoadingState() {
      const loadingOverlay = document.getElementById('loading-overlay');
      if (loadingOverlay) {
        loadingOverlay.style.opacity = '0';
        setTimeout(() => {
          if (loadingOverlay.parentNode) {
            loadingOverlay.parentNode.removeChild(loadingOverlay);
          }
        }, 300);
      }
    }

    // Show error state
    function showErrorState(message) {
      const errorDiv = document.createElement('div');
      errorDiv.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: var(--panel);
        color: var(--copy);
        padding: 2rem;
        border-radius: var(--radius);
        border: 1px solid rgba(255, 0, 0, 0.3);
        text-align: center;
        z-index: 1000;
      `;
      errorDiv.innerHTML = `
        <h3 style="color: #ff4444; margin-bottom: 1rem;">${message}</h3>
        <p style="margin-bottom: 1.5rem;">Please check the tournament ID or try again later.</p>
        <button onclick="window.location.href='tournaments.html'" style="
          background: var(--accent);
          color: var(--bg);
          border: none;
          padding: 0.75rem 1.5rem;
          border-radius: 6px;
          cursor: pointer;
          font-weight: 600;
        ">View All Tournaments</button>
      `;
      document.body.appendChild(errorDiv);
    }

    // Update tournament information in the DOM
    function updateTournamentInfo() {
      if (!currentTournament) return;

      // Update hero section
      document.querySelector('.tournament-title').textContent = currentTournament.title;
      document.querySelector('.tournament-subtitle').textContent = currentTournament.subtitle;

      // Update tournament details
      const detailsGrid = document.querySelector('.details-grid');
      if (detailsGrid) {
        detailsGrid.innerHTML = `
          <div class="detail-card">
            <div class="detail-icon">
              <i class="fas fa-trophy"></i>
            </div>
            <div class="detail-content">
              <h3>Prize Pool</h3>
              <p>${currentTournament.prizePool}</p>
            </div>
          </div>
          
          <div class="detail-card">
            <div class="detail-icon">
              <i class="fas fa-calendar"></i>
            </div>
            <div class="detail-content">
              <h3>Tournament Dates</h3>
              <p>${formatDateRange(currentTournament.dates.tournamentStart, currentTournament.dates.tournamentEnd)}</p>
            </div>
          </div>
          
          <div class="detail-card">
            <div class="detail-icon">
              <i class="fas fa-map-marker-alt"></i>
            </div>
            <div class="detail-content">
              <h3>Location</h3>
              <p>${currentTournament.location}</p>
            </div>
          </div>
          
          <div class="detail-card">
            <div class="detail-icon">
              <i class="fas fa-users"></i>
            </div>
            <div class="detail-content">
              <h3>Teams</h3>
              <p>${currentTournament.maxTeams} Teams</p>
            </div>
          </div>
          
          <div class="detail-card">
            <div class="detail-icon">
              <i class="fas fa-gamepad"></i>
            </div>
            <div class="detail-content">
              <h3>Game</h3>
              <p>${currentTournament.game}</p>
            </div>
          </div>
          
          <div class="detail-card">
            <div class="detail-icon">
              <i class="fas fa-list"></i>
            </div>
            <div class="detail-content">
              <h3>Format</h3>
              <p>${currentTournament.format}</p>
            </div>
          </div>
        `;
      }
    }

    // Format date range for display
    function formatDateRange(startDate, endDate) {
      const options = { month: 'short', day: 'numeric' };
      const start = startDate.toLocaleDateString('en-US', options);
      const end = endDate.toLocaleDateString('en-US', options);
      return `${start} - ${end}, ${startDate.getFullYear()}`;
    }

    // Generate leaderboard data based on tournament
    function generateLeaderboardData() {
      // In a real app, this would fetch from API based on tournament ID
      // For now, we'll use the existing data but could customize per tournament
    }

    // Leaderboard data (24 teams total)
    const leaderboardData = [
      { rank: 1, team: 'Team Spirit', avatar: 'TS', points: 245, kills: 87, matches: 12 },
      { rank: 2, team: 'FaZe Clan', avatar: 'FZ', points: 238, kills: 92, matches: 12 },
      { rank: 3, team: 'G2 Esports', avatar: 'G2', points: 221, kills: 78, matches: 12 },
      { rank: 4, team: 'Team Envy', avatar: 'NV', points: 215, kills: 71, matches: 12 },
      { rank: 5, team: 'Cloud9', avatar: 'C9', points: 198, kills: 65, matches: 12 },
      { rank: 6, team: 'Team Liquid', avatar: 'TL', points: 187, kills: 58, matches: 12 },
      { rank: 7, team: 'Virtus Pro', avatar: 'VP', points: 172, kills: 52, matches: 12 },
      { rank: 8, team: 'SK Gaming', avatar: 'SK', points: 165, kills: 49, matches: 12 },
      { rank: 9, team: 'NAVI', avatar: 'NA', points: 158, kills: 45, matches: 12 },
      { rank: 10, team: 'Astralis', avatar: 'AS', points: 151, kills: 42, matches: 12 },
      { rank: 11, team: 'Fnatic', avatar: 'FN', points: 144, kills: 38, matches: 12 },
      { rank: 12, team: 'NIP', avatar: 'NI', points: 137, kills: 35, matches: 12 },
      { rank: 13, team: 'Mouz', avatar: 'MZ', points: 130, kills: 32, matches: 12 },
      { rank: 14, team: 'BIG', avatar: 'BG', points: 123, kills: 29, matches: 12 },
      { rank: 15, team: 'Heroic', avatar: 'HR', points: 116, kills: 26, matches: 12 },
      { rank: 16, team: 'Vitality', avatar: 'VT', points: 109, kills: 23, matches: 12 },
      { rank: 17, team: 'ENCE', avatar: 'EN', points: 102, kills: 20, matches: 12 },
      { rank: 18, team: 'OG', avatar: 'OG', points: 95, kills: 17, matches: 12 },
      { rank: 19, team: 'Complexity', avatar: 'CX', points: 88, kills: 14, matches: 12 },
      { rank: 20, team: 'MIBR', avatar: 'MB', points: 81, kills: 11, matches: 12 },
      { rank: 21, team: 'Eternal Fire', avatar: 'EF', points: 74, kills: 8, matches: 12 },
      { rank: 22, team: 'FURIA', avatar: 'FR', points: 67, kills: 5, matches: 12 },
      { rank: 23, team: 'paiN Gaming', avatar: 'PG', points: 60, kills: 2, matches: 12 },
      { rank: 24, team: 'Imperial', avatar: 'IM', points: 53, kills: 1, matches: 12 }
    ];

    // Leaderboard pagination
    let currentPage = 1;
    const teamsPerPage = 8;
    const totalPages = Math.ceil(leaderboardData.length / teamsPerPage);

    // Winner data for different tournaments
    const winnerData = {
      liquid: {
        team: "Team Liquid",
        logo: "TL",
        members: ["ScreaM", "Jamppi", "soulcas", "Nivera"],
        prize: "$200,000"
      },
      soul: {
        team: "Team Soul",
        logo: "TS",
        members: ["Mortal", "Viper", "Clutchgod", "Regaltos"],
        prize: "$120,000"
      },
      navi: {
        team: "Natus Vincere",
        logo: "NV",
        members: ["s1mple", "electronic", "Perfecto", "b1t"],
        prize: "$100,000"
      }
    };

    // Display completed tournament with winner information
    function displayCompletedTournament(winnerKey) {
      const winner = winnerData[winnerKey];
      if (!winner) return;

      // Show winner section and hide tournament details
      const winnerSection = document.getElementById('winner-section');
      const tournamentDetailsSection = document.getElementById('tournament-details-section');
      const leaderboardSection = document.getElementById('leaderboard-section');

      winnerSection.style.display = 'block';
      tournamentDetailsSection.style.display = 'none';
      leaderboardSection.style.display = 'block';

      // Update winner information
      document.getElementById('winner-logo').textContent = winner.logo;
      document.getElementById('winner-name').textContent = winner.team;
      document.getElementById('winner-prize').textContent = `Prize: ${winner.prize}`;

      // Update team members
      const membersList = document.getElementById('members-list');
      membersList.innerHTML = '';
      winner.members.forEach(member => {
        const memberTag = document.createElement('span');
        memberTag.className = 'member-tag';
        memberTag.textContent = member;
        membersList.appendChild(memberTag);
      });

      // Update hero section for completed tournament
      const statusElement = document.getElementById('tournament-status');
      const primaryActionBtn = document.getElementById('primary-action');
      const heroActions = document.getElementById('hero-actions');

      statusElement.textContent = 'Completed';
      statusElement.style.color = '#9aa0a6';

      heroActions.style.display = 'flex';
      primaryActionBtn.innerHTML = '<i class="fas fa-trophy"></i> View Final Results';
      primaryActionBtn.onclick = () => {
        document.querySelector('#leaderboard-section').scrollIntoView({ behavior: 'smooth' });
      };

      // Update leaderboard title for completed tournament
      const leaderboardTitle = leaderboardSection.querySelector('.section-title');
      const leaderboardSubtitle = leaderboardSection.querySelector('.section-subtitle');
      leaderboardTitle.textContent = 'Final Results';
      leaderboardSubtitle.textContent = 'Tournament final standings and results';
    }

    // Check tournament status based on current date and tournament data
    function updateTournamentStatus() {
      if (!currentTournament) return;

      // Check URL parameters for status override
      const urlParams = new URLSearchParams(window.location.search);
      const statusOverride = urlParams.get('status'); // upcoming, live, completed
      const winner = urlParams.get('winner');

      let today = new Date(); // Use actual current date
      let tournamentStatus = currentTournament.status;

      // Override status if provided in URL
      if (statusOverride && ['upcoming', 'live', 'completed'].includes(statusOverride)) {
        tournamentStatus = statusOverride;
        // Adjust date simulation based on status
        if (statusOverride === 'upcoming') {
          today = new Date(tournamentDates.registrationStart.getTime() - 86400000); // 1 day before registration
        } else if (statusOverride === 'live') {
          today = new Date(tournamentDates.tournamentStart.getTime() + 86400000); // 1 day into tournament
        } else if (statusOverride === 'completed') {
          today = new Date(tournamentDates.tournamentEnd.getTime() + 86400000); // 1 day after tournament
        }
      }
      const primaryActionBtn = document.getElementById('primary-action');
      const registrationMessage = document.getElementById('registration-message');
      const leaderboardSection = document.getElementById('leaderboard-section');
      const heroActions = document.getElementById('hero-actions');
      const winnerSection = document.getElementById('winner-section');
      const tournamentDetailsSection = document.getElementById('tournament-details-section');

      // Handle completed tournament display
      if (tournamentStatus === 'completed' && winner) {
        displayCompletedTournament(winner);
        return;
      }



      // Use dynamic status instead of date comparisons
      const dynamicStatus = calculateTournamentStatus(currentTournament);
      
      switch (dynamicStatus) {
        case 'registration_open':
          // Registration period - show register button and registration message
          registrationMessage.style.display = 'block';
          heroActions.style.display = 'flex';
          primaryActionBtn.innerHTML = '<i class="fas fa-user-plus"></i> Register Now';
          primaryActionBtn.onclick = () => {
            if (!requireAuthentication('register for tournaments')) {
              return;
            }
            // User is authenticated, redirect to registration page
            const tournamentSlug = new URLSearchParams(window.location.search).get('slug') || new URLSearchParams(window.location.search).get('id');
            window.location.href = `team-registration.html?slug=${tournamentSlug}`;
          };
          leaderboardSection.style.display = 'none';
          break;

        case 'upcoming':
          // Before registration starts
          registrationMessage.style.display = 'none';
          heroActions.style.display = 'none';
          leaderboardSection.style.display = 'none';
          break;

        case 'live':
          // Tournament is live - hide all buttons, show leaderboard
          registrationMessage.style.display = 'none';
          heroActions.style.display = 'none';
          leaderboardSection.style.display = 'block';
          break;

        case 'registration_closed':
          // Registration closed, tournament not started
          registrationMessage.style.display = 'none';
          heroActions.style.display = 'none';
          leaderboardSection.style.display = 'none';
          break;

        case 'completed':
          // Tournament finished - show leaderboard as final results
          registrationMessage.style.display = 'none';
        heroActions.style.display = 'none';
        leaderboardSection.style.display = 'block';

        // Update leaderboard title for completed tournament
        const leaderboardTitle = leaderboardSection.querySelector('.section-title');
        const leaderboardSubtitle = leaderboardSection.querySelector('.section-subtitle');
        if (leaderboardTitle) leaderboardTitle.textContent = 'Final Results';
        if (leaderboardSubtitle) leaderboardSubtitle.textContent = 'Tournament final standings and results';
      }
    }

    // Header scroll effect
    window.addEventListener('scroll', () => {
      const header = document.querySelector('.site-header');
      if (window.scrollY > 100) {
        header.style.background = 'rgba(15, 15, 15, 0.9)';
        header.style.backdropFilter = 'blur(30px)';
      } else {
        header.style.background = 'rgba(26, 26, 26, 0.8)';
        header.style.backdropFilter = 'blur(20px)';
      }
    });

    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    // Render leaderboard page with smooth transitions
    function renderLeaderboard() {
      const startIndex = (currentPage - 1) * teamsPerPage;
      const endIndex = startIndex + teamsPerPage;
      const pageTeams = leaderboardData.slice(startIndex, endIndex);

      const leaderboardRows = document.getElementById('leaderboard-rows');

      // Add fade out effect
      leaderboardRows.style.opacity = '0.5';
      leaderboardRows.style.transform = 'translateY(10px)';

      setTimeout(() => {
        leaderboardRows.innerHTML = '';

        pageTeams.forEach((team, index) => {
          const rankClass = team.rank === 1 ? 'first' : team.rank === 2 ? 'second' : team.rank === 3 ? 'third' : '';

          const row = document.createElement('div');
          row.className = 'leaderboard-row';
          row.style.opacity = '0';
          row.style.transform = 'translateY(20px)';
          row.innerHTML = `
            <div class="rank ${rankClass}">#${team.rank}</div>
            <div class="team-info">
              <div class="team-avatar">${team.avatar}</div>
              <div class="team-name">${team.team}</div>
            </div>
            <div class="stat-value points">${team.points}</div>
            <div class="stat-value">${team.kills}</div>
            <div class="stat-value">${team.matches}</div>
          `;
          leaderboardRows.appendChild(row);

          // Animate row in with stagger
          setTimeout(() => {
            row.style.transition = 'all 0.3s var(--ease-out-quart)';
            row.style.opacity = '1';
            row.style.transform = 'translateY(0)';
          }, index * 50);
        });

        // Fade container back in
        leaderboardRows.style.transition = 'all 0.2s var(--ease-out-quart)';
        leaderboardRows.style.opacity = '1';
        leaderboardRows.style.transform = 'translateY(0)';
      }, 150);

      // Update page info with animation
      const currentPageEl = document.getElementById('current-page');
      currentPageEl.style.transform = 'scale(1.2)';
      currentPageEl.textContent = currentPage;
      setTimeout(() => {
        currentPageEl.style.transition = 'transform 0.2s var(--ease-out-quart)';
        currentPageEl.style.transform = 'scale(1)';
      }, 100);

      document.getElementById('total-pages').textContent = totalPages;

      // Update teams counter
      const startTeam = startIndex + 1;
      const endTeam = Math.min(endIndex, leaderboardData.length);
      document.getElementById('teams-range').textContent = `${startTeam}-${endTeam}`;
      document.getElementById('total-teams').textContent = leaderboardData.length;

      // Update arrow states with smooth transitions
      const prevArrow = document.getElementById('prev-arrow');
      const nextArrow = document.getElementById('next-arrow');

      // Previous arrow state
      if (currentPage === 1) {
        prevArrow.classList.add('disabled');
        prevArrow.setAttribute('title', 'No previous page');
      } else {
        prevArrow.classList.remove('disabled');
        prevArrow.setAttribute('title', `Go to page ${currentPage - 1}`);
      }

      // Next arrow state
      if (currentPage === totalPages) {
        nextArrow.classList.add('disabled');
        nextArrow.setAttribute('title', 'No next page');
      } else {
        nextArrow.classList.remove('disabled');
        nextArrow.setAttribute('title', `Go to page ${currentPage + 1}`);
      }
    }

    // Navigation functions with enhanced feedback
    function nextPage() {
      if (currentPage < totalPages) {
        // Add loading state
        const nextArrow = document.getElementById('next-arrow');
        nextArrow.style.transform = 'scale(0.9)';

        setTimeout(() => {
          currentPage++;
          renderLeaderboard();
          nextArrow.style.transform = '';
        }, 100);
      }
    }

    function previousPage() {
      if (currentPage > 1) {
        // Add loading state
        const prevArrow = document.getElementById('prev-arrow');
        prevArrow.style.transform = 'scale(0.9)';

        setTimeout(() => {
          currentPage--;
          renderLeaderboard();
          prevArrow.style.transform = '';
        }, 100);
      }
    }

    // Keyboard navigation support
    document.addEventListener('keydown', (e) => {
      // Only handle navigation if leaderboard is visible
      const leaderboardSection = document.getElementById('leaderboard-section');
      if (leaderboardSection.style.display === 'none') return;

      if (e.key === 'ArrowLeft') {
        e.preventDefault();
        previousPage();
      } else if (e.key === 'ArrowRight') {
        e.preventDefault();
        nextPage();
      }
    });

    // Authentication handling
    function checkUserAuthentication() {
      const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');

      if (session) {
        try {
          const sessionData = JSON.parse(session);
          const user = sessionData.user;
          const userRoles = user?.roles || [];

          // Update navigation for logged-in users
          const authButtons = document.querySelector('.nav-actions');
          if (authButtons) {
            authButtons.innerHTML = `
              <div style="display: flex; align-items: center; gap: 1rem;">
                <span style="color: var(--copy); font-weight: 600;">${user.username}</span>
                ${userRoles.includes('admin') ? '<span style="background: linear-gradient(135deg, var(--accent), var(--accent-2)); color: #000; padding: 0.25rem 0.5rem; border-radius: 12px; font-size: 0.75rem; font-weight: 700;">Admin</span>' : ''}
                <button onclick="logout()" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); color: var(--copy); padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-weight: 600;">
                  <i class="fas fa-sign-out-alt"></i> Logout
                </button>
              </div>
            `;
          }

          return true;
        } catch (error) {
          console.error('Invalid session data:', error);
          return false;
        }
      }

      return false;
    }

    async function logout() {
      try {
        const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');

        if (session) {
          const sessionData = JSON.parse(session);

          // Call logout API
          await fetch(`${apiUrl}/api/auth/logout`, {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${sessionData.token}`,
              'Content-Type': 'application/json'
            }
          });
        }
      } catch (error) {
        console.error('Logout API error:', error);
      } finally {
        localStorage.removeItem('earena_session');
        sessionStorage.removeItem('earena_session');
        window.location.reload();
      }
    }

    // Check user registration status for the tournament
    async function checkUserRegistrationStatus(tournamentSlug, session) {
      if (!session || !session.token) {
        // User is not logged in, button is already "Register"
        return;
      }

      try {
        const response = await fetch(`${API_BASE_URL}/api/tournaments/${tournamentSlug}/registration-status`, {
          headers: {
            'Authorization': `Bearer ${session.token}`
          }
        });

        const result = await response.json();
        
        if (result.success && result.data.isRegistered) {
          const primaryActionBtn = document.getElementById('primary-action');
          if (primaryActionBtn) {
            primaryActionBtn.innerHTML = '<i class="fas fa-check-circle"></i> You are Registered';
            primaryActionBtn.disabled = true;
            primaryActionBtn.style.background = 'rgba(34, 197, 94, 0.8)';
            primaryActionBtn.style.cursor = 'not-allowed';
            primaryActionBtn.style.opacity = '0.8';
            
            // Remove click handler
            primaryActionBtn.onclick = null;
            
            console.log('User is already registered for this tournament:', result.data.teamName);
          }
        }
      } catch (error) {
        console.error('Could not check registration status:', error);
        // Don't show error to user, just keep the register button as is
      }
    }

    // Helper function to get session data
    function getSessionData() {
      try {
        const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');
        return session ? JSON.parse(session) : null;
      } catch (error) {
        console.error('Error parsing session data:', error);
        return null;
      }
    }

    // Initialize tournament page when DOM loads
    async function loadTournamentFromAPI() {
      const urlParams = new URLSearchParams(window.location.search);
      const tournamentSlug = urlParams.get('slug') || urlParams.get('id') || urlParams.get('tournament');

      if (!tournamentSlug) {
        console.warn('No tournament slug provided in URL, using default tournament');
        // Use default tournament for demo purposes
        tournamentSlug = 'test-tournament';
      }

      try {
        const response = await fetch(`${API_BASE_URL}/api/tournaments/slug/${tournamentSlug}`);

        if (!response.ok) {
          throw new Error(response.status === 404 ? 'Tournament not found' : 'Failed to fetch tournament data');
        }

        const data = await response.json();
        currentTournament = data.data;
        
        // Calculate and set dynamic status
        currentTournament.status = calculateTournamentStatus(currentTournament);

        // Update page with tournament data
        updateTournamentDisplay(currentTournament);

        // Load participants/teams
        loadTournamentParticipants(currentTournament);

      } catch (error) {
        console.error('Error loading tournament:', error);
        console.log('Falling back to mock data');

        // Fall back to mock data
        const mockTournaments = {
          'test-tournament': {
            _id: 'test-tournament',
            title: 'Test Tournament',
            description: 'This is a test tournament for demonstration purposes.',
            game: 'PUBG',
            prizePool: 50000,
            maxTeams: 24,
            entryFee: 500,
            format: 'Battle Royale',
            status: 'registration',
            registrationStart: new Date(Date.now() - 86400000).toISOString(),
            registrationEnd: new Date(Date.now() + 7 * 86400000).toISOString(),
            tournamentStart: new Date(Date.now() + 10 * 86400000).toISOString(),
            tournamentEnd: new Date(Date.now() + 17 * 86400000).toISOString(),
            backgroundImage: 'https://images.unsplash.com/photo-1542751371-adc38448a05e?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80'
          }
        };

        const mockTournament = mockTournaments[tournamentSlug] || mockTournaments['test-tournament'];

        // Convert to the expected format
        currentTournament = {
          ...mockTournament,
          dates: {
            registrationStart: new Date(mockTournament.registrationStart),
            registrationEnd: new Date(mockTournament.registrationEnd),
            tournamentStart: new Date(mockTournament.tournamentStart),
            tournamentEnd: new Date(mockTournament.tournamentEnd)
          }
        };

        // Update page with mock tournament data
        updateTournamentDisplay(currentTournament);
        loadTournamentParticipants(currentTournament);
      }
    }

    function updateTournamentDisplay(tournament) {
      // Update page title
      document.getElementById('page-title').textContent = `${tournament.title} | EArena`;

      // Update hero section
      document.getElementById('tournament-title').textContent = tournament.title;
      document.getElementById('tournament-subtitle').textContent = tournament.description || 'Join this exciting tournament and compete for glory!';



      // Update tournament overview with server data
      updateTournamentOverview(tournament);

      // Update tournament info
      document.getElementById('game-name').textContent = tournament.game || 'TBD';
      document.getElementById('tournament-format').textContent = tournament.format || tournament.tournamentFormat || 'TBD';
      document.getElementById('entry-fee').textContent = tournament.entryFee ? `‚Çπ${tournament.entryFee.toLocaleString()}` : 'Free';
      document.getElementById('max-teams').textContent = tournament.maxTeams || 'Unlimited';

      // Update schedule
      const formatDate = (dateString) => dateString ? new Date(dateString).toLocaleDateString('en-IN', {
        day: 'numeric',
        month: 'short',
        year: 'numeric'
      }) : 'TBD';

      document.getElementById('reg-start-date').textContent = formatDate(tournament.registrationStart);
      document.getElementById('reg-end-date').textContent = formatDate(tournament.registrationEnd);
      document.getElementById('tournament-start-date').textContent = formatDate(tournament.tournamentStart);
      document.getElementById('tournament-end-date').textContent = formatDate(tournament.tournamentEnd);

      // Update custom schedule events
      updateCustomScheduleDisplay(tournament.scheduleEvents || []);

      // Update main schedule timeline
      updateScheduleTimeline(tournament.scheduleEvents || []);

      // Update hero background if poster exists
      const posterPath = tournament.posterImage || tournament.poster || tournament.thumbnailUrl || tournament.imageUrl || tournament.backgroundImage;
      const heroElement = document.querySelector('.tournament-hero');

      if (posterPath) {
        const imageUrl = posterPath.startsWith('http') ? posterPath : getImageUrl(posterPath);
        heroElement.style.backgroundImage = `url(${imageUrl})`;
        heroElement.style.backgroundSize = 'cover';
        heroElement.style.backgroundPosition = 'center';
        heroElement.classList.add('has-poster'); // Add class for dark overlay
      } else {
        heroElement.classList.remove('has-poster'); // Remove class if no poster
      }

      // Update action buttons based on tournament status
      updateActionButtons(tournament);
    }

    function updateTournamentOverview(tournament) {
      const overviewContainer = document.getElementById('tournament-overview');
      const formatContainer = document.getElementById('tournament-format-details');

      // Update overview with tournament description
      const description = tournament.description || 'No description available for this tournament.';
      overviewContainer.innerHTML = `
        <p style="margin-bottom: 1.5rem; line-height: 1.6;">
          ${description}
        </p>
        ${tournament.prizePool ? `
        <p style="margin-bottom: 1.5rem; line-height: 1.6;">
          Compete for a prize pool of <strong style="color: var(--accent);">‚Çπ${tournament.prizePool.toLocaleString()}</strong> 
          in this ${tournament.game || 'gaming'} tournament.
        </p>
        ` : ''}
      `;

      // Update format details based on tournament type
      let formatHtml = '';

      if (tournament.format === 'kp' && tournament.kpSettings) {
        const kp = tournament.kpSettings;
        
        // Calculate prize amounts
        const prizePool = tournament.prizePool || 0;
        const firstPrize = Math.round(prizePool * (kp.prizeDistribution?.first || 0.5));
        const secondPrize = Math.round(prizePool * (kp.prizeDistribution?.second || 0.3));
        const thirdPrize = Math.round(prizePool * (kp.prizeDistribution?.third || 0.2));
        
        formatHtml = `
          <div style="margin-bottom: 2rem;">
            <h4 style="color: var(--accent); margin-bottom: 1rem;">KP Tournament Format</h4>
            <ul style="list-style: none; padding: 0;">
              <li style="padding: 0.5rem 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                <strong>Structure:</strong> ${kp.numberOfGroups} Qualifiers ‚Üí Final Match
              </li>
              <li style="padding: 0.5rem 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                <strong>Teams per Qualifier:</strong> ${kp.groupSize} teams each
              </li>
              <li style="padding: 0.5rem 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                <strong>Advancement:</strong> Top ${kp.qualifiersPerGroup} teams from each qualifier
              </li>
              <li style="padding: 0.5rem 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                <strong>Final Match:</strong> ${kp.qualifiersPerGroup * kp.numberOfGroups} teams compete
              </li>
              <li style="padding: 0.5rem 0;">
                <strong>Team Size:</strong> Maximum ${kp.maxPlayersPerTeam} players per team
              </li>
            </ul>
          </div>
          
          <div style="margin-bottom: 2rem;">
            <h4 style="color: var(--accent); margin-bottom: 1rem;">Prize Distribution</h4>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
              <div style="background: rgba(255, 215, 0, 0.1); padding: 1rem; border-radius: 8px; text-align: center; border: 1px solid rgba(255, 215, 0, 0.3);">
                <div style="color: #FFD700; font-weight: bold; font-size: 1.1rem;">ü•á 1st Place</div>
                <div style="color: var(--copy); font-size: 1.2rem; font-weight: bold; margin: 0.5rem 0;">‚Çπ${firstPrize.toLocaleString()}</div>
                <div style="color: var(--muted); font-size: 0.9rem;">50% of Prize Pool</div>
              </div>
              <div style="background: rgba(192, 192, 192, 0.1); padding: 1rem; border-radius: 8px; text-align: center; border: 1px solid rgba(192, 192, 192, 0.3);">
                <div style="color: #C0C0C0; font-weight: bold; font-size: 1.1rem;">ü•à 2nd Place</div>
                <div style="color: var(--copy); font-size: 1.2rem; font-weight: bold; margin: 0.5rem 0;">‚Çπ${secondPrize.toLocaleString()}</div>
                <div style="color: var(--muted); font-size: 0.9rem;">30% of Prize Pool</div>
              </div>
              <div style="background: rgba(205, 127, 50, 0.1); padding: 1rem; border-radius: 8px; text-align: center; border: 1px solid rgba(205, 127, 50, 0.3);">
                <div style="color: #CD7F32; font-weight: bold; font-size: 1.1rem;">ü•â 3rd Place</div>
                <div style="color: var(--copy); font-size: 1.2rem; font-weight: bold; margin: 0.5rem 0;">‚Çπ${thirdPrize.toLocaleString()}</div>
                <div style="color: var(--muted); font-size: 0.9rem;">20% of Prize Pool</div>
              </div>
            </div>
          </div>
          

          
          <ul style="list-style: none; padding: 0;">
            <li style="padding: 0.5rem 0;">
              <strong>Entry Fee:</strong> ‚Çπ${tournament.entryFee || 0} per team (one-time payment)
            </li>
          </ul>
        `;
      } else {
        formatHtml = `
          <ul style="list-style: none; padding: 0;">
            <li style="padding: 0.5rem 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <strong>Format:</strong> ${tournament.format || 'Standard Tournament'}
            </li>
            <li style="padding: 0.5rem 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <strong>Max Teams:</strong> ${tournament.maxTeams || 'Unlimited'}
            </li>
            <li style="padding: 0.5rem 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
              <strong>Game:</strong> ${tournament.game || 'TBD'}
            </li>
            <li style="padding: 0.5rem 0;">
              <strong>Entry Fee:</strong> ${tournament.entryFee ? `‚Çπ${tournament.entryFee.toLocaleString()}` : 'Free'}
            </li>
          </ul>
        `;
      }

      formatContainer.innerHTML = formatHtml;
    }

    function updateCustomScheduleDisplay(scheduleEvents) {
      const container = document.getElementById('custom-schedule-display');

      if (!scheduleEvents || scheduleEvents.length === 0) {
        container.innerHTML = '';
        return;
      }

      // Sort events by date and time
      const sortedEvents = [...scheduleEvents].sort((a, b) => {
        const dateA = new Date(`${a.date} ${a.time}`);
        const dateB = new Date(`${b.date} ${b.time}`);
        return dateA - dateB;
      });

      const eventsHtml = sortedEvents.map(event => `
        <li>
          <span class="info-label">${event.title}</span>
          <span class="info-value">
            ${new Date(`${event.date} ${event.time}`).toLocaleDateString('en-IN', {
        day: 'numeric',
        month: 'short'
      })}
          </span>
        </li>
      `).join('');

      container.innerHTML = `
        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(255, 255, 255, 0.1);">
          <h4 style="color: var(--accent); font-size: 0.9rem; margin-bottom: 0.5rem;">Custom Events</h4>
          <ul class="info-list" style="margin: 0;">
            ${eventsHtml}
          </ul>
        </div>
      `;
    }

    // Update main schedule timeline with tournament events, match schedules, and admin updates
    function updateScheduleTimeline(scheduleEvents) {
      const container = document.getElementById('schedule-timeline');

      // Create tournament events from dates
      const tournamentEvents = [];
      
      if (currentTournament) {
        // Add registration start event
        if (currentTournament.registrationStart) {
          tournamentEvents.push({
            date: currentTournament.registrationStart.split('T')[0],
            time: currentTournament.registrationStart.split('T')[1]?.split('.')[0] || '00:00:00',
            title: 'Registration Opens',
            description: 'Team registration begins for this tournament',
            type: 'registration',
            isSystemEvent: true
          });
        }

        // Add registration end event
        if (currentTournament.registrationEnd) {
          tournamentEvents.push({
            date: currentTournament.registrationEnd.split('T')[0],
            time: currentTournament.registrationEnd.split('T')[1]?.split('.')[0] || '23:59:59',
            title: 'Registration Closes',
            description: 'Last chance to register your team',
            type: 'registration',
            isSystemEvent: true
          });
        }

        // Add tournament start event
        if (currentTournament.tournamentStart) {
          tournamentEvents.push({
            date: currentTournament.tournamentStart.split('T')[0],
            time: currentTournament.tournamentStart.split('T')[1]?.split('.')[0] || '00:00:00',
            title: 'Tournament Begins',
            description: 'The tournament officially starts',
            type: 'tournament',
            isSystemEvent: true
          });
        }

        // Add tournament end event
        if (currentTournament.tournamentEnd) {
          tournamentEvents.push({
            date: currentTournament.tournamentEnd.split('T')[0],
            time: currentTournament.tournamentEnd.split('T')[1]?.split('.')[0] || '23:59:59',
            title: 'Tournament Ends',
            description: 'Tournament concludes and winners are announced',
            type: 'tournament',
            isSystemEvent: true
          });
        }

        // Add match schedule events for KP tournaments
        if (currentTournament.format === 'kp' && currentTournament.kpSettings && currentTournament.kpSettings.matchSchedule) {
          currentTournament.kpSettings.matchSchedule.forEach(match => {
            const matchDate = new Date(match.date);
            tournamentEvents.push({
              date: matchDate.toISOString().split('T')[0],
              time: matchDate.toTimeString().split(' ')[0],
              title: match.match,
              description: `${match.teams} teams competing`,
              type: 'match',
              isSystemEvent: true
            });
          });
        }
      }

      // Combine tournament events with admin updates (scheduleEvents)
      const allEvents = [...tournamentEvents, ...(scheduleEvents || [])];

      if (allEvents.length === 0) {
        container.innerHTML = `
          <div class="empty-schedule">
            <i class="fas fa-calendar-alt"></i>
            <h3>No Schedule Available</h3>
            <p>Tournament schedule will be updated by the organizers soon.</p>
          </div>
        `;
        return;
      }

      // Sort events by date and time
      const sortedEvents = [...allEvents].sort((a, b) => {
        const dateA = new Date(`${a.date} ${a.time}`);
        const dateB = new Date(`${b.date} ${b.time}`);
        return dateA - dateB;
      });

      const eventsHtml = sortedEvents.map(event => {
        const eventDate = new Date(`${event.date} ${event.time}`);
        const formattedDate = eventDate.toLocaleDateString('en-US', {
          month: 'short',
          day: 'numeric'
        });
        const formattedTime = eventDate.toLocaleTimeString('en-US', {
          hour: '2-digit',
          minute: '2-digit',
          hour12: false
        });

        // Determine event type and styling
        let eventTypeClass = event.type || 'other';
        let eventTypeLabel = event.type || 'Event';
        
        if (event.isSystemEvent) {
          eventTypeClass = `system-${event.type}`;
          if (event.type === 'registration') {
            eventTypeLabel = 'Registration';
          } else if (event.type === 'tournament') {
            eventTypeLabel = 'Tournament';
          } else if (event.type === 'match') {
            eventTypeLabel = 'Match';
          }
        } else {
          eventTypeLabel = 'Admin Update';
          eventTypeClass = 'admin-update';
        }

        return `
          <div class="timeline-item ${event.isSystemEvent ? 'system-event' : 'admin-event'}">
            <div class="timeline-date">
              <div class="timeline-day">${formattedDate}</div>
              <div class="timeline-time">${formattedTime}</div>
            </div>
            <div class="timeline-content">
              <span class="event-type-badge ${eventTypeClass}">${eventTypeLabel}</span>
              <h3 class="timeline-title">${event.title}</h3>
              ${event.description ? `<p class="timeline-desc">${event.description}</p>` : ''}
            </div>
          </div>
        `;
      }).join('');

      container.innerHTML = eventsHtml;
    }

    function updateActionButtons(tournament) {
      const primaryAction = document.getElementById('primary-action');




      // Check if registration is open based on dates
      const now = new Date();
      const regStart = new Date(tournament.registrationStart);
      const regEnd = new Date(tournament.registrationEnd);
      const isRegistrationOpen = now >= regStart && now <= regEnd;



      // Use the dynamic status from calculateTournamentStatus
      let effectiveStatus = tournament.status;

      switch (effectiveStatus) {
        case 'upcoming':
        case 'registration_open':
          primaryAction.innerHTML = '<i class="fas fa-user-plus"></i> Register Now';
          primaryAction.onclick = () => {

            // Check if user is logged in
            const sessionData = getSessionData();

            if (sessionData && sessionData.token) {
              // User is logged in, redirect to registration page
              const tournamentSlug = new URLSearchParams(window.location.search).get('slug') || new URLSearchParams(window.location.search).get('id');

              window.location.href = `team-registration.html?slug=${tournamentSlug}`;
            } else {
              // User not logged in, redirect to auth

              redirectToAuth();
            }
          };
          break;

        case 'registration-closed':
          primaryAction.innerHTML = '<i class="fas fa-clock"></i> Registration Closed';
          primaryAction.disabled = true;
          break;

        case 'ongoing':
          primaryAction.innerHTML = '<i class="fas fa-play"></i> Watch Live';
          primaryAction.onclick = () => alert('Live stream coming soon!');
          break;

        case 'completed':
          primaryAction.innerHTML = '<i class="fas fa-trophy"></i> View Results';
          primaryAction.onclick = () => document.getElementById('winner-section').scrollIntoView();
          break;

        default:
          primaryAction.innerHTML = '<i class="fas fa-info-circle"></i> More Info';
          primaryAction.onclick = () => alert('Tournament information will be updated soon.');
      }
    }

    async function loadTournamentParticipants(tournament) {
      // This would typically load participants/teams from the API
      // For now, we'll use the participants data from the tournament object
      const teams = tournament.participants || [];



      // If tournament is ongoing or completed, show leaderboard
      if (tournament.status === 'ongoing' || tournament.status === 'completed') {
        document.getElementById('leaderboard-section').style.display = 'block';
        updateLeaderboard(teams);
      }

      // If tournament is completed and has a winner, show winner section
      if (tournament.status === 'completed' && tournament.winner) {
        showWinnerSection(tournament.winner);
      }
    }

    function updateLeaderboard(teams) {
      // This is a simplified leaderboard - in a real app, you'd have actual match results
      const leaderboardRows = document.getElementById('leaderboard-rows');

      if (!teams || teams.length === 0) {
        leaderboardRows.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--muted);">No teams registered yet.</div>';
        return;
      }

      // Sort teams by some criteria (for demo, we'll use random points)
      const teamsWithStats = teams.map((team, index) => ({
        ...team,
        points: Math.floor(Math.random() * 1000) + 100,
        kills: Math.floor(Math.random() * 50) + 5,
        matches: Math.floor(Math.random() * 10) + 1
      })).sort((a, b) => b.points - a.points);

      leaderboardRows.innerHTML = teamsWithStats.slice(0, 8).map((team, index) => {
        const rank = index + 1;
        const rankClass = rank === 1 ? 'first' : rank === 2 ? 'second' : rank === 3 ? 'third' : '';

        return `
          <div class="leaderboard-row">
            <div class="rank ${rankClass}">#${rank}</div>
            <div class="team-info">
              <div class="team-avatar">${team.name ? team.name.charAt(0).toUpperCase() : 'T'}</div>
              <div class="team-name">${team.name || 'Team ' + (index + 1)}</div>
            </div>
            <div class="stat-value points">${team.points}</div>
            <div class="stat-value">${team.kills}</div>
            <div class="stat-value">${team.matches}</div>
          </div>
        `;
      }).join('');
    }

    function showWinnerSection(winner) {
      if (!currentTournament) {
        console.error('Tournament data not loaded');
        return;
      }

      const winnerSection = document.getElementById('winner-section');
      const winnerLogo = document.getElementById('winner-logo');
      const winnerName = document.getElementById('winner-name');
      const winnerPrize = document.getElementById('winner-prize');
      const membersList = document.getElementById('members-list');

      winnerLogo.textContent = winner.name ? winner.name.charAt(0).toUpperCase() : 'W';
      winnerName.textContent = winner.name || 'Champion Team';
      winnerPrize.textContent = `Prize: ‚Çπ${(currentTournament.prizePool || 0).toLocaleString()}`;

      if (winner.players && winner.players.length > 0) {
        membersList.innerHTML = winner.players.map(player =>
          `<span class="member-tag">${player.name || 'Player'}</span>`
        ).join('');
      }

      winnerSection.style.display = 'block';
    }

    // Profile dropdown functionality
    function initializeProfileDropdown() {
      const session = localStorage.getItem('earena_session') || sessionStorage.getItem('earena_session');
      
      if (session) {
        try {
          const sessionData = JSON.parse(session);
          const user = sessionData.user;
          
          // Show user menu, hide guest menu
          document.getElementById('user-menu').style.display = 'flex';
          document.getElementById('guest-menu').style.display = 'none';
          
          // Update profile info
          document.getElementById('modal-username').textContent = user.username || user.email || 'User';
          
          // Show admin badge if user is admin
          const roleBadge = document.getElementById('modal-role-badge');
          const dashboardLink = document.getElementById('modal-dashboard-link');
          
          if (user.role === 'admin') {
            roleBadge.style.display = 'inline-block';
            roleBadge.textContent = 'Admin';
            dashboardLink.href = 'admin-dashboard.html';
            dashboardLink.innerHTML = '<i class="fas fa-shield-alt"></i><span>Admin Dashboard</span>';
          } else {
            roleBadge.style.display = 'none';
            dashboardLink.href = 'user-dashboard.html';
            dashboardLink.innerHTML = '<i class="fas fa-user"></i><span>My Account</span>';
          }
        } catch (error) {
          console.error('Error parsing session data:', error);
          // Show guest menu if session is invalid
          document.getElementById('user-menu').style.display = 'none';
          document.getElementById('guest-menu').style.display = 'flex';
        }
      } else {
        // Show guest menu if no session
        document.getElementById('user-menu').style.display = 'none';
        document.getElementById('guest-menu').style.display = 'flex';
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      initializeProfileDropdown();
      checkUserAuthentication();
      loadTournamentFromAPI().then(() => {
        // After tournament data is loaded, check the registration status
        const session = getSessionData();
        if (currentTournament) {
          checkUserRegistrationStatus(currentTournament.slug, session);
        }
      });
    });
  </script>
</body>

</html>